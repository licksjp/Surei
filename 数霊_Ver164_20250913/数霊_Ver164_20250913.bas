100 '数霊(かずたま) 製作開始日:2021.07.28
110 'Version 0.0.1_2021.07.28 テスト版１
120 'Version 0.0.2_2021.11.27 テスト版２
130 'Version 0.0.3_2021.11.29 テスト版3
140 'Version 0.0.4_2021.11.30 - 12.01 α1
150 'Version 0.0.5_2021.12.02 - 12.03 α2
160 'Version 0.0.6_2021.12.10 (α3)
170 'Version 0.0.7_2021.12.11 (α4)
180 'Version 0.0.8_2021.12.13 (α5)
190 'Version 0.0.9_2021.12.16 -2021.12.18 (α6)
200 'Version 0.1.0_2021.12.19 -2021.12.23 (β1)
210 'Version 0.1.1_2021.12.24 -2021.12.27 (β2)
220 'Version 0.1.2_2021.12.27 -2021.12.31 (β3)
230 '2022年度
240 'Version 0.1.3_2021.12.31 -2022.01.03 (β4)
250 'Version 0.1.4_2022.01.09 -2022.01.15 (β5)
260 'Version 0.1.5_2022.01.26 -2022.01.30 (Release1):R1
270 'Version 1.0.1_2022.02.12(Release2):R3
280 'Version 1.0.2_2022.02.20(Release):正式版
290 'Version 1.0.3_2022.03.27(Release):正式版
300 'Version 1.0.9_2022.10.20(Release):正式版
310 'Version 1.1.1_2022.11.04(Release):正式版
320 'Version 1.1.2_2022.11.05(Release):正式版
330 'Version 1.1.3_2022.11.06(Release):正式版
340 'Version 1.1.4_2022.11.09(Release):正式版
350 'Version 1.1.6_2022.11.12(Release):正式版
360 'Version 1.1.7_2022.11.16(Release):正式版
370 'Version 1.1.8_2022.11.23(Release):正式版
380 'Version 1.2.0_2022.11.30-2022.11.02(Release):正式版
390 'Version 1.2.1_2022.12.06-2022.12.10(Release):正式版
400 'Version 1.2.2_2022.12.17-2022.12.20(Release):正式版
410 '2023年度
420 'Jan(2023)
430 'Version 1.2.7_2023.01.03-2023.01.06(Release):正式版
440 'version 1.2.8_2023.01.07-2023.01.14(Release):正式版
450 'Version 1.2.9_2023.01.15-2023.01.22(Release):正式版
460 'Version 1.3.0_2023.01.23-2023.01.29(Release):正式版
470 'Feb(2023)
480 'Version 1.3.1_2023.01.29-2023.02.05(Release):正式版
490 'Version 1.3.2_2023.02.06-2023.02.12(Release):正式版
500 'Version 1.3.3_2023.02.12-2023.02.19(Release):正式版
510 'Version 1.3.4_2023.02.19-2023.02.26(Release):正式版
520 'March(2023)
530 'Version 1.3.5_2023.02.27-2023.03.05(Release):正式版
540 'Version 1.3.6_2023.03.05-2023.03.12(Release):正式版
550 'Version 1.3.7_2023.03.12-2023.03.19(Release):正式版
560 'Version 1.3.8_2023.03.19-2023.03.26(Release):正式版
570 'April(2023)
580 'Version 1.3.9_2023.03.26-2023.04.02(Release):正式版
590 'Version 1.4.0_2023.04.02-2023.04.09(Release):正式版
600 'Version 1.4.1_2023.04.09-2023.04.16(Release):正式版
610 'Version 1.4.2_2023.04.16-2023.04.23(Release):正式版
620 'Version 1.4.3_2023.04.23-2023.04.30(Release):正式版
630 'Version 1.4.4_2023.04.30-2023.05.07(Release):正式版
640 'May (2023)
650 'Version 1.4.5_2023.05.07-2023.05.14(Release):正式版
660 'Version 1.4.6_2023.05.14-2023.05.21(Release):正式版
670 'Version 1.4.7_2023.05.22-2023.05.28(Release):正式版
680 '2025年度
690 'Feb(2025)
700 'Version 1.4.8_2025.02.02:正式版
710 'Version 1.4.9_2025.02.16:正式版
720 'March(2025)
730 'Version 1.5.0_2025.03.02:正式版
740 'Version 1.5.1_2025.03.15:正式版
750 'Version 1.5.2_2025.03.30:正式版
760 'April(2025)
770 'Version 1.5.3_2025.04.12:正式版
780 'Version 1.5.4_2025.04.26:正式版
790 'May(2025)
800 'Version 1.5.5_2025.05.10:正式版
810 'Version 1.5.6_2025.05.24:正式版
820 'June(2025)
830 'Version 1.5.7_2025.06.07:正式版
840 'Version 1.5.8_2025.06.22:正式版
850 'July(2025)
860 'Version 1.5.9_2025.07.06:正式版
870 'Version 1.6.0_2025.07.20:正式版
880 'Aug(2025)
890 'Version 1.6.1_2025.08.03:正式版
900 'Version 1.6.2_2025.08.17:正式版
910 'Version 1.6.3_2025.08.31:正式版
920 'Sep(2025)
930 'Version 1.6.4_2025.09.13:正式版
940 '-------------------------------------------------------------------------------------------------------------------------------------
950 '***************************************************************************************************************************************
960 '現在のバージョン
970 Version$ = "数霊_Ver164_20250913"
980 '***************************************************************************************************************************************
990 'csvファイル 1.数霊 ベースファイル
1000 FILE_csv$ = "data/Kazutama.csv"
1010 '****************************************************************************************************************************************
1020 'csvファイル 2.数霊 ベースファイル 2
1030 FILE_csv2$ = "data/Surei_chart_20211207.csv"
1040 '****************************************************************************************************************************************
1050 'Save ファイル
1060 SAVE_DATA1$ = "data/Parsonal_list1.csv"
1070 '*****************************************************************************************************************************************
1080 'gazo フォルダ
1090 Gazo$ = "data/Gazo/"
1100 '******************************************************************************************************************************************
1110 'System フォルダ:設定ファイルを保存するところ
1120 System$ = "data/System/config.sys"
1130 '******************************************************************************************************************************************
1140 'Device type:デバイスタイプのファイルチェック
1150 Device_type$ = "data/device_type.sys"
1160 '******************************************************************************************************************************************
1170 '設定ファイル名:config.sys
1180 'Sound File(Voice)
1190 '1.ボイス TopScreen
1200 'フォルダの変数
1210 '******************************************************************************************************************************************
1220 Voice_File_TopScreen$ = "data/Sound_data/"
1230 Voice_File_CheckSave_File$ = "Voice_Save_Data_20250207.mp3"
1240 myKazutamaFolder$ = "data/my_Kazutama/"
1250 my_Kazutama_data_File$ = myKazutamaFolder$ + "my_Kazutama.dat"
1260 my_Profile_data$ = myKazutamaFolder$ + "my_Profiledata.dat"
1270 '******************************************************************************************************************************************
1280 '数霊数の変数
1290 Title1_Kazutama_name$ = ""
1300 Title2_Kazutama_Number$ = ""
1310 '*************************************************************************************************************************************
1320 'ファイルの有無チェック　ボイスの保存メッセージファイルの有無確認　ここから
1330 '*************************************************************************************************************************************
1340 if (dir$(Voice_File_TopScreen$ + Voice_File_CheckSave_File$) = "") then
1350 cls 3:print "ファイルが見つかりません":end
1360 endif
1370 '*************************************************************************************************************************************
1380 'ファイルの有無チェック　ボイスの保存メッセージファイルの有無確認　ここまで
1390 '*************************************************************************************************************************************
1400 'Message
1410 buf_finish_Message$ = "メモリーを解放してプログラムを終了します"
1420 '変数領域
1430 'vcount:バーチャルパッド下の変数
1440 dim bufline$(181 * 2+3),bufcount$(20):count = 0:dim bufcount1$(20):dim bufcount2$(20):mode = 0:dim bufline2$(181+6,2):dim bufline3$(181*2+3):dim bufKaztama$(50,2):c=1:vcount=0:timer=0:dim List$(4):dim Result_Menu_List$(3)
1450 count2 = 0:N = 0:N2 = 0:m2 = 0:device_No = 0:device_type = 0
1460 Entry_count = 0:MaxCount = 0:MinCount = 0
1470 dim list$(4),moji_List$(2)
1480 '******************************************************************************************************************************************
1490 '◎ファイルの有無チェック
1500 '******************************************************************************************************************************************
1510 if (dir$(FILE_csv$) = "" or dir$(FILE_csv2$) = "" ) then
1520 '******************************************************************************************************************************************
1530 '1.ファイルが無いとき
1540 '******************************************************************************************************************************************
1550 cls :print "依存ファイルが見つかりません":
1560 print "エンターキーを押してください" + chr$(13)
1570 key$ = input$(1)
1580 if (key$ = chr$(13)) then cls 3:color rgb(255,255,255):end
1590 '******************************************************************************************************************************************
1600 else
1610 '******************************************************************************************************************************************
1620 '2.ファイルが有るとき
1630 '******************************************************************************************************************************************
1640 cls:print "csv:file ok." + chr$(13)
1650 n=0
1660 '******************************************************************************************************************************************
1670 'FILE_csv$:数霊データー入力
1680 '******************************************************************************************************************************************
1690 open FILE_csv$ for input as #1
1700 while eof(1) = 0
1710 input #1,line$
1720 bufline$(n) = line$
1730 'Print n;chr$(13)
1740 '登録件数カウント:n
1750 n = n + 1
1760 wend
1770 close #1
1780 N=n
1790 '******************************************************************************************************************************************
1800 '2つ目のファイル読み込み
1810 'n = 0
1820 '******************************************************************************************************************************************
1830 open FILE_csv2$ for input as #2
1840 for n=3 to 181+2+2
1850 for i=0 to 1
1860 input #2,line$
1870 bufline2$(n,i) = line$
1880 next i
1890 next n
1900 close #2
1910 N2 = n
1920 endif
1930 '******************************************************************************************************************************************
1940 '----------------------2022.11.23----------------------
1950 '端末言語のチェック
1960 '日本語端末かチェックをして日本語以外なら英語で表示する
1970 'lang flag:1:日本語,英語(日本語以外):0
1980 '----------------------2022.11.23----------------------
1990 '******************************************************************************************************************************************
2000 lang_flag = 0
2010 if ex_info$(1) <> "JP" then
2020 lang_flag = 1
2030 endif
2040 '******************************************************************************************************************************************
2050 cls 3:font 48:screen 1,1,1,1:int "kb:4":init "crt:0"
2060 play ""
2070 'gload Gazo$ + "TopScreen_20230310.png",0,0,0
2080 '選択ポインター 1 - 4
2090 'スプライトの定義
2100 gload Gazo$ + "Selection.png",1,5,300
2110 gload Gazo$ + "Selection.png",1,5,400
2120 gload Gazo$ + "Selection.png",1,5,500
2130 gload Gazo$ + "Selection.png",1,5,595
2140 gload Gazo$ + "Selection.png",1,10,350
2150 gload Gazo$ + "Selection.png",1,10,420
2160 gload Gazo$ + "Selection.png",1,10,490
2170 sp_def 0,(5,300),32,32
2180 sp_def 1,(5,400),32,32
2190 sp_def 2,(5,500),32,32
2200 sp_def 3,(5,595),32,32
2210 sp_def 4,(5,350),32,32
2220 sp_def 5,(5,420),32,32
2230 sp_def 6,(5,490),32,32
2240 'File check
2250 '******************************************************************************************************************************************
2260 '初回起動はここから
2270 '******************************************************************************************************************************************
2280 if (dir$(Device_type$) = "") then
2290 goto Device_Select:
2300 else
2310 '******************************************************************************************************************************************
2320 '2回目以降はファイルチェックをしてトップ画面
2330 '******************************************************************************************************************************************
2340 open Device_type$ for input as #1
2350 line input #1,device_type$
2360 device_No = val(device_type$)
2370 close #1
2380 if (device_No=1 or device_No=2) then
2390 goto TopScreen:
2400 endif
2410 endif
2420 '******************************************************************************************************************************************
2430 '----------------------ここから--------------------------------
2440 'First_Select_Screen:
2450 '初回起動　タブレット・スマホ　選択
2460 'タブレット　or　スマホの選択を起動時にする
2470 '----------------------ここから--------------------------------
2480 '******************************************************************************************************************************************
2490 '◎.初回起動　タブレット・スマホ　選択
2500 '・First_Select_Screen:
2510 Device_Select:
2520 '******************************************************************************************************************************************
2530 'init "crt:0" :文字単位のスクロール
2540 '******************************************************************************************************************************************
2550 font 48:screen 1,1,1,1:init "kb:4":init "crt:0"
2560 gload Gazo$ + "device_select_20230313.png",0,0,0
2570 init "kb:4"
2580 '******************************************************************************************************************************************
2590 '0.音を停める
2600 '******************************************************************************************************************************************
2610 play ""
2620 '******************************************************************************************************************************************
2630 '1.音を再生 ----------------------ここから--------------------------------
2640 '******************************************************************************************************************************************
2650 play Voice_File_TopScreen$ + "Select_device_select.mp3"
2660 '******************************************************************************************************************************************
2670 '1.音を再生 ----------------------ここまで---------------------------------
2680 '******************************************************************************************************************************************
2690 '***************************************************************************************************************************************
2700 '初回起動　タブレット・スマホ　選択
2710 '***************************************************************************************************************************************
2720 'y=0:key$="":bg=0
2730 print chr$(13) + chr$(13) + chr$(13)
2740 color  rgb(255,255,255)
2750 print "番号を選んでください"+chr$(13)
2760 'print chr$(13)
2770 print " :1.スマートフォン" + chr$(13)
2780 print " :2.タブレット端末" + chr$(13)
2790 locate 0,11:No=1
2800 color rgb(0,0,0)
2810 Print " 1.スマートフォンを選択"+chr$(13)
2820 sp_on 0,1:sp_put 0,(5,300),0,0
2830 sp_on 1,0:sp_on 2,0:sp_on 3,0
2840 device_selection:
2850 '***************************************************************************************************************************************
2860 '初回起動　タブレット・スマホ　選択　初期変数
2870 '***************************************************************************************************************************************
2880 y=0:key$="":bg=0:
2890 '***************************************************************************************************************************************
2900 '初回起動　タブレット・スマホ　選択
2910 '***************************************************************************************************************************************
2920 While (key$ <> chr$(30) and key$ <> chr$(31) and key$ <> chr$(13) and y <> 1 and y <> -1 and bg <> 2)
2930 y = stick(1)
2940 key$ = inkey$
2950 bg = strig(1)
2960 pause 100
2970 wend
2980 '***************************************************************************************************************************************
2990 '初回起動　タブレット・スマホ　選択
3000 '***************************************************************************************************************************************
3010 '***************************************************************************************************************************************
3020 '初回起動　タブレット・スマホ　選択 ジョイパッド　上　アンド　下  --------------------------------ここから--------------------------------　
3030 '***************************************************************************************************************************************
3040 if ((y = 1) or (y = -1) or (key$ = chr$(30)) or (key$ = chr$(31)) ) then
3050 select case No
3060 case 1:
3070 No=2:sp_on 1,1:sp_on 0,0:locate 0,11:pause 300:sp_put 1,(5,400),0,0:print "                                ":locate 0,11:print " 2.タブレット端末を選択":goto device_selection:
3080 case 2:
3090 No=1:sp_on 1,0:sp_on 0,1:pause 300:sp_put 0,(5,300),0,0:locate 0,11:print "                                   ":locate 0,11:print " 1.スマートフォンを選択":goto device_selection:
3100 end select
3110 endif
3120 '***************************************************************************************************************************************
3130 '初回起動　タブレット・スマホ　選択 ジョイパッド　上　アンド　下　--------------------------------ここまで--------------------------------
3140 '***************************************************************************************************************************************
3150 '***************************************************************************************************************************************
3160 '初回起動　タブレット・スマホ　選択 ジョイパッド　決定ボタン  --------------------------------ここから--------------------------------
3170 '***************************************************************************************************************************************
3180 if ((bg = 2) or (key$ = chr$(13)))  then
3190 select case No
3200 case 1:
3210 sp_on 0,0:sp_on 1,0:device_No=1:gosub File_Device_Set:goto TopScreen:
3220 case 2:
3230 sp_on 0,0:sp_on 1,0:device_No=2:gosub File_Device_Set:goto TopScreen:
3240 end select
3250 endif
3260 'endif
3270 '***************************************************************************************************************************************
3280 '初回起動　タブレット・スマホ　選択 ジョイパッド　決定ボタン --------------------------------ここまで--------------------------------
3290 '***************************************************************************************************************************************
3300 '***************************************************************************************************************************************
3310 '--------------------------------ここまで--------------------------------
3320 'First_Select_Screen:
3330 '初回起動　タブレット・スマホ　選択
3340 'タブレット　or　スマホの選択を起動時にする
3350 '--------------------------------ここまで--------------------------------
3360 '******************************************************************************************************************************************
3370 'Top画面
3380 TopScreen:
3390 '******************************************************************************************************************************************
3400 'バーチャルパッドを表示
3410 cls 3:font 48:screen 1,1,1,1:init "kb:4":init "crt:0"
3420 '******************************************************************************************************************************************
3430 '0.音声を停める ここから
3440 '******************************************************************************************************************************************
3450 play ""
3460 '******************************************************************************************************************************************
3470 '0.音声を停める　ここまで
3480 '******************************************************************************************************************************************
3490 '1.音声再生 ここから
3500 '******************************************************************************************************************************************
3510 play Voice_File_TopScreen$ + "Voice_TopScreen.mp3"
3520 '******************************************************************************************************************************************
3530 '1.音声再生　ここまで
3540 '******************************************************************************************************************************************
3550 'gload Gazo$ + "Screen1_Top_20211226.png",0,0,0
3560 select case device_No
3570 case 1:
3580 'Top画面の背景画像
3590 gload Gazo$ + "TopScreen_20230310.png",0,0,0
3600 gload Gazo$ + "downscreen.png",0,0,800
3610 case 2:
3620 gload Gazo$ + "TopScreen_20230310.png",0,0,0
3630 end select
3640 'key$=input$(1)
3650 'バーチャルパッドの背景を白にする for smartphone screen
3660 'gload Gazo$ + "downscreen.png",0,0,800
3670 '選択肢 1
3680 gload Gazo$ + "Selection.png",1,5,300
3690 '選択肢 2
3700 gload Gazo$ + "Selection.png",1,5,400
3710 '選択肢 3
3720 gload Gazo$ + "Selection.png",1,5,500
3730 '選択肢 4
3740 'TopScreen:
3750 'select case device_No
3760 'case 1:
3770 gload Gazo$ + "Selection.png",1,5,600
3780 'case 2:
3790 'gload Gazo$ +
3800 'end select
3810 color rgb(0,0,255)
3820 print chr$(13)
3830 if lang_flag = 1 then
3840 color rgb(255,255,255)
3850 print "Select Number" + chr$(13)
3860 print " :1.Kazutama check" + chr$(13)
3870 print " :2.Setting" + chr$(13)
3880 print " :3.Help" + chr$(13)
3890 print " :4.End Program" + chr$(13)
3900 color rgb(255,255,255)
3910 else
3920 sp_on 1,0:sp_on 2,0:sp_on 3,0
3930 color rgb(255,255,255)
3940 print chr$(13)
3950 sp_on 0,1:sp_put 0,(5,300),0,0
3960 print "番号を選んでください" + chr$(13)
3970 print " :1.数霊(かずたま)チェック" + chr$(13)
3980 print " :2.設定" + chr$(13)
3990 print " :3.ヘルプ" + chr$(13)
4000 print " :4.(プログラムを)終　了する" + chr$(13)
4010 color rgb(0,0,0)
4020 'No=1:locate 1,12:color rgb(255,255,255):print "数霊（かずたま）チェックを選択"
4030 'バーチャルパッドを表示
4040 No=1:
4050 'lang_flag:1 外国語,0:日本語
4060 if lang_flag = 1 then
4070 'lang_flag=1 英語
4080 locate 0,15:color rgb(0,0,0):print "1.It has selected Kazutama check";chr$(13)
4090 else
4100 'lang_flag=0 日本語
4110 locate 0,15:color rgb(0,0,0):print " 1.数霊(かずたま)チェックを選択";chr$(13)
4120 endif
4130 endif
4140 'TopScreen sprite
4150 'スプライト
4160 '選択肢 1 On
4170 'sp_def 0,(5,300),32,32
4180 'sp_on 0,1
4190 'sp_put 0,(5,300),0,0
4200 '選択肢 2 Off
4210 sp_def 1,(5,400),32,32
4220 sp_on 1,0
4230 sp_put 1,(5,400),0,0
4240 '選択肢 3 Off
4250 sp_def 2,(5,500),32,32
4260 sp_on 2,0
4270 sp_put 2,(5,500),0,0
4280 '選択肢 4 Off
4290 sp_def 3,(5,600),32,32
4300 sp_on 3,0
4310 sp_put 3,(5,600),0,0
4320 color rgb(0,0,0)
4330 Main_Select:
4340 '****************************************************************************************************************************
4350 'y:バーチャルパッドの処理                                                                                                   *
4360 'key$:カーソルの処理                                                                                                        *
4370 '****************************************************************************************************************************
4380 '変数初期値 y = 0:key$ = "":bg = 0                                                                                          *
4390 '****************************************************************************************************************************
4400 y = 0:key$ = "":bg = 0
4410 '****************************************************************************************************************************
4420 while ((key$ <> chr$(31)) and (key$ <> chr$(13)) and (y <> 1) and (y <> -1) and (bg <> 2))
4430 y = stick(1)
4440 key$ = inkey$
4450 bg = strig(1)
4460 pause 200
4470 wend
4480 '***********************************************************************************************************************************************
4490 'バーチャルパッドを押したときの処理とカーソルを押したときの処理を書く
4500 '1.バーチャルパッドの処理
4510 'バーチャルパッド下を押した時
4520 '***********************************************************************************************************************************************
4530 if y = 1 then
4540 select case No
4550 'No の初期値：No=1
4560 case 1:
4570 beep:sp_on 0,0:sp_on 1,1:sp_on 2,0:sp_on 3,0:sp_put 1,(5,400),0,0:No=2:pause 200:locate 0,15:print "                                       ":
4580 if lang_flag = 1 then
4590 'lang_flag=1 英語
4600 locate 0,15:print "2.It has selected Setting":goto Main_Select:
4610 else
4620 'lang_flag=0 日本語
4630 locate 0,15:print " 2.設定を選択":goto Main_Select:
4640 endif
4650 'デバッグライン　ここから
4660 '0のとき
4670 'デバッグライン　ここまで
4680 'デバッグライン　ここから
4690 'バーチャルパッド　下
4700 case 2:
4710 beep:sp_on 2,1:sp_on 0,0:sp_on 1,0:sp_on 3,0:sp_put 2,(5,500),0,0:pause 200:No=3:locate 0,15:
4720 print "                                         ":
4730 if lang_flag = 1 then
4740 color rgb(0,0,0):locate 0,15:
4750 print "3.It has selected Help":No=3:goto Main_Select:
4760 else
4770 color rgb(0,0,0):locate 0,15:print "                                                         ":locate 0,15:
4780 print " 3.ヘルプを選択":No=3:goto Main_Select:
4790 endif
4800 'デバッグライン　ここまで
4810 case 3:
4820 beep:sp_on 3,1:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_put 3,(5,590),0,0:pause 200:locate 0,15:print"                                               "
4830 if lang_flag = 1 then
4840 locate 0,15:print "4.It has selected finish program":No=0:goto Main_Select:
4850 else
4860 locate 0,15:print "                                                         " :locate 0,15:print " 4.(プログラムを)終了するを選択":No=0:goto Main_Select:
4870 endif
4880 'デバッグライン　ここから
4890 'locate 1,12:print"count=";count;chr$(13):count = count + 1:goto Main_Select:
4900 'デバッグライン　ここまで
4910 case 0:
4920 beep:sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,300),0,0:pause 200:No=1
4930 if lang_flag = 1 then
4940 'lang_flag=1:英語
4950 locate 0,15:print "1.It has selected Kazutama check":goto Main_Select:
4960 else
4970 'lang_flag=0:日本語
4980 locate 0,15:print "                                      ":locate 0,15:print " 1.数霊(かずたま)チェックを選択":goto Main_Select:
4990 endif
5000 'デバッグライン　ここから
5010 ' locate 1,12:print "b=";b;chr$(13):count=count+1:goto Main_Select:
5020 'デバッグライン　ここまで
5030 end select
5040 endif
5050 '********************************************************************************************************************************************
5060 '--------------------------------カーソルの下  ここまで--------------------------------
5070 '********************************************************************************************************************************************
5080 '--------------------------------バーチャルパッド　上  ここから--------------------------------
5090 '********************************************************************************************************************************************
5100 if (y = -1) then
5110 select case No
5120 'No:0  4.終了  :1数霊チェック No:1　→　4.終了 No:0
5130 case 1:
5140 beep:sp_on 3,1:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_put 3,(5,590),0,0:pause 200:No=0:locate 0,15:print "                                                          "
5150 'if lang_flag = 1 then
5160 'lang_flag=1 英語
5170 'locate 0,15:print "4.It has finished program":goto Main_Select:
5180 'else
5190 'lang_flag=0 日本語
5200 locate 0,15:print "                                                          ":
5210 locate 0,15:print " 4.(プログラムを)終了するを選択":goto Main_Select:
5220 'endif
5230 'endif
5240 'No:3 3.Help :4.終了:NO:0 → 3.Help No:3
5250 case 0:
5260 beep:sp_on 2,1:sp_on 0,0:sp_on 1,0:sp_on 3,0:sp_put 2,(5,500),0,0:pause 200:No=3:locate 0,15:print"                                       ":
5270 if lang_flag = 1 then
5280 '1:英語
5290 locate 0,15:print "3.It has selected Help":goto Main_Select:
5300 else
5310 '0:日本語
5320 locate 0,15:print "                                                                                        "
5330 locate 0,15:print " 3.ヘルプを選択":goto Main_Select:
5340 endif
5350 'No:3 3.Help→2.設定 No:2
5360 case 3:
5370 beep:sp_on 1,1:sp_on 0,0:sp_on 3,0:sp_on 2,0:sp_put 1,(5,400),0,0:pause 200:No=2:locate 0,15:print"                                      "
5380 if lang_flag = 1 then
5390 '1:英語
5400 locate 0,15:print "2.It has selected Setting":goto Main_Select:
5410 else
5420 '0:日本語
5430 locate 0,15:print" 2.設定を選択":goto Main_Select:
5440 endif
5450 case 2:
5460 beep:sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,300),0,0:pause 200:No=1:locate 0,15:print "                                      ":
5470 if lang_flag = 1 then
5480 'lang_flag 1 英語
5490 locate 0,15:print "1.It has selected Kazutama check":goto Main_Select:
5500 else
5510 'lang_flag 0 日本語
5520 locate 0,15:print" 1.数霊(かずたま)チェックを選択":goto Main_Select:
5530 endif
5540 end select
5550 endif
5560 '*******************************************************************************************************************************************
5570 '--------------------------------JoyPad 上 ここまで--------------------------------
5580 '********************************************************************************************************************************************
5590 '********************************************************************************************************************************************
5600 '--------------------------------決定ボタン　ここから--------------------------------
5610 '********************************************************************************************************************************************
5620 if (bg = 2) then
5630 select case No
5640 '1.数霊チェックを選択  パッドの右キー(決定)
5650 case 1:
5660 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Surei_Check:
5670 '2.設定を選択  パッドの右キー(決定)
5680 case 2:
5690 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Setting:
5700 '3.ヘルプを選択 パッドの右(決定)
5710 case 3:
5720 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Help:
5730 'プログラムの終了を選択(決定)
5740 case 0:
5750 cls 3:cls 4:gosub buffer_clear:play "":play Voice_File_TopScreen$ + "Voice_Finish_Message.mp3":ui_msg buf_finish_Message$:pause 4.080*1000:color rgb(255,255,255):end
5760 'if lang_flag = 1 then
5770 'lang_flag = 1 英語
5780 'else
5790 'lang_flag = 0 日本語
5800 'endif
5810 end select
5820 '4.終了するを選択  パッドの右
5830 endif
5840 '********************************************************************************************************************************************
5850 '決定ボタン--------------------------------決定ボタン　ここまで-------------------------------
5860 '********************************************************************************************************************************************
5870 'バーチャルパッド　上　ここまで
5880 '2.カーソルの処理
5890 'カーソル　下 chr$(31)
5900 if (key$ = chr$(31)) then
5910 select case (No)
5920 '4
5930 '0 選択肢4 => 選択肢1
5940 case 0:
5950 c=1:No=c:sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,300),0,0:locate 0,15:print "                    ":color rgb(0,0,0):
5960 if lang_flag = 1 then
5970 'lang flag:1 英語
5980 else
5990 'lang flag:0 日本語
6000 color rgb(0,0,0):locate 0,15:print "1.数霊(かずたま)チェックを選択":goto Main_Select:
6010 endif
6020 '1 選択肢1 => 選択肢2
6030 case 1:
6040 c=2:No=c:sp_on 0,0:sp_on 1,1:sp_on 2,0:sp_on 3,0:sp_put 1,(5,400),0,0:locate 0,15:print "                    ":
6050 if lang_flag = 1 then
6060 'lang_flag:1 英語
6070 else
6080 'lang_flag:0 日本語
6090 color rgb(0,0,0):locate 0,15:print "2.設定を選択":beep:goto Main_Select:
6100 endif
6110 '2 選択肢2 => 選択肢3
6120 case 2:
6130 c=3:No=c:sp_on 0,0:sp_on 1,0:sp_on 2,1:sp_on 3,0:sp_put 2,(5,400),0,0:locate 0,15:print "                    ":
6140 if lang_flag = 1 then
6150 'lang flag:1 英語
6160 else
6170 'lang flang:0 日本語
6180 color rgb(0,0,0):locate 0,15:print "3.ヘルプを選択":goto Main_Select:
6190 endif
6200 '3 選択肢３ => 選択肢4
6210 case 3:
6220 c=0:No=c:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,1:sp_put 3,(5,595),0,0:locate 0,15:print "                     ":color rgb(0,0,0)
6230 if lang_flag = 1 then
6240 'lang_flag = 1 英語
6250 else
6260 'lang_flag = 0 日本語
6270 color rgb(0,0,0):locate 0,15:print "4.終 了を選択":goto Main_Select:
6280 endif
6290 case else:
6300 goto Main_Select:
6310 end select
6320 endif
6330 'カーソル　上
6340 if (key$=chr$(30)) then
6350 select case (No)
6360 '選択肢1 => 選択肢4
6370 case 1:
6380 c=0:No=c:sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,300),0,0:locate 0,15:PRINT "                      ":
6390 if lang_flag = 1 then
6400 'lang_flag=1:英語
6410 'print "1.It has selected Kazutama check":goto Main_Select:
6420 else
6430 'lang_flag = 0:日本語
6440 else
6450 print "1.数霊(かずたま)チェックを選択":goto Main_Select:
6460 endif
6470 '選択肢2 => 選択肢1
6480 case 2:
6490 c=1:No=c:sp_on 0,0:sp_on 1,1:sp_on 2,0:sp_on 3,0:sp_put 1,(5,400),0,0:locate 0,15:print "                 ":locate 1,15:print "2.設 定を選択":goto Main_Select:
6500 '選択肢3　=> 選択肢2
6510 case 3:
6520 c=2:No=c:sp_on 0,0:sp_on 1,0:sp_on 3,0:sp_on 2,1:sp_put 2,(5,500),0,0
6530 if lang_flag = 1 then
6540 'lang_flag = 1:英語
6550 locate 0,15:print "It has selected Help":goto Main_Select:
6560 else
6570 'lang_flag = 0:日本語
6580 locate 0,15:print "3.ヘルプを選択":goto Main_Select:
6590 endif
6600 '選択肢4 => 選択肢3
6610 case 0:
6620 c=3:No=c:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,1:sp_put 3,(5,600),0,0:locate 0,15:print "                ":locate 1,15:print "4.終 了を選択":talk"プログラムを終了します":ui_msg"プログラムを終了します":goto Main_Select:
6630 if lang_flag = 1 then
6640 'lang flag=1 英語
6650 else
6660 'lang flag=0 日本語
6670 locate 1,15:print "4.終了を選択":talk"プログラムを終了します":ui_msg "プログラムを終了します":goto Main_Select:
6680 endif
6690 end select
6700 endif
6710 'Input "番号:",No
6720 'エンターキー入力:決定
6730 if (key$ = chr$(13)) then
6740 select case No
6750 case 1:
6760 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Surei_Check:
6770 case 3:
6780 Color rgb(255,255,255):goto Help:
6790 case 0:
6800 cls 4:cls 3:play"":play Voice_File_TopScreen$ + "Voice_Finish_Message.mp3":gosub buffer_clear:ui_msg buf_finish_Message$:color rgb(255,255,255):pause 4.080 * 1000:end
6810 case 2:
6820 color rgb(255,255,255):sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Setting:
6830 end select
6840 endif
6850 '1-1.数霊チェック
6860 Surei_Check:
6870 cls 3:Font 48:play ""
6880 select case device_No
6890 case 1:
6900 gload Gazo$ + "Screen1_Sureicheck_Top_20230130.png",0,0,0
6910 gload Gazo$ + "downscreen.png",0,0,800
6920 case 2:
6930 gload Gazo$ + "Screen1_Sureicheck_Top_20230130.png",0,0,0
6940 end select
6950 play ""
6960 play Voice_File_TopScreen$ + "Voice_Kazutama.mp3"
6970 color rgb(255,0,0)
6980 'print "●数霊(かずたま)チェックトップ" + chr$(13)
6990 sp_on 0,1:sp_put 0,(5,300),0,0:screen 1,1,1:play ""
7000 if lang_flag = 1 then
7010 'lang_flag=1 英語
7020 else
7030 'lang_flag=0 日本語
7040 print chr$(13)+chr$(13)+chr$(13)
7050 color rgb(255,255,255)
7060 print "番号を選んでください" + chr$(13)
7070 print " :1.数霊(かずたま)1人用" + chr$(13)
7080 print " :2.数霊(かずたま)2人用" + chr$(13)
7090 print " :3.数霊(かずたま)リスト" + chr$(13)
7100 print " :4.トップ画面に行く" + chr$(13)
7110 color rgb(0,0,0):No = 0
7120 locate 0,15:print "                                       "
7130 locate 0,15
7140 print " 1.数霊(かずたま)1人用を選択"
7150 endif
7160 Kazutama_main:
7170 '***********************************************************************************************************
7180 'y:バーチャルパッドの処理
7190 'key$:カーソルの処理
7200 'bg:バーチャルパッドの右のボタン
7210 '************************************************************************************************************
7220 '変数　初期値 y=0:key$="":bg=0
7230 '************************************************************************************************************
7240 y = 0:key$ = "":bg=0
7250 '************************************************************************************************************
7260 while (key$ <> chr$(31) and key$ <> chr$(13) and y <> 1 and y <> -1 and bg <> 2)
7270 y = stick(1)
7280 key$ = inkey$
7290 bg = strig(1)
7300 y = stick(-1)
7310 pause 20
7320 wend
7330 '**************************************************************************************************************
7340 '**************************************************************************************************************
7350 '***************************************************************************************************************
7360 'バーチャルパッド 下　ここから
7370 '**************************************************************************************************************
7380 'key$ = input$(1)
7390 if (y = 1) then
7400 'カーソル上から下
7410 select case No
7420 'No の初期値：No=1
7430 '0→1
7440 case 0:
7450 beep:sp_on 0,0:sp_on 2,0:sp_on 1,1:sp_on 3,0:sp_put 1,(5,400),0,0:No=1:pause 200:locate 0,15:print "                                                   ":locate 0,15:print" 2.数霊（かずたま）2人用を選択":goto Kazutama_main:
7460 'デバッグライン　ここから
7470 '0のとき
7480 'デバッグライン　ここまで
7490 'デバッグライン　ここから
7500 case 2:
7510 '2→3
7520 beep:sp_on 2,0:sp_on 1,0:sp_on 2,0:sp_on 3,1:sp_on 0,0:sp_put 3,(5,600),0,0:pause 200:locate 0,15:print "                                               "
7530 :locate 0,15:print " 4.トップ画面に行くを選択":No = 3:goto Kazutama_main:
7540 '3→0
7550 case 3:
7560 beep:sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,300),0,0:pause 200:No = 0:locate 0,15:print "                                                    ":locate 0,15:print " 1.数霊(かずたま)1人用を選択":goto Kazutama_main:
7570 case 1:
7580 '1→2
7590 beep:sp_on 2,1:sp_on 1,0:sp_on 0,0:sp_on 3,0:sp_put 2,(5,500),0,0:pause 200:No = 2:locate 0,15:print "                                                  ":locate 0,15:print " 3.数霊（かずたま）リストを選択":goto Kazutama_main:
7600 'デバッグライン　ここから
7610 ' locate 1,12:print "b=";b;chr$(13):count=count+1:goto Main_Select:
7620 'デバッグライン　ここまで
7630 end select
7640 endif
7650 '****************************************************************************************************************************************************
7660 'バーチャルパッド 下　ここまで
7670 '****************************************************************************************************************************************************
7680 'バーチャルパッド　上 ここから
7690 '****************************************************************************************************************************************************
7700 if (y = -1) then
7710 select case No
7720 'No:0  4.終了  :1数霊チェック No:1 →　4.終了 No:0
7730 case 1:
7740 '1→0
7750 beep:sp_on 1,0:sp_on 0,1:sp_on 2,0:sp_on 3,0:sp_put 0,(5,300),0,0:pause 200:No = 0:locate 0,15:print"                                     ":locate 0,15:print" 1.数霊（かずたま）1人用を選択":goto Kazutama_main:
7760 'No:3 3.Help→2.設定 No:2o:3 3.Help→2.設定 No:2
7770 case 2:
7780 '2→1
7790 beep:sp_on 1,1:sp_on 0,0:sp_on 2,0:sp_on 3,0:sp_put 1,(5,400),0,0:pause 200:No = 1:locate 0,15:print"                                     ":locate 0,15:print" 2.数霊（かずたま）2人用を選択":goto Kazutama_main:
7800 case 3:
7810 '3→2
7820 beep:sp_on 0,0:sp_on 1,0:sp_on 2,1:sp_on 3,0:sp_put 2,(5,500),0,0:pause 200:No = 2:locate 0,15:print "                                      ":locate 0,15:print" 3.数霊(かずたま)リストを選択":goto Kazutama_main:
7830 case 0:
7840 '0→3
7850 beep:sp_on 0,0:sp_on 1,0:sp_on 3,1:sp_on 2,0:sp_put 3,(5,600),0,0:pause 200:No = 3:locate 0,15:print "                                      ":locate 0,15:print " 4.トップ画面に行くを選択":goto Kazutama_main:
7860 end select
7870 endif
7880 '************************************************************************************************************************************************
7890 'バーチャルパッド上 ここまで
7900 '************************************************************************************************************************************************
7910 '**********************************************************************************************************************************************
7920 '決定ボタン　
7930 '**************************************************************************************************************************************************
7940 if (bg = 2) then
7950 select case No
7960 '1.数霊チェックを選択  パッドの右キー
7970 case 0:
7980 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto Surei_Input:
7990 '2.数霊チェック2人用   パッドの右キー
8000 case 1:
8010 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto Surei_twoParson:
8020 '3.トップ画面に行く パッドの右
8030 case 3:
8040 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto TopScreen:
8050 '2.数霊リスト1人用 パッドの右キー
8060 case 2:
8070 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto Surei_List1:
8080 'プログラムの終了を選択
8090 end select
8100 '4.終了するを選択  パッドの右
8110 endif
8120 'バーチャルパッド　上　ここまで
8130 if (key$ = chr$(31)) then
8140 select case No
8150 case 0:
8160 No=1:sp_on 0,1:sp_on 1,0:sp_put 0,(5,300),0,0:locate 1,15:print "                                                          ":
8170 if lang_flag = 1 then
8180 Else
8190 locate 0,15:print "                                      "
8200 No=2:locate 0,15:print " 2.数霊(かずたま)2人用を選択":goto Kazutama_main:
8210 endif
8220 case 1:
8230 No=0:sp_on 0,0:sp_on 1,0:sp_on 2,1:sp_on 3,0:sp_put 2,(5,585),0,0:locate 0,12:print "                                                          ":
8240 if lang_flag = 1 then
8250 Else
8260 locate 0,15:print"                                      "
8270 locate 0,15:print" 3.トップ画面に行くを選択":goto Kazutama_main:
8280 endif
8290 case 2:
8300 No=0:sp_on 0,1:sp_on 1,0:sp_on 2,0 :sp_on 3,0:sp_put 0,(5,300),0,0:locate 0,12:print "                                      ":
8310 if lang_flag = 1 then
8320 Else
8330 No=1:locate 0,15:print" 1.数霊（かずたま)1人用を選択":goto Kazutama_main:
8340 endif
8350 end select
8360 endif
8370 if (key$=chr$(13)) then
8380 select case No
8390 case 1:
8400 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:cls 3:mode = 0:goto Surei_Input:
8410 case 2:
8420 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:cls 3:goto Surei_twoParson:
8430 case 3:
8440 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:cls 3:goto TopScreen:
8450 '終了はトップメニューのみにする
8460 end select
8470 endif
8480 '***********************************************************************************
8490 '前の画面に戻る
8500 'プログラムの終了
8510 '1人用
8520 '2人用
8530 '●.入力パート  数霊の文字を入力
8540 '数霊(かずたま) 文字入力  1人用
8550 'Label: Surei_Input:
8560 '***********************************************************************************
8570 Surei_Input:
8580 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0
8590 if mode = 0 then
8600 cls 3:font 32:init"kb:2"
8610 select case device_No
8620 case 1:
8630 gload Gazo$ + "InputKotodama_20230131.png",0,0,0
8640 gload Gazo$ + "CenterScreen_20230401.png",0,0,380
8650 case 2:
8660 gload Gazo$ + "InputKotodama_20230131.png",0,0,0
8670 end select
8680 play ""
8690 play Voice_File_TopScreen$ + "Voice_Input_Kazutama.mp3"
8700 color rgb(255,0,0)
8710 if lang_flag=1 then
8720 '英語
8730 else
8740 '日本語
8750 print chr$(13)+chr$(13)+chr$(13)
8760 color rgb(255,255,255)
8770 print "文字を入れてください" + chr$(13)
8780 color rgb(255,255,255)
8790 print "(有効文字:カタカナ、半角アルファベット & 大文字のみ)" + chr$(13)
8800 print "(※:アルファベットの小文字入力も大文字に変換されます。)" + chr$(13)
8810 color rgb(0,0,0)
8820 Input "入力文字:",buffer_moji$
8830 if buffer_moji$ = "" then
8840 ui_msg "未入力です":goto Surei_Input:
8850 else
8860 '*************************************************
8870 'Date:2025.02.26
8880 'check_flag_katakana:入力した文字が数霊の有効文字かを調べるフラグ
8890 'moji_length:入力した文字数を調べる関数
8900 '入力した文字数がすべて数霊の有効文字かを調べて
8910 '有効文字なら結果のラベル(Surei_Result: のラベル) に飛ぶ。
8920 '*************************************************
8930 check_flag_kazutama = check_Kazutama_moji(buffer_moji$)
8940 small_moji = Alphabet_Check(buffer_moji$)
8950 '
8960 '*****************************************************************************************
8970 '小文字のAlphabetが交じってたら大文字に変換する。　↓
8980 '****************************************************************************************
8990 small_moji_check = Alphabet_Check(buffer_moji$)
9000 if (small_moji_check = 1) then
9010 '小文字を大文字に変える
9020 buffer_moji$ = ucase$(buffer_moji$)
9030 endif
9040 '*******************************************************************************************
9050 '小文字のAlphabetが交じってたら大文字に変換する。  ↑
9060 '*******************************************************************************************
9070 '
9080 '*********************************************************
9090 '入力した文字が全部カタカナの時
9100 '結果の画面ラベル(Surei_Result)に飛ぶ
9110 'moji_length = Len(buffer_moji$)
9120 '*********************************************************
9130 if (check_flag_kazutama = 0) then
9140 '結果の画面にいく
9150 goto Surei_Result:
9160 endif
9170 endif
9180 '************************************************
9190 'Date: 2025.02
9200 '追加項目:　Alphabetの文字入力チェック　
9210 '追加処理: 入力した文字がAlphabetの大文字か確認
9220 'ここから
9230 '************************************************
9240 'n = Alphabet_Check(buffer_moji$)
9250 '入力した文字にアルファベットが混じってるとき
9260 'if (n = 1) then
9270 '入力した文字にアルファベットが混じっているとき
9280 '大文字に変換する
9290 '例:あかいaA  と入力すると ===> あかいAA      大文字に変換する。
9300 'buffer_moji$ = ucase$(buffer_moji$)
9310 'endif
9320 '************************************************
9330 'Date:  2025.02
9340 '追加処理 Alphabet の文字入力チェック
9350 '追加処理:入力した文字がAlphabetの文字か確認
9360 'ここまで
9370 '************************************************
9380 '************************************************
9390 'Date:2025.02.25
9400 '平仮名チェック
9410 '平仮名が混じってるか調べる
9420 '************************************************
9430 'hiragana_count = 0
9440 'hiragana_count = check_hiragana(buffer_moji$)
9450 'if (hiragana_count = 0) then
9460 '平仮名が交じっていない時
9470 'goto Surei_Result:
9480 'else
9490 '平仮名が交ってるとき
9500 'ui_msg "平仮名が交じっています。もう一度入れ直してください!!!"
9510 'goto Surei_Input:
9520 'endif
9530 '平仮名が交っていないとき
9540 'goto Surei_Result:
9550 '************************************************
9560 'Date: 2025.02
9570 '追加項目:　Alphabetの文字入力チェック　
9580 '追加処理: 入力した文字がAlphabetの大文字か確認
9590 'ここから
9600 '************************************************
9610 endif
9620 endif
9630 'endif
9640 if mode = 1 then
9650 cls 3:Font 32:
9660 gload Gazo$ + "InputKotodama.png"
9670 color rgb(255,0,0)
9680 print "●数霊(かずたま)文字入力(2回目)" + chr$(13)
9690 color rgb(255,255,255)
9700 print "文字を入れてください" + chr$(13)
9710 color rgb(255,0,0)
9720 print "(有効文字:カタカナ,半角アルファベット" + chr$(13)
9730 print "大文字のみ)" + chr$(13)
9740 print "半角のアルファベットの小文字は大文字に変換されます"+chr$(13)
9750 color rgb(0,0,0)
9760 Input "文字入力:" , buffer_moji$
9770 goto Surei_Result3:
9780 'endif
9790 endif
9800 '数霊(かずたま)文字入力　2人用
9810 '*******************************************************************************************************
9820 '1人目の数霊入力
9830 '******************************************************************************************************
9840 Surei_twoParson:
9850 'init:4 -> JoyPad
9860 cls 3:Font 32:init "kb:2"
9870 gload Gazo$ + "InputKotodama_20230131.png"
9880 '1人目入力
9890 if lang_flag = 1 then
9900 else
9910 print "" + chr$(13) + chr$(13) + chr$(13)
9920 color rgb(255,255,255)
9930 print "1人目の文字を入れてください" + chr$(13)
9940 color rgb(255,255,255)
9950 print "(有効文字:カタカナ,半角アルファベット　大文字のみ)" + chr$(13)
9960 color rgb(0,0,0)
9970 print chr$(13)
9980 Input "1人目文字入力:",buf_Parson1$
9990 '**************************************************************************************************
10000 'Alphabet大文字が混じってるとき
10010 'アルファベット小文字を大文字にする
10020 '**************************************************************************************************
10030 '1人目の入力でAlphabetが混じってるとき
10040 '*************************************************************************************************
10050 if Alphabet_Check(buf_Parson1$) = 1 then
10060 buf_Parson1$=Ucase$(buf_Parson1$)
10070 endif
10080 endif
10090 Surei_twoParson2:
10100 cls 3:Font 32:init"kb:2"
10110 '2人目入力
10120 gload Gazo$ + "InputKotodama_20230131.png"
10130 if lang_falg = 1 then
10140 else
10150 print "" + chr$(13) + chr$(13) + chr$(13)
10160 color rgb(255,255,255)
10170 print "2人目の文字を入れてください" + chr$(13)
10180 color rgb(255,255,255)
10190 print "(有効文字:カタカナ,半角アルファベット 大文字のみ)" + chr$(13) + chr$(13) + chr$(13)
10200 color rgb(0,0,0)
10210 Input "2人目の文字入力:",buf_Parson2$
10220 if Alphabet_Check(buf_Parson2$) = 1 then
10230 buf_Parson2$=Ucase$(buf_Parson2$)
10240 endif
10250 goto Surei_Result2:
10260 endif
10270 '数霊　計算 パート
10280 '文字の計算関数
10290 'moji$:1文字を入れる
10300 func Complate(moji$)
10310 for n = 1 to 116
10320 if moji$ = bufline$(2*n) then
10330 buffcount = val(bufline$(2 * n + 1))
10340 endif
10350 next n
10360 endfunc buffcount
10370 '**********************************************************************************************
10380 '数霊　結果表示 ここから
10390 '**********************************************************************************************
10400 Surei_Result:
10410 '**********************************************************************************************
10420 'バーチャルパッド:init"Kb:4"
10430 '画面消去　変数初期化
10440 '**********************************************************************************************
10450 cls 3:init "kb:4":No = 0:Button_count = 0
10460 '***********************************************************************************************
10470 'ゼロカウント:zcount
10480 'ゼロカウント:無効な文字が入ってるとき表示させないようにする
10490 '例 アカい:"い"の文字は無効な文字なので、はじく
10500 '************************************************************************************************
10510 zcount=0
10520 '************************************************************************************************
10530 '1.mojicount:入力文字数
10540 '例1: コメ→　2
10550 '2文字なので2を返す。
10560 '************************************************************************************************
10570 mojicount = len(buffer_moji$)
10580 for n=1 to mojicount
10590 for j=1 to 118
10600 if (bufcount$(n - 1) = bufline$(2 * j)) then
10610 bufcount$(n-1) = Mid$(buffer_moji$,n,1)
10620 endif
10630 next j
10640 next n
10650 ncount = 0:count = 0
10660 for i = 1 to mojicount
10670 bufcount$(i-1) = Mid$(buffer_moji$,i,1)
10680 '************************************************************************************************
10690 '"ン"のカウントする処理
10700 'ンのカウント
10710 '************************************************************************************************
10720 if (bufcount$(i-1) = "ン") then  ncount = ncount + 1
10730 next i
10740 if (ncount > 0) then
10750 'Listを表示する
10760 moji_List$(0) = "この単語は目に見える物です"
10770 moji_List$(1) = "この単語は目に見えない物です"
10780 num2 = ui_select("moji_List$","この単語は目に見える物ですか?")
10790 if (num2 = 0) then
10800 else
10810 if (num2 = 1) then
10820 n1 = 9 * ncount
10830 endif
10840 endif
10850 endif
10860 for j=1 to mojicount
10870 bufcount$(j-1) = Mid$(buffer_moji$,j,1)
10880 count = count + Complate(bufcount$(j - 1))
10890 next j
10900 count = count + n1
10910 if (ncount > 0) then count = count
10920 '182以上のとき,181を引く
10930 if buf_cofig_r = 0 then
10940 if (count > 181) then
10950 count = count - 181
10960 else
10970 if (buf_config_r = 1) then
10980 count = Single_Complate(count)
10990 endif
11000 endif
11010 endif
11020 '*****************************************************************************************
11030 'ここから具体的に結果を表示するところ  ↓　ココから下
11040 '*****************************************************************************************
11050 '1.変数初期化　背景画像　音を初期化して音を再生
11060 '****************************************************************************************
11070 cls 3:Font 48:Button_count = 0
11080 gload Gazo$ + "Result_Screen3_20250205.png"
11090 play "":play Voice_File_TopScreen$ + "Voice_Result_Kazutama_20250207.mp3"
11100 '****************************************************************************************
11110 '1.初期化 処理　ここまで
11120 '****************************************************************************************
11130 '****************************************************************************************
11140 '2.数霊　結果表示　文字部分1 ここから
11150 '****************************************************************************************
11160 if (count = 0) then
11170 goto Surei_Input:
11180 endif
11190 if buf_config_r = 1 then
11200 locate 0,1
11210 print "入力文字:" + buffer_moji$
11220 locate 0,3
11230 print "数霊(かずたま):";count
11240 endif
11250 if lang_flag = 1 then
11260 else
11270 color rgb(255,0,0)
11280 locate 0,1
11290 print "入力文字:" + buffer_moji$
11300 endif
11310 if lang_flag = 1 then
11320 else
11330 play ""
11340 color rgb(0,0,255)
11350 locate 0,3
11360 print "数霊(かずたま):";count
11370 endif
11380 if lang_flag = 1 then
11390 else
11400 play ""
11410 sp_put 4,(5,350),4,0:sp_on 4,1
11420 color rgb(0,0,0)
11430 locate 0,5
11440 print "◎.データーを保存しますか?"
11450 locate 0,7
11460 print  " :1.保存する"
11470 locate  0,9
11480 print  " :2.保存しない"
11490 'locate 0,11
11500 'print " :3.メニューを開く"
11510 'play Voice_File_TopScreen$ + "Voice_Save_Check_20250207.mp3"
11520 '------------------------------------------------------------------------
11530 'JoyPad ここから
11540 'No=0
11550 endif
11560 '*************************************************************************
11570 'Save 選択ダイアログ　ジョイパッド
11580 'Label:Select_Joypad_Kazutama_Save:
11590 '*************************************************************************
11600 Select_Joypad_Kazutama_Save:
11610 y = 0:key$ = "":bg = 0
11620 while (key$ <> chr$(13) and key$ <> chr$(31) and key$ <> chr$(30) and  y <> 1 and  y <> -1 and bg <> 2)
11630 y=stick(1)
11640 key$=inkey$
11650 bg=strig(1)
11660 pause 100
11670 wend
11680 select case Button_count
11690 '1 回目
11700 case 0:
11710 '**********************************************************************************************************
11720 '1.ジョイスティック　を　下に下げる or 上に上げる処理。
11730 'ジョイスティックで選択肢を選ぶ
11740 'Select case Button count
11750 'case 0:
11760 '       1.JoyStick 上　と　下
11770 '       2.決定ボタン
11780 'case 1:
11790 '        1.JoyStic 上　と　下
11800 '        2.決定ボタン
11810 'end select
11820 'endif
11830 '**********************************************************************************************************
11840 if ((y=1) or (key$ = chr$(31)) or  (y = -1) or  (key$ = chr$(30))) then
11850 select case No
11860 '0 (選択肢1) → 1 (選択肢2 )
11870 case 0:
11880 No=1:sp_on 4,0:sp_on 5,1:sp_put 5,(5,450),0,0:pause 200:goto Select_Joypad_Kazutama_Save:
11890 '0(選択肢1) → 1(択肢2 )
11900 case 1:
11910 No=0:sp_on 5,0:sp_on 4,1:sp_put 4,(5,350),0,0:pause 200:goto Select_Joypad_Kazutama_Save:
11920 '1(選択肢2) → 0(選択肢1)
11930 'case 2:
11940 'No=0:sp_on 5,0:sp_on 4,1:sp_on 6,0:sp_put 4,(5,350),0,0:pause 200:goto Select_Joypad_Kazutama_Save:
11950 end select
11960 endif
11970 '***********************************************************************************************************
11980 '１．上と下のカーソル　を　下に下げる or 上に上げる　　ここまで
11990 '************************************************************************************************************
12000 '2.ジョイスティック　を 上に上げる。
12010 'if (((y = -1)  or (key$ = chr$(30)))) then
12020 'elect case No
12030 '**************************************************************************************************************
12040 '0(選択肢1) →  2(選択肢3)
12050 'case 0:
12060 'No=2:sp_on 6,0:sp_on 6,1:sp_on 5,0:sp_put 6,(5,550),0,0:pause 200:goto Select_Joypad_Kazutama_Save:
12070 '**************************************************************************************************************
12080 '**************************************************************************************************************
12090 '1(選択肢2)→0(選択肢1)
12100 'case 1:
12110 'No=0:sp_on 5,0:sp_on 4,1:sp_on 6,0:sp_put 4,(5,350),0,0:pause 200:goto Select_Joypad_Kazutama_Save:
12120 '**************************************************************************************************************
12130 '**************************************************************************************************************
12140 '2(選択肢3) → 1(選択肢1)
12150 'case 2:
12160 'No=1:sp_on 5,1:sp_on 4,0:sp_on 6,0:sp_put 5,(5,450),0,0:pause 200:goto Select_Joypad_Kazutama_Save:
12170 '***************************************************************************************************************
12180 'end select
12190 'endif
12200 '***********************************************************************************************************
12210 '3.決定ボタン　決定ボタン(ジョイパッドの右)を押したときの処理　　ここから
12220 '***********************************************************************************************************
12230 if (bg = 2 or key$ = chr$(13)) then
12240 select case No
12250 '選択肢1 No=0
12260 case 0:
12270 '選択肢1 保存するを選択
12280 '1.選択肢 1を押したときの処理
12290 '*********************************************************************************************************
12300 '数霊を保存してから　選択肢を　変更する。
12310 '(Before)
12320 'どうしますか？
12330 '1.保存する
12340 '2.保存しない
12350 '
12360 '　　↓　次の処理  選択肢を変える
12370 '　　
12380 '(After)
12390 'どうしますか？
12400 '1.終了してトップに戻る。
12410 '2.メニューを開く
12420 '*********************************************************************************************************
12430 No = 0:sp_on 4,0:sp_on 5,0:sp_on 6,0:pause 100:
12440 '**********************************************************************************************************
12450 '保存処理をする　Save_Kazutama_data:
12460 '**********************************************************************************************************
12470 gosub Save_Kazutama_data:pause 250:sp_on 4,1:sp_on 5,0:
12480 locate 0,5:print "                             ":locate 0,5:print "どうしますか？":
12490 locate 0,7:print "                             ":locate 0,7:print " :1.終了してトップに戻る":
12500 locate 0,9:print "                             ":locate 0,9:print " :2.メニューを開く"
12510 Button_count = 1
12520 '**********************************************************************************************************
12530 '終了してトップに戻る。
12540 '**********************************************************************************************************
12550 sp_on 4,0:sp_on 5,0:sp_on 6,0:play ""
12560 goto TopScreen:
12570 '**********************************************************************************************************
12580 '2.選択肢 2を押したときの処理
12590 'Beforeで選択肢で保存しないときの処理
12600 '**********************************************************************************************************
12610 '選択肢2
12620 '1回目
12630 '選択肢2:保存しないを選択
12640 case 1:
12650 No = 1:pause 100:sp_on 4,1:sp_on 5,0:
12660 locate 0,5:print "                                   ":locate 0,5:print "どうしますか？":
12670 locate 0,7:print "                                   ":locate 0,7:print " :1.終了してトップに戻る":
12680 locate 0,9:print "                                   ":locate 0,9:print " :2.メニューを開く"
12690 Button_count=1
12700 goto Surei_Result_Menu:
12710 'goto Select_Joypad_Kazutama_Save:
12720 '*********************************************************************************************************************
12730 'case 2:
12740 'No = 2:sp_on 5,0:sp_on 4,0:sp_on 6,0:pause 100:sp_on 4,0:sp_on 6,1:locate 0,5:print "                    ":locate 0,5:print"どうしますか？":locate 0,7:print "                            ":locate 0,7:print " :1.終了してトップに戻る":locate 0,9:print "                  ":locate 0,9:print " :2.もう一度数霊をやる":Button_count=1:goto Select_Joypad_Kazutama_Save:
12750 '**********************************************************************************************************************
12760 '2.選択肢 3を押したときの処理
12770 'case 2:
12780 'No=2
12790 'sp_on 4,0:sp_on 5,0:sp_on 6,0
12800 'pause 100
12810 'gosub SureiResult_Menu:
12820 end select
12830 '2回目 Button_count = 1
12840 endif
12850 '**********************************************************************************************************
12860 '1.ジョイスティック　を　下に下げる or 上に上げる処理。
12870 'ジョイスティックで選択肢を選ぶ
12880 '**********************************************************************************************************
12890 if ((y=1) or (key$ = chr$(31)) or  (y = -1) or  (key$ = chr$(30))) then
12900 select case No
12910 '0 (選択肢1) → 1 (選択肢2 )
12920 case 0:
12930 No=1:sp_on 4,0:sp_on 5,1:sp_put 5,(5,450),0,0:pause 200:goto Select_Joypad_Kazutama_Save:
12940 '1 (選択肢2) → 0 (選択肢1)
12950 case 1:
12960 No=0:sp_on 5,0:sp_on 4,1:sp_put 4,(5,350),0,0:pause 200:goto Select_Joypad_Kazutama_Save:
12970 '1(選択肢2)→0(選択肢1)
12980 'case 2:
12990 'No=0:sp_on 5,0:sp_on 4,1:sp_on 6,0:sp_put 4,(5,350),0,0:pause 200:goto Select_Joypad_Kazutama_Save:
13000 end select
13010 endif
13020 '***********************************************************************************************************
13030 '１．上と下のカーソル　を　下に下げる or 上に上げる　　ここまで
13040 '********************'**************************************************************************************
13050 '3.決定ボタン　決定ボタン(ジョイパッドの右)を押したときの処理　　ここから
13060 '***********************************************************************************************************
13070 if (bg = 2 or key$ = chr$(13)) then
13080 select case No
13090 '1.修了してトップ画面にいく処理
13100 case 0:
13110 '1.選択肢 1を押したときの処理
13120 '*********************************************************************************************************
13130 '数霊を保存してから　選択肢を　変更する。
13140 '(Before)
13150 'どうしますか？
13160 '1.保存する
13170 '2.保存しない
13180 '
13190 '　　↓　次の処理  選択肢を変える
13200 '　　
13210 '(After)
13220 'どうしますか？
13230 '1.終了してトップに戻る。
13240 '2.メニューを開く
13250 '*********************************************************************************************************
13260 No = 0:sp_on 4,0:sp_on 5,0:sp_on 6,0:pause 100
13270 '修了してトップ画面にいく処理
13280 '保存処理をする　Save_Kazutama_data:
13290 'gosub Save_Kazutama_data:pause 5:sp_on 4,1:sp_on 5,0:
13300 'locate 0,5:print "                             ":locate 0,5:print "どうしますか？":
13310 'locate 0,7:print "                             ":locate 0,7:print " :1.終了してトップに戻る":
13320 'locate 0,9:print "                             ":locate 0,9:print " :2.メニューを開く"
13330 'Button_count = 1
13340 '********************************************************************************************************
13350 '2.終了してトップに戻る処理
13360 goto TopScreen:
13370 '**********************************************************************************************************
13380 '2.選択肢 2を押したときの処理
13390 'Beforeで選択肢で保存しないときの処理
13400 '**********************************************************************************************************
13410 'メニューを開く
13420 case 1:
13430 No = 1:sp_on 5,0:sp_on 4,0:sp_on 6,0:pause 100
13440 'locate 0,5:print "                                   ":locate 0,5:print "どうしますか？":
13450 'locate 0,7:print "                                   ":locate 0,7:print " :1.終了してトップに戻る":
13460 'locate 0,9:print "                                   ":locate 0,9:print " :2.メニューを開く"
13470 'Button_count=1
13480 'goto Select_Joypad_Kazutama_Save:
13490 goto Surei_Result_Menu:
13500 '***********************************************************************************************************
13510 '3.決定ボタン　決定ボタン(ジョイパッドの右)を押したときの処理　　ここまで
13520 '***********************************************************************************************************
13530 end select
13540 endif
13550 end select
13560 'endif
13570 '*********************************************************************************************************************
13580 'case 2:
13590 'No = 2:sp_on 5,0:sp_on 4,0:sp_on 6,0:pause 100:sp_on 4,0:sp_on 6,1:locate 0,5:print "                    ":locate 0,5:print"どうしますか？":locate 0,7:print "                            ":locate 0,7:print " :1.終了してトップに戻る":locate 0,9:print "                  ":locate 0,9:print " :2.もう一度数霊をやる":Button_count=1:goto Select_Joypad_Kazutama_Save:
13600 '**********************************************************************************************************************
13610 '2.選択肢 3を押したときの処理
13620 'case 2:
13630 'No=2
13640 'sp_on 4,0:sp_on 5,0:sp_on 6,0
13650 'pause 100
13660 'gosub SureiResult_Menu:
13670 '**********************************************************************************************************************
13680 '選択肢　before　の時の処理
13690 '**********************************************************************************************************************
13700 '**********************************************************************************************************************
13710 '2.決定ボタン　ここまで
13720 '------------------------------------------------------------------------------------------------------------
13730 'JoyPad ここまで
13740 '-------------------------------------------------------------------------
13750 '**************************************************************************************************************
13760 'メニュー項目
13770 'Label:Surei_Result_Menu:
13780 '***************************************************************************************************************
13790 Surei_Result_Menu:
13800 '***************************************************************************************************************
13810 'バーチャルパッドで決定する。
13820 'y:バーチャルパッドの 上 or 下 処理
13830 'key$:カーソルの処理
13840 'キーボード:init "kb:2"
13850 'ハードウエアキーボード "Kb:0"
13860 '***************************************************************************************************************
13870 sp_on 6,0:sp_on 5,0:sp_on 4,0:init "kb:4"
13880 List$(0)="1.もう一度数霊を見る"
13890 List$(1)="2.トップ画面に行く"
13900 List$(2)="3.この数霊の説明を見る"
13910 List$(3)="4.数霊データーを保存"
13920 List$(4)="5.数霊データーの登録件数を見る"
13930 num=ui_select("List$","番号を選んでください")
13940 select case num
13950 '***************************************************************************************************************
13960 '1.もう一度数霊を見る
13970 case 0:
13980 goto Surei_Input:
13990 '***************************************************************************************************************
14000 '***************************************************************************************************************
14010 '2.トップ画面に戻る
14020 case 1:
14030 n = 0:count = 0:count2 = 0:mode = 0:mojicount = 0:n1 = 0:zcount = 0:buffer_moji$ = ""
14040 for i=0 to 9
14050 bufcount$(i) = ""
14060 next i
14070 goto TopScreen:
14080 '*****************************************************************************************************************
14090 '****************************************************************************************************************:
14100 '3.数霊の説明を見る
14110 case 2:
14120 goto Surei_Result4:
14130 '*****************************************************************************************************************
14140 '4.数霊データーを保存する
14150 case 3:
14160 s=Surei_Result_Save_File()
14170 ui_msg "保存しました"
14180 '*******************************************************************************************************************
14190 '5.数霊データーの登録件数を見る
14200 case 4:
14210 '******************************************************************************************************************
14220 'n:数霊の入力したデーターの登録件数
14230 '*******************************************************************************************************************
14240 n = Kazutama_File_Entry_Check()
14250 'goto Read_Entry_Kazutama_Data:
14260 goto Kazutama_data_Entry_count:
14270 case -1:
14280 goto Surei_Result:
14290 'goto TopScreen:
14300 'return
14310 'goto SureiResult_Menu:
14320 case else:
14330 goto Surei_Result:
14340 end select
14350 'ファイルを保存する
14360 'else
14370 'goto Surei_Result:
14380 'endif
14390 '*********************************************************************************************************************
14400 '3-1 バージョン情報　　　　ここから
14410 '*********************************************************************************************************************
14420 Version:
14430 '*********************************************************************************************************************
14440 '3-1 バージョン情報　　　　ここから
14450 '*********************************************************************************************************************
14460 cls 3:Font 32
14470 select case device_No
14480 case 1:
14490 gload Gazo$ + "Screen1_Version.png"
14500 gload Gazo$ + "downscreen.png",0,0,800
14510 case 2:
14520 gload Gazo$ + "Screen1_version.png"
14530 end select
14540 play ""
14550 play Voice_File_TopScreen$ + "Voice_Version.mp3"
14560 color rgb(255,0,0)
14570 print chr$(13)
14580 color rgb(255,255,255)
14590 if lang_flag = 1 then
14600 else
14610 print chr$(13)+chr$(13)+chr$(13)
14620 print "・Ver:";Version$ + chr$(13)
14630 print "・アプリ名:数霊計算機" + chr$(13)
14640 print "・Basic for Android Runtime" + chr$(13)
14650 print "・Author:licksjp" + chr$(13)
14660 print "・制作開始:2021.7.28" + chr$(13)
14670 print chr$(13)
14680 print "(C)Copy right licksjp " + chr$(13)
14690 print "All rights reserved"
14700 endif
14710 bg = 0:key$ = ""
14720 while (bg <> 2 and key$ <> chr$(13))
14730 bg = strig(1)
14740 key$ = inkey$
14750 pause 200
14760 wend
14770 if (key$ = chr$(13)) then
14780 goto TopScreen:
14790 else
14800 if (bg = 2) then
14810 goto TopScreen:
14820 else
14830 if lang_flag = 1 then
14840 else
14850 talk "無効なキーです":goto Version:
14860 endif
14870 endif
14880 endif
14890 '*********************************************************************************************************************
14900 '3-1 バージョン情報　　　　ここまで
14910 '*********************************************************************************************************************
14920 '************************************************************************************************************************************
14930 '3-2 参考文献  ここから
14940 '************************************************************************************************************************************
14950 Reference_Book:
14960 cls 3:Font 48:play""
14970 select case device_No
14980 case 1:
14990 gload Gazo$ + "Screen1_Reference.png"
15000 gload Gazo$ + "downscreen.png",0,0,810
15010 case 2:
15020 gload Gazo$ + "Screen1_Reference.png"
15030 end select
15040 play Voice_File_TopScreen$ + "Voice_referenceBook.mp3"
15050 color rgb(255,0,0)
15060 print chr$(13) + chr$(13)
15070 if lang_flag = 1 then
15080 else
15090 color rgb(255,255,255)
15100 print "・書名:数霊" + chr$(13)
15110 print "・著者:深田　剛史・はせくら　みゆき"+chr$(13)
15120 print "・出版社:徳間書店" + chr$(13)
15130 print "・ISBN:978-4-19-" + chr$(13)
15140 print "         865309-5" + chr$(13)
15150 print "・定価:2300円 + 税"
15160 endif
15170 bg = 0:key$ = ""
15180 while (bg <> 2 and key$ <> chr$(13))
15190 bg = strig(1)
15200 key$ = inkey$
15210 pause 2
15220 wend
15230 if key$ = chr$(13) then
15240 goto TopScreen:
15250 else
15260 if bg = 2 then
15270 goto TopScreen:
15280 else
15290 talk "無効なキーです":goto Reference_Book:
15300 endif
15310 endif
15320 '************************************************************************************************************************************
15330 '3-2 参考文献　ここまで
15340 '************************************************************************************************************************************
15350 '************************************************************************************************************************************
15360 'ヘルプ画面　トップ画面 ここから
15370 '************************************************************************************************************************************
15380 Help:
15390 '************************************************************************************************************************************
15400 'ヘルプ画面　トップ画面 ここから
15410 '************************************************************************************************************************************
15420 No = 1:c = 0
15430 play ""
15440 play Voice_File_TopScreen$ + "Voice_Help_Screen.mp3"
15450 cls 3:Font 48:
15460 select case device_No
15470 case 1:
15480 gload Gazo$ + "Screen1_Help_Top.png",0,0,0
15490 gload Gazo$ + "downscreen.png",0,0,800
15500 case 2:
15510 gload Gazo$ + "Screen1_Help_Top.png",0,0,0
15520 end select
15530 sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,300),0,0
15540 color rgb(255,0,0)
15550 print chr$(13)+chr$(13)+chr$(13)
15560 color rgb(255,255,255)
15570 print "番号を選んでください" + chr$(13)
15580 print " :1.バージョン" + chr$(13)
15590 print " :2.参考文献" + chr$(13)
15600 print " :3.データーの初期化"+chr$(13)
15610 print " :4.トップ画面に行く" + chr$(13)
15620 color rgb(0,0,0)
15630 locate 0,15:print "                                     "
15640 if No = 1 then locate 0,15:print " 1.バージョンを選択"
15650 'y:バーチャルパッドの処理
15660 'key$:カーソルの処理
15670 'bg:バーチャルパッドの右ボタン
15680 Help_key:
15690 '************************************************************************************************************************************************
15700 '変数初期値 y=0:key$="":bg=0
15710 '*************************************************************************************************************************************************
15720 y = 0:key$ = "":bg = 0
15730 while (key$ <> chr$(31) and key$ <> chr$(13) and y <> 1 and y <> -1 and bg <> 2)
15740 y = stick(1)
15750 key$ = inkey$
15760 bg = strig(1)
15770 pause 2
15780 wend
15790 '*****************************************************************************************************************************************************
15800 'バーチャルパッド 下　ここから'
15810 '*****************************************************************************************************************************************************
15820 if (y = 1) then
15830 select case No
15840 'No の初期値：No=1
15850 case 1:
15860 beep:sp_on 0,0:sp_on 1,0:sp_on 2,1:sp_on 3,0:sp_put 2,(5,400),0,0:No=2:pause 200:locate 0,15:print "                                       ":locate 0,15:print" 2.参考文献を選択":goto Help_key:
15870 if lang_flag = 1 then
15880 else
15890 beep:locate 0,15:print" 2.参考文献を選択":goto Help_key:
15900 endif
15910 case 3:
15920 beep:sp_on 2,0:sp_on 0,1:sp_on 1,0:sp_on 3,0:sp_put 0,(5,600),0,0:No=0:pause 200:locate 0,15:print "                                                          ":color rgb(0,0,0):locate 0,15:print " 4.トップ画面に行くを選択":goto Help_key:
15930 case 2:
15940 beep:sp_on 2,0:sp_on 0,0:sp_on 1,0:sp_on 3,1:sp_put 3,(5,500),0,0:pause 200:locate 0,15:print "                                                          ":color rgb(0,0,0):locate 0,15:print " 3.データーの初期化を選択":No=3:goto Help_key:
15950 '0のとき
15960 case 0:
15970 beep:sp_on 0,0:sp_on 1,1:sp_on 2,0:sp_on 3,0:sp_put 1,(5,300),0,0:pause 200:No=1:locate 0,15:print "                                      ":locate 0,15:print " 1.バージョンを選択":goto Help_key:
15980 end select
15990 endif
16000 '***********************************************************************************************************************************************
16010 'バーチャルパッド　下　ここまで
16020 '************************************************************************************************************************************************
16030 'バーチャルパッド　上 ここから
16040 '************************************************************************************************************************************************
16050 if (y = -1) then
16060 select case No
16070 'No:3 3.Help :4.終了:NO:0 → 3.Help No:3
16080 case 1:
16090 beep:sp_on 2,0:sp_on 0,1:sp_on 1,0:sp_on 3,0:sp_put 0,(5,600),0,0:pause 200:No=0:locate 0,15:print"                                                           ":locate 0,15:print" 4.トップ画面に行くを選択":goto Help_key
16100 'No:3 3.Help→2.設定 No:2
16110 case 3:
16120 beep:sp_on 1,0:sp_on 0,0:sp_on 3,0:sp_on 2,1:sp_put 2,(5,400),0,0:pause 200:No=2:locate 0,15:print"                                                          ":locate 0,15:print" 2.参考文献を選択":goto Help_key:
16130 case 2:
16140 beep:sp_on 0,0:sp_on 1,1:sp_on 2,0:sp_on 3,0:sp_put 1,(5,300),0,0:pause 200:No=1:locate 0,15:print "                                                          ":locate 0,15:print" 1.バージョンを選択":goto Help_key:
16150 case 0:
16160 beep:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,1:sp_put 3,(5,500),0,0:No=3:pause 200:locate 0,15:print "                                                          ":locate 0,15:print" 3.データーの初期化を選択":goto Help_key:
16170 end select
16180 endif
16190 '**************************************************************************************************************************************************
16200 'バーチャルパッド　上　ここまで
16210 '*************************************************************************************************************************************************
16220 '決定ボタン ここから
16230 '*************************************************************************************************************************************************
16240 if (bg = 2) then
16250 select case No
16260 '1.数霊チェックを選択  パッドの右キー
16270 case 1:
16280 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto Version:
16290 '2.設定を選択    パッドの右キー
16300 case 2:
16310 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto Reference_Book:
16320 '3.データーの初期化
16330 case 3:
16340 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto data_initialize:
16350 '4.ヘルプを選択 パッドの右
16360 case 0:
16370 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto TopScreen:
16380 'プログラムの終了を選択
16390 'if lang_flag = 1 then
16400 'lang_flag = 1:英語
16410 'Else
16420 'lang_flag = 0:日本語
16430 'endif
16440 end select
16450 '4.終了するを選択  パッドの右
16460 endif
16470 '**************************************************************************************************************************************************
16480 'バーチャルパッド　決定ボタン　ここまで
16490 '**************************************************************************************************************************************************
16500 'key$ = input$(1)
16510 'カーソルの下
16520 if key$ = chr$(31) then
16530 select case (No Mod 4)
16540 'バージョンから参考文献
16550 case 0:
16560 c=1:No=c:beep:locate 0,15:Print "             ":locate 0,15:print " 2.参考文献を選択":sp_on 0,0:sp_on 1,1:sp_on 2,0:sp_on 3,0:sp_put 1,(5,300),0,0:goto Help_key:
16570 '参考文献からトップ画面
16580 case 1:
16590 c=2:No=c:beep:sp_on 0,0:sp_on 1,0:sp_on 2,1:sp_on 3,0:sp_put 2,(5,500),0,0:locate 0,15:print "            ":locate 0,15:print " 3.トップ画面に行くを選択":goto Help_key:
16600 'トップ画面から終了
16610 '終了からバージョン
16620 case 2:
16630 c=0:No=c:beep:sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,300),0,0:locate 0,15:print "                     ":locate 0,15:print " 1.バージョンを選択":goto Help_key:
16640 case else:
16650 goto Help_key:
16660 end select
16670 endif
16680 'カーソル　上
16690 if (key$ = chr$(30)) then
16700 select case (c Mod 4)
16710 'バージョンから終了
16720 case 0:
16730 c=3:No=c:beep:sp_on 3,1:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_put 3,(5,600),0,0:locate 0,15:print "                   ":locate 0,15:print " 4.終 了を選択":goto Help_key:
16740 '参考文献からバージョン
16750 case 1:
16760 c=0:No=c:beep:sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,300),0,0:locate 0,15:print "                   ":locate 0,15:print " 1.バージョンを選択":goto Help_key:
16770 'トップ画面から参考文献
16780 case 2:
16790 c=1:No=c:beep:sp_on 0,0:sp_on 1,1:sp_on 2,0:sp_on 3,0:sp_put 1,(5,400),0,0:locate 0,15:print "                    ":locate 0,15:print " 2.参考文献を選択":goto Help_key:
16800 '終了からトップ画面を選択
16810 case 3:
16820 c=2:No=c:beep:sp_on 0,0:sp_on 1,0:sp_on 2,1:sp_on 3,0:sp_put 2,(5,500),0,0:locate 0,15:print"                      ":locate 0,15:print " 3.トップ画面に行くを選択":goto Help_key:
16830 case else:
16840 goto Help_key:
16850 end select
16860 endif
16870 'エンターキー：決定
16880 if (key$ = chr$(13)) then
16890 if No=1 then :sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Version:
16900 if No=0 then :sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto TopScreen:
16910 if No=2 then :sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Reference_Book:
16920 else
16930 goto Help_key:
16940 endif
16950 '登録文字の確認
16960 '文字を1文字入れて登録されているか調べるメニュー
16970 '設定項目
16980 Setting:
16990 cls 3:Font 48
17000 select case device_No
17010 case 1:
17020 gload Gazo$ + "Screen1_Setting_Top.png",0,0,0
17030 gload Gazo$ + "downscreen.png",0,0,800
17040 case 2:
17050 gload Gazo$ + "Screen1_Setting_Top.png",0,0,0
17060 end select
17070 play ""
17080 play Voice_File_TopScreen$ + "Voice_Setting_Top.mp3"
17090 No=1
17100 sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,300),0,0:
17110 color rgb(0,0,255)
17120 print chr$(13)
17130 if lang_flag = 1 then
17140 'lang_flag = 1:英語
17150 else
17160 'lang_flag = 0:日本語
17170 color rgb(255,255,255)
17180 print chr$(13)
17190 print "番号を選んでください" + chr$(13)
17200 '-------コメント----------------
17210 'print " :1.登録文字の確認" + chr$(13)
17220 'print " :2.数霊文字確認" + chr$(13)
17230 '-------コメント----------------
17240 'print chr$(13)
17250 print " :1.文字の項目" + chr$(13)
17260 print " :2.結果表示設定" + chr$(13)
17270 print " :3.言語設定" + chr$(13)
17280 print " :4.トップ画面に行く" + chr$(13)
17290 endif
17300 color rgb(0,0,0)
17310 locate 0,15
17320 if No=1 then locate 0,15:print  "                                     ":locate 0,15:print " 1.文字の項目を選択"
17330 '*******************************************************************************************************************************
17340 'y:バーチャルパッドの処理
17350 'key$:カーソルの処理
17360 'bg:バーチャルパッドの右ボタン
17370 '*********************************************************************************************************************************
17380 SettingScreen:
17390 y = 0:key$ = "":bg=0
17400 while (key$ <> chr$(31) and key$ <> chr$(13) and y <> 1 and y <> -1 and bg<>2)
17410 y = stick(1)
17420 key$ = inkey$
17430 bg=strig(1)
17440 pause 2
17450 wend
17460 '***********************************************************************************************************************************
17470 'バーチャルパッド　ここから'
17480 'バーチャルパッド　ここから'
17490 '************************************************************************************************************************************
17500 'バーチャルパッド　下
17510 '*************************************************************************************************************************************
17520 if (y = 1) then
17530 select case No
17540 'No の初期値：No=1
17550 case 1:
17560 beep:sp_on 0,0:sp_on 1,1:sp_on 2,0:sp_on 3,0:sp_put 1,(5,400),0,0:No=2:pause 200:locate 0,15:print "                                       ":color rgb(0,0,0):locate 1,15:print "2.結果表示設定を選択":goto SettingScreen:
17570 'デバッグライン　ここから
17580 '0のとき
17590 'デバッグライン　ここまで
17600 'デバッグライン　ここから
17610 case 2:
17620 beep:sp_on 2,1:sp_on 0,0:sp_on 1,0:sp_on 3,0:sp_put 2,(5,500),0,0:pause 200:locate 0,15:print "                         "
17630 color rgb(0,0,0)::No=3
17640 if lang_flag = 1 then
17650 else
17660 locate 1,15:print "3.言語設定を選択":goto SettingScreen:
17670 endif
17680 'デバッグライン　ここまで
17690 case 3:
17700 beep:sp_on 3,1:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_put 3,(5,590),0,0:pause 200:locate 0,15:print"                                              ":locate 1,15:print "4.トップ画面に行くを選択":No=0:goto SettingScreen:
17710 'デバッグライン　ここから
17720 'locate 1,12:print"count=";count;chr$(13):count = count + 1:goto Main_Select:
17730 'デバッグライン　ここまで
17740 case 0:
17750 beep:sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,300),0,0:pause 200:No=1:locate 0,15:print"                                      ":locate 1,15:print "1.文字の項目を選択":goto SettingScreen:
17760 'デバッグライン　ここから
17770 ' locate 1,12:print "b=";b;chr$(13):count=count+1:goto Main_Select:
17780 'デバッグライン　ここまで
17790 end select
17800 endif
17810 '***************************************************************************************************************************************
17820 'バーチャルパッド　下　ここまで
17830 '***************************************************************************************************************************************
17840 'バーチャルパッド　上 ここから
17850 '***************************************************************************************************************************************
17860 if (y = -1) then
17870 select case No
17880 'No:0  4.終了  :1数霊チェック No:1　→　4.終了 No:0
17890 case 1:
17900 Beep:sp_on 3,1:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_put 3,(5,590),0,0:pause 200:No=0:locate 0,15:print "                                       ":locate 1,15:print"4.トップ画面に行くを選択":goto SettingScreen:
17910 'No:3 3.Help :4.終了:NO:0 → 3.Help No:3
17920 case 0:
17930 beep:sp_on 2,1:sp_on 0,0:sp_on 1,0:sp_on 3,0:sp_put 2,(5,500),0,0:pause 200:No=3:locate 0,15:print"                                       ":locate 1,15:print"3.言語設定を選択":goto SettingScreen:
17940 'No:3 3.Help→2.設定 No:2
17950 case 3:
17960 beep:sp_on 1,1:sp_on 0,0:sp_on 3,0:sp_on 2,0:sp_put 1,(5,400),0,0:pause 200:No=2:locate 0,15:print"                                      ":locate 1,15:print"2.結果表示設定を選択":goto SettingScreen:
17970 case 2:
17980 beep:sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,300),0,0:pause 200:No=1:locate 0,15:print "                                      ":locate 1,15:print"1.文字の項目を選択":goto SettingScreen:
17990 end select
18000 endif
18010 '*******************************************************************************************************************************************
18020 'バーチャルパッド　上　ここまで
18030 '********************************************************************************************************************************************
18040 '決定ボタン　ここから
18050 '*********************************************************************************************************************************************
18060 if (bg=2) then
18070 select case No
18080 '1.数霊チェックを選択  パッドの右キー
18090 case 1:
18100 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto Select_moji:
18110 '2.設定を選択    パッドの右キー
18120 case 2:
18130 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto Kakunin_Surei_count:
18140 '3.ヘルプを選択 パッドの右
18150 case 0:
18160 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto TopScreen:
18170 'プログラムの終了を選択
18180 case 3:
18190 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto Setting_Language:
18200 end select
18210 endif
18220 '*********************************************************************************************************************************************
18230 '決定ボタン　ここまで
18240 '*********************************************************************************************************************************************
18250 '4.終了するを選択  パッドの右
18260 'バーチャルパッド　ここまで'
18270 'カーソル下'
18280 '************************************************************************************************************************************************
18290 if (key$ = chr$(31)) then
18300 select case (No Mod 4)
18310 '登録文字から数霊文字の確認
18320 case 1:
18330 c=2:No=c:beep:sp_on 0,1:sp_on 1,1:sp_on 2,0:sp_on 3,0:sp_put 0,(5,300),0,0:locate 0,15:print "                                     ":locate 1,15:print "2.結果表示設定を選択":goto SettingScreen:
18340 '数霊文字の確認からトップ画面に行く
18350 case 2:
18360 c=3:No=c:beep:sp_on 0,0:sp_on 1,0:sp_on 2,1:sp_on 3,0:sp_put 2,(5,500),0,0:locate 0,15:print "                                     ":locate 1,15:print"3.言語設定を選択":goto SettingScreen:
18370 'トップ画面に行くから終了
18380 case 3:
18390 c=0:No=c:beep:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,1:sp_put 3,(5,590),0,0:locate 0,15:print "                                       ":locate 1,15:print "4.トップ画面に行くを選択":goto SettingScreen:
18400 '終了から登録文字
18410 case 0:
18420 c=1:No=c:beep:sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,300),0,0:locate 0,15:print "                                      ":locate 1,15:print "1.文字の項目を選択":goto SettingScreen:
18430 end select
18440 endif
18450 'カーソル　上
18460 if (key$ = chr$(30)) then
18470 select case (No Mod 4)
18480 case 1:
18490 c=2:No=c:beep:sp_on 0,1:sp_put 0,(5,300),0,0:sp_on 3,0:sp_on 1,0:sp_on 2,0:goto SettingScreen:
18500 case 2:
18510 c=3:No=c:beep:sp_on 1,1:sp_put 1,(5,400),0,0:sp_on 0,0:sp_on 2,0:sp_on 3,0:goto SettingScreen:
18520 case 3:
18530 c=0:No=c:beep:sp_on 0,0:sp_on 1,0:sp_on 2,1:sp_on 3,0:sp_put 2,(5,500),0,0:goto SettingScreen:
18540 case 0:
18550 c=1:No=c:beep:sp_on 3,1:sp_on 1,0:sp_on 2,1:sp_put 3,(5,590),0,0:sp_on 0,0:goto SettingScreen:
18560 end select
18570 endif
18580 'エンターキーを押したとき
18590 if (key$ = chr$(13)) then
18600 if (No=3) then goto Setting_Language:
18610 if No=1 then sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Select_moji:
18620 if No=2 then sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto config_moji2:
18630 if (No=0) then sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto TopScreen:
18640 endif
18650 '文字検索項目  ここから
18660 Moji_Search:
18670 cls 4:cls 3:Font 32+16:init"kb:2"
18680 gload Gazo$ + "Moji_Search_Result.png",0,0,0
18690 gload Gazo$ + "MiddleScreen_20230401.png",0,0,240
18700 play ""
18710 play Voice_File_TopScreen$ + "Voice_Entry_mojicheck.mp3"
18720 print "" + chr$(13)
18730 color rgb(255,255,255)
18740 if lang_flag = 1 then
18750 Else
18760 print "文字を一文字入れてください" + chr$(13)
18770 endif
18780 color rgb(0,0,0)
18790 if lang_flag=1 then
18800 else
18810 Input "登録文字:",moji$
18820 endif
18830 moji_count = len(moji$)
18840 if moji_count > 1 then
18850 talk"文字は一文字で入れてください":ui_msg "文字は一文字入れてください":goto Moji_Search:
18860 else
18870 count=0:
18880 for n = 0 to 116
18890 if bufline$(2*n) = moji$ then
18900 cls 3:font 48:init"kb:4":
18910 select case device_No
18920 case 1:
18930 gload Gazo$ + "downscreen.png",0,0,800
18940 gload Gazo$ + "MiddleScreen_20230401.png",0,0,240
18950 gload Gazo$ + "Moji_Search_Result.png",0,0,0
18960 case 2:
18970 gload Gazo$ + "Moji_Search_Result.png",0,0,0
18980 end select
18990 play ""
19000 play Voice_File_TopScreen$ + "Voice_Entry_OK.mp3"
19010 if lang_flag = 1 then
19020 else
19030 bg=0:key$=""
19040 print chr$(13)
19050 color rgb(255,255,255)
19060 print moji$;"は、登録されています。" + chr$(13)
19070 color rgb(0,0,0)
19080 print "ジョイパッドの右を押してください"
19090 endif
19100 'bg = 0:key$ = ""
19110 while (bg <> 2 and key$ <> chr$(13))
19120 key$ = inkey$
19130 bg = strig(1)
19140 pause 200
19150 wend
19160 if ((key$ = chr$(13)) or (bg = 2)) then goto TopScreen:
19170 count = count + 1
19180 endif
19190 next n
19200 if count = 0 then
19210 cls 3:font 48:init "kb:4":bg=0:key$=""
19220 select case (device_No)
19230 case 1:
19240 gload Gazo$ + "Moji_check.png",0,0,0
19250 gload Gazo$ + "MiddleScreen_20230401.png",0,0,240
19260 gload Gazo$ + "downscreen.png",0,0,800
19270 case 2:
19280 gload Gazo$ + "Moji_check.png",0,0,0
19290 end select
19300 play ""
19310 play Voice_File_TopScreen$ + "Voice_Entry_NG.mp3"
19320 print chr$(13)
19330 if lang_flag = 1 then
19340 else
19350 color rgb(255,255,255)
19360 print moji$;"は、登録されていません。" + chr$(13)
19370 color rgb(0,0,0)
19380 print "パッドの右を押してください" + chr$(13)
19390 endif
19400 while (bg <> 2 and key$ <> chr$(13))
19410 key$ = inkey$
19420 bg = strig(1)
19430 pause 2
19440 wend
19450 if ((key$ = chr$(13)) or (bg = 2)) then goto TopScreen:
19460 endif
19470 endif
19480 Surei_Result2:
19490 cls 3:Font 48:init "kb:4"
19500 zcount1=0:zcount2=0:count1=0:count2=0
19510 '1人目
19520 mojicount1=len(buf_Parson1$)
19530 '2人目
19540 mojicount2 = len(buf_Parson2$)
19550 '1人目
19560 for n = 1 to mojicount1
19570 for j = 1 to 116
19580 bufcount1$(n-1)=Mid$(buf_Parson1$,n,1)
19590 if bufcount1$(n-1) = bufline$(2*j) then
19600 zcount1 = zcount1 + 1
19610 endif
19620 next j
19630 next n
19640 '2人目
19650 for n = 1 to mojicount2
19660 for j = 1 to 116
19670 bufcount2$(n-1)=Mid$(buf_Parson2$,n,1)
19680 if bufcount2$(n-1) = bufline$(2*j) then
19690 zount2 = zcount2 + 1
19700 endif
19710 next j
19720 next n
19730 '1人目
19740 for i=1 to mojicount1
19750 bufcount1$(i-1) = Mid$(buf_Parson1$,i,1)
19760 p1 = Complate(bufcount1$(i-1))
19770 count1 = count1 + p1
19780 next i
19790 '2人目
19800 for i = 1 to mojicount2
19810 bufcount2$(i - 1) = Mid$(buf_Parson2$,i,1)
19820 p2 = Complate(bufcount2$(i-1))
19830 count2 = count2 + p2
19840 next i
19850 cls 3:
19860 select case device_No
19870 case 1:
19880 gload Gazo$ + "Screen1_2Parson_Result.png":init "kb:4"
19890 'gload Gazo$ + "downscreen.png",0,0,800
19900 case 2:
19910 gload Gazo$ + "Screen1_2Parson_Result.png"
19920 'gload Gazo$ + "downscreen.png",0,0,0
19930 end select
19940 color rgb(255,0,0)
19950 print ""+chr$(13)
19960 if lang_flag = 1 then
19970 else
19980 color rgb(255,255,255)
19990 print chr$(13)+chr$(13)
20000 print "1人目:";buf_Parson1$;chr$(13)
20010 print "数霊1:";count1;chr$(13)
20020 print "2人目:";buf_Parson2$;chr$(13)
20030 print "数霊2:";count2;chr$(13)
20040 print "数霊(合計):";count1 + count2;chr$(13)
20050 color rgb(0,0,0)
20060 print "バーチャルパッドの右" + chr$(13)
20070 endif
20080 key$ = "":bg = 0
20090 while (bg <> 2 and key$ <> chr$(13))
20100 bg = strig(1)
20110 key$ = inkey$
20120 pause 2
20130 wend
20140 if (bg = 2 or key$ = chr$(13))  then goto TopScreen:
20150 Surei_Result3:
20160 cls 3:Font 48
20170 zcount2 = 0:count2 = 0
20180 mojicount2 = len(buffer_moji2$)
20190 for n = 1 to mojicount2
20200 for j = 1 to 116
20210 bufcount2$(n - 1) = Mid$(buffer_moji2$,n,1)
20220 if bufcount2$(n - 1) = bufline$(2 * j) then
20230 zcount2 = zcount2 + 1
20240 endif
20250 next j
20260 next n
20270 for i = 1 to mojicount2
20280 n2 = Complate(bufcount2$(i-1))
20290 count2 = count2 + n2
20300 next i
20310 gload Gazo$ + "Screen5.png"
20320 if lang_flag = 1 then
20330 else
20340 color rgb(255,0,0)
20350 print "数霊の結果表示" + chr$(13)
20360 color rgb(255,255,255)
20370 print "１回目回の文字入力:";buffer_moji$;chr$(13)
20380 print "１回目の数霊(かずたま)";count;chr$(13)
20390 print "今回(2回目)の文字:";buffer_moji2$;chr$(13)
20400 print "今回(2回目)の数霊(かずたま)";count2;chr$(13);chr$(13)
20410 color rgb(0,0,0)
20420 print "エンターキー:トップ画面";chr$(13)
20430 print "c or C キー:数霊の比較";chr$(13)
20440 endif
20450 key$ = "":bg = 0
20460 while (key$ <> chr$(13) and bg <> 2)
20470 bg = strig(1)
20480 key$ = inkey$
20490 pause 2
20500 wend
20510 if key$ = chr$(13) then mode = 0:count = 0:count2 = 0:goto TopScreen:
20520 if key$ = "c" or key$ = "C" then
20530 if count = count2 then
20540 play Voice_File_TopScreen$ + "Voice_Result_KazutamacheckOK.mp3":goto Surei_Result3
20550 else
20560 play Voice_File_TopScreen$ + "Voice_Result_KazutamacheckNG.mp3":goto Surei_Result3:
20570 endif
20580 endif
20590 Moji_Count_Check:
20600 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0
20610 cls 3:Font 48
20620 select case device_No
20630 case 1:
20640 gload Gazo$ + "Moji_check.png"
20650 gload Gazo$ + "MiddleScreen_20230401.png",0,0,240
20660 gload Gazo$ + "downscreen.png",0,0,800
20670 case 2:
20680 gload Gazo$ + "Moji_check.png",0,0,0
20690 end select
20700 n = 0
20710 open FILE_csv$ for input as #1
20720 while eof(1) = 0
20730 line input #1, line$
20740 n = n + 1
20750 wend
20760 close #1
20770 play ""
20780 if (n = 118) then
20790 play Voice_File_TopScreen$ + "Voice_Entry_moji_count118.mp3"
20800 if lang_flag = 1 then
20810 else
20820 print "" + chr$(13)
20830 color rgb(255,255,255)
20840 print "文字の登録文字数は";n;"文字" + chr$(13)
20850 color rgb(0,0,0)
20860 print "パッドの右を押してください" + chr$(13)
20870 endif
20880 endif
20890 key$ = "":bg = 0
20900 while ((key$ <> chr$(13)) and (bg <> 2))
20910 key$=inkey$
20920 bg=strig(1)
20930 pause 2
20940 wend
20950 if ((bg = 2) or (key$=chr$(13))) then
20960 goto TopScreen:
20970 else
20980 goto Moji_Count_Check:
20990 endif
21000 'Save 関数
21010 file_kazutama = 0
21020 file_kazutama = Save_File()
21030 func Save_File()
21040 open SAVE_DATA1$  for output as #1
21050 print #1,"入力文字:" + buffer_moji$ + ",数霊:" + str$(count)
21060 close #1
21070 endfunc
21080 Select_moji:
21090 cls 3:font 48:No = 1
21100 select case device_No
21110 case 1:
21120 gload Gazo$ + "Screen1_mojicheck.png",0,0,0
21130 gload Gazo$ + "downscreen.png",0,0,800
21140 case 2:
21150 gload Gazo$ + "Screen1_mojicheck.png",0,0,0
21160 end select
21170 sp_on 3,0:sp_on 2,0:sp_on 1,0:sp_on 0,1:sp_put 0,(5,300),0,0
21180 color rgb(255,0,0)
21190 if lang_flag = 1 then
21200 else
21210 play ""
21220 play Voice_File_TopScreen$ + "Voice_Select_Moji20230217.mp3"
21230 print chr$(13)+chr$(13)+chr$(13)
21240 color rgb(255,255,255)
21250 print "番号を選んでください" + chr$(13)
21260 print " :1.登録文字検索"+ chr$(13)
21270 print " :2.登録文字数の確認" + chr$(13)
21280 print " :3.数字から数霊の説明"+chr$(13)
21290 print " :4.トップ画面に戻る" + chr$(13)
21300 color rgb(0,0,0)
21310 locate 0,15
21320 if No = 1 then print " 1.登録文字検索を選択"
21330 endif
21340 Entry_check_key:
21350 '************************************************************************************************************************************
21360 y = 0:key$ = "":bg=0
21370 '************************************************************************************************************************************
21380 while (key$ <> chr$(31) and key$ <> chr$(13) and y <> 1 and y <> -1 and bg<> 2)
21390 y = stick(1)
21400 key$ = inkey$
21410 bg=strig(1)
21420 pause 2
21430 wend
21440 '**************************************************************************************************************************************
21450 'バーチャルパッド　下　ここから
21460 'バーチャルパッド　下　ここから
21470 '***************************************************************************************************************************************
21480 if y = 1 then
21490 select case No
21500 'No の初期値：No=1
21510 case 1:
21520 beep:sp_on 0,0:sp_on 1,0:sp_on 2,1:sp_on 3,0:sp_put 2,(5,400),0,0:No=2:pause 200:locate 0,15:print "                                       ":locate 1,15:print "2.登録文字数の確認を選択":goto Entry_check_key:
21530 'デバッグライン　ここから
21540 '0のとき
21550 'デバッグライン　ここまで
21560 'デバッグライン　ここから
21570 case 2:
21580 beep:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,1:sp_put 3,(5,500),0,0:pause 200:locate 0,15:print "                                                         ":No=3:locate 0,15:print" 3.数字から数霊の説明を選択":goto Entry_check_key:
21590 case 3:
21600 beep:sp_on 2,0:sp_on 0,1:sp_on 1,0:sp_on 3,0:sp_put 0,(5,600),0,0:pause 200:locate 0,15:print "                                       "
21610 :No=0
21620 'if lang_flag = 1 then
21630 'Else
21640 color rgb(0,0,0):locate 0,15:print " 4.トップ画面に戻るを選択":goto Entry_check_key:
21650 'endif
21660 'cls:color rgb(255,255,255):print"ok"
21670 'デバッグライン　ここまで
21680 'デバッグライン　ここから
21690 'locate 1,12:print"count=";count;chr$(13):count = count + 1:goto Main_Select:
21700 'デバッグライン　ここまで
21710 case 0:
21720 beep:sp_on 0,0:sp_on 1,1:sp_on 2,0:sp_on 3,0:sp_put 1,(5,300),0,0:pause 200:No=1:locate 0,15:print"                                      ":locate 0,15:print " 1.登録文字検索を選択":goto Entry_check_key:
21730 'デバッグライン　ここから
21740 ' locate 1,12:print "b=";b;chr$(13):count=count+1:goto Main_Select:
21750 'デバッグライン　ここまで
21760 end select
21770 endif
21780 '*********************************************************************************************************************************************
21790 'Joypad　下　ここまで
21800 '*********************************************************************************************************************************************
21810 'バーチャルパッド　上 ここから
21820 '************************************************************************************************************************************************
21830 if y = -1 then
21840 select case No
21850 'No:0  4.終了  :1数霊チェック No:1　→　4.終了 No:0
21860 'No:3 3.Help :4.終了:NO:0 → 3.Help No:3
21870 case 0:
21880 beep:sp_on 3,1:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_put 3,(5,500),0,0:pause 200:No=3:locate 0,15:print "                                      ":locate 0,15:print " 3.数字から数霊の説明を選択":goto Entry_check_key:
21890 case 1:
21900 beep:sp_on 2,0:sp_on 0,1:sp_on 1,0:sp_on 3,0:sp_put 0,(5,600),0,0:pause 200:No=0:locate 0,15:print"                                      ":locate 1,15:print"4.トップ画面に戻るを選択":goto Entry_check_key:
21910 'No:3 3.Help→2.設定 No:2
21920 case 3:
21930 beep:sp_on 1,1:sp_on 0,0:sp_on 3,0:sp_on 2,0:sp_put 1,(5,400),0,0:pause 200:No=2:locate 0,15:print"                                      ":locate 1,15:print"2.登録文字数の確認を選択":goto Entry_check_key:
21940 case 2:
21950 beep:sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,300),0,0:pause 200:No=1:locate 0,15:print "                                      ":locate 0,15:print " 1.登録文字検索を選択":goto Entry_check_key:
21960 end select
21970 endif
21980 '***************************************************************************************************************************************************
21990 'バーチャルパッド　上　ここまで
22000 '****************************************************************************************************************************************************8
22010 '*****************************************************************************************************************************************************
22020 '決定ボタン　ここから
22030 '*****************************************************************************************************************************************************
22040 if (bg = 2) then
22050 select case No
22060 '1.数霊チェックを選択  パッドの右キー
22070 case 1:
22080 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Moji_Search:
22090 '2.設定を選択    パッドの右キー
22100 case 2:
22110 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Moji_Count_Check:
22120 '3.ヘルプを選択 パッドの右
22130 case 0:
22140 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto TopScreen:
22150 case 3:
22160 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Input_numbertokazutama:
22170 end select
22180 endif
22190 '****************************************************************************************************************************************************
22200 '決定ボタン　ここまで
22210 '****************************************************************************************************************************************************
22220 '4.終了するを選択  パッドの右
22230 'バーチャルパッド　ここまで'
22240 'key$ = input$(1)
22250 'カーソルの下
22260 '*****************************************************************************************************************************************************
22270 if (key$ = chr$(31)) then
22280 select case (No Mod 4)
22290 case 0:
22300 beep:c=1:No=c:sp_on 1,1:sp_put 1,(5,400),0,0:sp_on 0,0:sp_on 2,0:sp_on 0,0:goto Entry_check_key:
22310 case 1:
22320 beep:c=2:No=c:sp_on 0,1:sp_on 1,0:sp_on 2,1:sp_put 2,(5,500),0,0:sp_on 3,0:goto Entry_check_key:
22330 case 2:
22340 beep:c=3:No=c:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,1:sp_put 3,(5,600),0,0:goto Entry_check_key:
22350 case 3:
22360 beep:c=0:No=c:sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,200),0,0:goto Entry_check_key:
22370 end select
22380 endif
22390 '***************************************************************************************************************************************************
22400 'カーソル　上
22410 '***************************************************************************************************************************************************
22420 if (key$ = chr$(30)) then
22430 select case (No Mod 4)
22440 case 0:
22450 beep:c=3:No=c:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,1:sp_put 3,(5,300),0,0:goto Entry_check_key:
22460 case 1:
22470 beep:c=0:No=c:sp_on 0,1:sp_put 0,(5,200),0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Entry_check_key:
22480 case 2:
22490 beep:c=1:No=c:sp_on 0,0:sp_on 1,1:sp_on 2,0:sp_on 3,0:sp_put 1,(5,300),0,0:goto Entry_check_key:
22500 case 3:
22510 beep:c=2:No=c:sp_on 0,0:sp_on 1,0:sp_on 2,1:sp_on 3,0:sp_put 2,(5,400),0,0:goto Entry_check_key:
22520 end select
22530 endif
22540 '************************************************************************************************************************************************
22550 'エンターキーを押す
22560 '****************************************************************************************************************************************************
22570 if (key$ = chr$(13)) then
22580 if No = 1 then sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Moji_Search:
22590 if No = 2 then sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Moji_Count_Check:
22600 if No = 0 then sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto TopScreen:
22610 endif
22620 '*****************************************************************************************************************************************************
22630 Kakunin_Surei_count:
22640 cls 3:font 48:No=0
22650 select case device_No
22660 case 1:
22670 gload Gazo$ + "Kazutama_List_Top.png",0,0,0
22680 'gload Gazo$ + "MiddleScreen_20230401.png",0,0,240
22690 gload Gazo$ + "downscreen.png",0,0,800
22700 case 2:
22710 gload Gazo$ + "Kazutama_List_Top.png",0,0,0
22720 end select
22730 sp_on 3,0:sp_on 2,0:sp_on 1,0:sp_on 0,1:sp_put 0,(5,300),0,0
22740 color rgb(255,0,0)
22750 print chr$(13)+chr$(13)+chr$(13)
22760 color rgb(255,255,255)
22770 print "番号を選んでください" + chr$(13)
22780 print " :1.プロフィール" + chr$(13)
22790 print " :2.結果表示設定" + chr$(13)
22800 print " :3.トップ画面に行く" + chr$(13)
22810 print "" + chr$(13)
22820 color rgb(0,0,0)
22830 locate 0,15:print"                                                         "
22840 if No = 0 then locate 1,15:print "1.数霊リスト　1人用を選択"
22850 Entry_List:
22860 '*****************************************************************************************************************************************
22870 y = 0:key$ = "":bg=0
22880 '*****************************************************************************************************************************************
22890 while (key$ <> chr$(31) and key$ <> chr$(13) and y <> 1 and y <> -1 and bg<> 2)
22900 y = stick(1)
22910 key$ = inkey$
22920 bg = strig(1)
22930 pause 2
22940 wend
22950 '*****************************************************************************************************************************************
22960 'バーチャルパッド　ここから'
22970 'バーチャルパッド　ここから'
22980 'バーチャルパッド　下
22990 '******************************************************************************************************************************************
23000 if (y = 1) then
23010 select case No
23020 'No の初期値：No=1
23030 case 0:
23040 beep:sp_on 0,0:sp_on 1,1:sp_on 2,0:sp_on 3,0:sp_put 1,(5,400),0,0:No=1:pause 200:locate 0,15:print "                                       ":locate 1,15:print"2.結果表示設定を選択":goto Entry_List:
23050 'デバッグライン　ここから
23060 '0のとき
23070 'デバッグライン　ここまで
23080 'デバッグライン　ここから
23090 'color rgb(0,0,0):locate 0,15:print " 4.終了を選択":goto Entry_List:
23100 'cls:color rgb(255,255,255):print"ok"
23110 'デバッグライン　ここまで
23120 case 2:
23130 beep:sp_on 3,0:sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_put 0,(5,300),0,0:pause 200:locate 0,15:print"                                       ":locate 0,15:print " 1.数霊リスト 1人用を選択":No=0:goto Entry_List:
23140 case 1:
23150 beep:sp_on 0,0:sp_on 1,0:sp_on 2,1:sp_on 3,0:sp_put 2,(5,500),0,0:pause 200:locate 0,15:print "                                      ":No=2:locate 1,15:print "3．トップ画面に行くを選択":goto Entry_List:
23160 'デバッグライン　ここから
23170 'locate 1,12:print"count=";count;chr$(13):count = count + 1:goto Entry_List:
23180 'デバッグライン　ここまで
23190 'デバッグライン　ここから
23200 ' locate 1,12:print "b=";b;chr$(13):count=count+1:goto Entry_List:
23210 'デバッグライン　ここまで
23220 end select
23230 endif
23240 '****************************************************************************************************************************************************
23250 'バーチャルパッド　下　ここまで
23260 '**********************************************************************************************************************************************
23270 'バーチャルパッド　上 ここから
23280 '***************************************************************************************************************************************************
23290 if (y = -1) then
23300 select case No
23310 'No:0  4.終了  :1数霊チェック No:1　→　4.終了 No:0
23320 case 2:
23330 beep:sp_on 2,0:sp_on 0,0:sp_on 1,1:sp_on 3,0:sp_put 1,(5,400),0,0:pause 200:No=1:locate 0,15:print "                                      ":locate 0,15:print " 2.結果表示設定を選択":goto Entry_List:
23340 'No:3 3.Help :4.終了:NO:0 → 3.Help No:3
23350 case 0:
23360 beep:sp_on 2,1:sp_on 0,0:sp_on 1,0:sp_on 3,0:sp_put 2,(5,500),0,0:pause 200:No=2:locate 0,15:print "                                      ":locate 1,15:print"3.トップ画面に行くを選択":goto Entry_List:
23370 'No:3 3.Help→2.設定 No:2
23380 case 1:
23390 beep:sp_on 1,0:sp_on 0,1:sp_on 3,0:sp_on 2,0:sp_put 0,(5,300),0,0:pause 200:No=0:locate 0,15:print"                                      ":locate 1,15:print "1.数霊リスト 1人用を選択":goto Entry_List:
23400 end select
23410 endif
23420 '***************************************************************************************************************************************************
23430 'バーチャルパッド　上　ここまで
23440 '***************************************************************************************************************************************************
23450 '****************************************************************************************************************************************************
23460 '決定ボタン　ここから
23470 '*****************************************************************************************************************************************************
23480 if (bg = 2) then
23490 select case No
23500 '1.数霊リスト 一人用を選択を選択  パッドの右キー
23510 case 0:
23520 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:cls 2:goto myProfile_File_Check:
23530 'goto Input_name_Sei_Kangi:
23540 '2.設定を選択  パッドの右キー
23550 case 1:
23560 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Result_Setting:
23570 case 2:
23580 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto TopScreen:
23590 end select
23600 endif
23610 '***************************************************************************************************************************************************
23620 '決定ボタン　ここまで
23630 '****************************************************************************************************************************************************
23640 if (key$ = chr$(13)) then
23650 select case No
23660 case 0:
23670 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Surei_List1:
23680 case 1:
23690 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Result_Setting:
23700 case 2:
23710 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto TopScreen:
23720 end select
23730 endif
23740 '4.終了するを選択  パッドの右
23750 'バーチャルパッド　ここまで'
23760 Surei_List1:
23770 cls 3:font 48
23780 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 4,0:sp_on 3,0
23790 file$ = dir$(SAVE_DATA1$,0)
23800 'ファイルが無いときの画面
23810 if (file$ = "")  then
23820 '背景画面表示
23830 select case device_No
23840 case 1:
23850 gload Gazo$ + "KazutamaList1.png",0
23860 gload Gazo$ + "MiddleScreen_20230401.png",0,0,240
23870 gload Gazo$+"downscreen.png",0,0,800
23880 case 2:
23890 gload Gazo$ + "KazutamaList1.png"
23900 end select
23910 print chr$(13)
23920 '***************************************************************************************
23930 '読み込みに行っていない。   ↓                                                        *
23940 '****************************************************************************************
23950 color rgb(255,255,255):print "登録ファイルはございません" + chr$(13)
23960 '***************************************************************************************
23970 '読み込みに行っていない。 　↑                                                        *
23980 '***************************************************************************************
23990 color rgb(0,0,0):print "パッドの右を押してください" + chr$(13)
24000 bg = 0:key$ = ""
24010 while (key$ <> chr$(13) and bg<>2)
24020 key$ = inkey$
24030 bg = strig(1)
24040 pause 2
24050 wend
24060 'エンターキーもしくはバーチャルパッドの右でトップに行く
24070 if ((bg = 2)  or (key$ = chr$(13))) then goto TopScreen:
24080 else
24090 cls 3:buffer_list_count = Loadcount()
24100 color rgb(255,255,255)
24110 if lang_flag = 1 then
24120 Else
24130 talk "登録件数は" + str$(buffer_list_count) + "件です"
24140 select case device_No
24150 Case 1:
24160 gload Gazo$ + "KazutamaList1_Entry.png",0,0,0
24170 gload Gazo$ + "MiddleScreen_20230401.png",0,0,240
24180 gload Gazo$ + "downscreen.png",0,0,800
24190 case 2:
24200 gload Gazo$+"KazutamaList1_Entry.png",0,0,0
24210 end select
24220 color rgb(0,0,255)
24230 print chr$(13)
24240 color rgb(255,255,255)
24250 print "登録件数:";buffer_list_count;"件";chr$(13)
24260 color rgb(0,0,0)
24270 print "パッドの右を押してください" + chr$(13)
24280 endif
24290 bg = 0:key$ = "":bg2 = 0
24300 while (key$ <> chr$(13) and bg <> 2)
24310 key$ = inkey$
24320 bg = strig(1)
24330 bg2=strig(0)
24340 pause 2
24350 wend
24360 'エンターキーまたはバーチャルパッドの右でリストに飛ぶ
24370 if ((key$ = chr$(13)) or (bg = 2)) then pause 20:goto KotodamaList_page:
24380 endif
24390 if (bg = 2) then pause 20:goto TopScreen:
24400 func Loadcount()
24410 n = 0
24420 'while eof(1)=-1
24430 open SAVE_DATA1$  for input as #1
24440 while eof(1) <> -1
24450 line input #1,line$
24460 n = n + 1
24470 wend
24480 close #1
24490 count = n
24500 endfunc count
24510 count_line = Loadcount()
24520 '*****************************************************************************************************************************************
24530 '自作関数 func Kotodama$(buf$)
24540 'ここから
24550 '*****************************************************************************************************************************************
24560 func Kotodama$(buf$)
24570 color rgb(255,255,255)
24580 b = len("数霊:")
24590 a$ = Mid$(buf$,b+1,len(buf$))
24600 for i=0 to 118
24610 color rgb(255,255,255)
24620 if bufline3$(2 * i) ="数霊:" + a$  then
24630 moji_$ = bufline3$(2*i + 1)
24640 endif
24650 next i
24660 kotodama$ = moji_$
24670 endfunc kotodama$
24680 '*******************************************************************************************************************************************
24690 '自作関数　func Kotodama$(buf$)
24700 'ここまで
24710 '*******************************************************************************************************************************************
24720 KotodamaList_page:
24730 cls 3:font 48:m = 0:
24740 select case device_No
24750 case 1:
24760 gload Gazo$ + "Screen5_Surei_List.png"
24770 gload Gazo$ + "downscreen.png",0,0,800
24780 case 2:
24790 gload Gazo$ + "Screen5_Surei_List.png",0,0,0
24800 end select
24810 '*******************************************************************************************************************************************
24820 '1.ファイルがないとき ここから
24830 '*******************************************************************************************************************************************
24840 if SAVE_DATA1$ = "" then
24850 cls 3:color rgb(255,255,255):print"ファイルがありません"
24860 '*******************************************************************************************************************************************
24870 '1.ファイルがないとき　ここまで
24880 '********************************************************************************************************************************************
24890 else
24900 '*********************************************************************************************************************************************
24910 '2.ファイルが有るとき　ここから
24920 'a = Loadcount():a  ->   登録件数
24930 '*********************************************************************************************************************************************
24940 a = Loadcount()
24950 '*********************************************************************************************************************************************
24960 '2.ファイルが有るとき　ここまで
24970 '*********************************************************************************************************************************************
24980 open SAVE_DATA1$  for input as #1
24990 for i=0 to a-1
25000 for n=0 to 1
25010 input #1,line$
25020 bufKaztama$(i,n) = line$
25030 next n
25040 next i
25050 close #1
25060 l = 0:n=0
25070 select case device_No
25080 case 1:
25090 gload Gazo$ + "Screen5_Surei_List.png"
25100 gload Gazo$ + "downscreen.png",0,0,800
25110 case 2:
25120 gload Gazo$ + "Screen5_Surei_List.png",0,0,0
25130 end select
25140 while (buffer_list_count >= l)
25150 cls
25160 color rgb(255,0,0)
25170 print chr$(13)
25180 color rgb(255,255,255)
25190 n=n+1
25200 print chr$(13)
25210 print "番号:";l+1;chr$(13)
25220 print bufKaztama$(l,0) + chr$(13)
25230 print bufKaztama$(l,1) + chr$(13)
25240 Kmoji$ = moji$
25250 print chr$(13) + chr$(13) + chr$(13)
25260 color rgb(0,0,0)
25270 if buffer_list_count=1 then
25280 print " :パッドの左:トップ画面"+chr$(13)
25290 ui_msg "登録件数は1件です。"
25300 else
25310 if buffer_list_count > 1 then
25320 print " :パッドの左:トップ画面" + chr$(13)
25330 print " :パッドの右:次へ行く" + chr$(13)
25340 endif
25350 endif
25360 key$ = "":bg = 0:bg2 = 0
25370 while (key$ <> chr$(13) and bg <> 2 and bg2 <> 1)
25380 key$ = inkey$
25390 bg = strig(1)
25400 bg2 = strig(0)
25410 pause 2
25420 wend
25430 'if n > 1 then
25440 if (key$ = " " OR bg = 2) then
25450 if n > 1 then
25460 l = ((l+1) Mod buffer_list_count):pause 1.583 * 1000
25470 endif
25480 else
25490 if ((bg2 = 1) or (key$=chr$(13))) then
25500 goto TopScreen:
25510 endif
25520 else
25530 goto KotodamaList_page:
25540 endif
25550 wend
25560 endif
25570 'ndif
25580 '結果表示２ Menu1
25590 Surei_Result4:
25600 cls 3:font 32+16:init"kb:4"
25610 for i=0 to 181 + 4 - 1
25620 if i = count  then
25630 buffer$ = bufline2$(count + 4,1)
25640 endif
25650 next i
25660 if len(buffer$) > 21 and len(buffer$) <= 45 then
25670 buffer2$ = Mid$(buffer$,1,22)
25680 buffer3$ = Mid$(buffer$,23,(len(buffer$) - 22))
25690 buffer$ = buffer2$ + chr$(13) + buffer3$ + chr$(13) + chr$(13)
25700 else
25710 if len(buffer$) <= 21 then
25720 buffer2$ = Mid$(buffer$,1,21)
25730 buffer$ = buffer2$ + chr$(13) + chr$(13) + chr$(13) + chr$(13) + chr$(13) + chr$(13) + chr$(13) + chr$(13)+chr$(13)
25740 else
25750 if len(buffer$) > 45 and len(buffer$) <= 62 then
25760 buffer2$ = Mid$(buffer$,1,22)
25770 buffer3$ = Mid$(buffer$,23,22)
25780 buffer4$ = Mid$(buffer$,44,(len(buffer$)-44))
25790 buffer$ = buffer2$ + chr$(13) + buffer3$ + chr$(13) + buffer4$ + chr$(13) + chr$(13)
25800 else
25810 if len(buffer$) > 64 and len(buffer$) <= 81 then
25820 buffer2$ = Mid$(buffer$,1,22)
25830 buffer3$ = Mid$(buffer$,23,20)
25840 buffer4$ = Mid$(buffer$,44,20)
25850 buffer5$ = Mid$(buffer$,65,(len(buffer$)-65))
25860 buffer$ = buffer2$ + chr$(13) + buffer3$  + chr$(13) + buffer4$  + chr$(13) + buffer5$ + chr$(13)
25870 if len(buffer$) > 81 and len(buffer$) <= 110 then
25880 buffer2$ = Mid$(buffer$,1,22)
25890 buffer3$ = Mid$(buffer$,23,20)
25900 buffer4$ = Mid$(buffer$,43,20)
25910 buffer5$ = Mid$(buffer$,63,20)
25920 buffer6$ = Mid$(buffer$,83,(len(buffer$) - 83))
25930 buffer$ = buffer2$ + chr$(13) + buffer3$ + chr$(13) + buffer4$ + chr$(13) + buffer5$ + chr$(13) + buffer6$ + chr$(13)
25940 endif
25950 endif
25960 endif
25970 endif
25980 endif
25990 Surei_Result4_2:
26000 select case device_No
26010 case 1:
26020 gload Gazo$ + "Screen1_Result2.png"
26030 gload Gazo$ + "downscreen.png",0,0,800
26040 case 2:
26050 gload Gazo$ +"Screen1_Result2.png"
26060 end select
26070 Result_Menu_List$(0)="1.トップ画面に行く"
26080 Result_Menu_List$(1)="2.数霊のデーターを保存"
26090 Result_Menu_List$(2)="3.もう一度、数霊を調べる"
26100 cls
26110 print chr$(13)
26120 if lang_flag = 1 then
26130 else
26140 color rgb(127,255,212)
26150 print chr$(13);chr$(13)
26160 print "入力文字:";buffer_moji$;chr$(13)
26170 print "数霊:";count;chr$(13)
26180 color rgb(255,255,255)
26190 print "数霊の説明:"+chr$(13)
26200 print buffer$
26210 color rgb(0,0,0)
26220 locate 0,15
26230 print "(パッド 右 or 左 ):Menuを開く" + chr$(13)
26240 endif
26250 key$ = "":bg = 0:bg2 = 0
26260 while (bg<>2 and bg2<>1)
26270 key$ = inkey$
26280 bg = strig(1)
26290 bg2 = strig(0)
26300 pause 2
26310 wend
26320 if ((bg = 2) or (bg2 = 1)) then
26330 num = ui_select("Result_Menu_List$","番号を選んでください")
26340 endif
26350 if num = 0 then goto TopScreen:
26360 if num = 1 then goto File_save:
26370 if num = 2 then goto Surei_Input:
26380 if num = -1 then goto Surei_Result4
26390 File_save:
26400 'ファイルがない時
26410 if dir$(SAVE_DATA1$) = " " then
26420 open SAVE_DATA1$ for output as #1
26430 print #1,"入力文字:"+buffer_moji$+",数霊:"+str$(count)
26440 close #1
26450 ui_msg "保存しました":talk"保存しました":goto Surei_Result4_2:
26460 'ファイルが有る時
26470 else
26480 open SAVE_DATA1$ for append as #1
26490 print #1,"入力文字:"+buffer_moji$+",数霊:"+str$(count)
26500 close #1
26510 ui_msg "保存しました":talk"保存しました":goto Surei_Result4_2:
26520 endif
26530 func All_clear()
26540 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0
26550 endfunc
26560 'ここから
26570 Config_moji1:
26580 cls 3:Font 48
26590 select case device_No
26600 case 1:
26610 gload Gazo$ + "Screen1_Setting_Top.png",0,0,0
26620 gload Gazo$ + "downscreen.png",0,0,800
26630 case 2:
26640 gload  Gazo$ + "Screen1_Setting_Top.png",0,0,0
26650 end select
26660 play ""
26670 No=1
26680 sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,200),0,0:
26690 color rgb(0,0,255)
26700 print chr$(13)
26710 if lang_flag = 1 then
26720 'lang_flag = 1:英語
26730 else
26740 'lang_flag = 0:日本語
26750 color rgb(255,255,255)
26760 print "番号を選んでください" + chr$(13)
26770 print " :1.文字の項目" + chr$(13)
26780 print " :2.結果表示設定" + chr$(13)
26790 print " :3.トップ画面に行く" + chr$(13)
26800 print " :4.終 了" + chr$(13)
26810 endif
26820 color rgb(0,0,0)
26830 locate 1,12
26840 if No = 1 then print "1.文字の項目"
26850 'y:バーチャルパッドの処理
26860 'key$:カーソルの処理
26870 'bg:バーチャルパッドの右ボタン
26880 Config_moji1_Screen:
26890 y = 0:key$ = "":bg=0
26900 while (key$ <> chr$(31) and key$ <> chr$(13) and y <> 1 and y <> -1 and bg<>2)
26910 y = stick(1)
26920 key$ = inkey$
26930 bg=strig(1)
26940 pause 2
26950 wend
26960 'バーチャルパッド　ここから'
26970 'バーチャルパッド　ここから'
26980 if y = 1 then
26990 select case No
27000 'No の初期値：No=1
27010 case 1:
27020 sp_on 0,0:sp_on 1,1:sp_on 2,0:sp_on 3,0:sp_put 1,(5,300),0,0:No=2:pause 200:locate 0,12:print "                                       ":locate 1,12:print"2.数霊文字確認を選択":goto Config_moji1_Screen:
27030 'デバッグライン　ここから
27040 '0のとき
27050 'デバッグライン　ここまで
27060 'デバッグライン　ここから
27070 case 2:
27080 sp_on 2,1:sp_on 0,0:sp_on 1,0:sp_on 3,0:sp_put 2,(5,400),0,0:pause 200:locate 0,12:print "                      "
27090 color rgb(0,0,0)::No=3:goto Config_moji1_Screen:
27100 'if lang_flag = 1 then
27110 'else
27120 locate 1,12:print "3.トップ画面に行くを選択"
27130 'endif
27140 'デバッグライン　ここまで
27150 case 3:
27160 sp_on 3,1:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_put 3,(5,500),0,0:pause 200:locate 0,12:print"                                       ":locate 1,12:print "4.終 了を選択":No=0:goto Config_moji1_Screen:
27170 'デバッグライン　ここから
27180 'locate 1,12:print"count=";count;chr$(13):count = count + 1:goto Main_Select:
27190 'デバッグライン　ここまで
27200 case 0:
27210 sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,200),0,0:pause 200:No=1:locate 0,12:print"                                      ":locate 1,12:print "1.登録文字の確認を選択":goto Config_moji1_Screen:
27220 'デバッグライン　ここから
27230 ' locate 1,12:print "b=";b;chr$(13):count=count+1:goto Main_Select:
27240 'デバッグライン　ここまで
27250 end select
27260 endif
27270 'バーチャルパッド　上 ここから
27280 if y = -1 then
27290 select case No
27300 'No:0  4.終了  :1数霊チェック No:1　→　4.終了 No:0
27310 case 1:
27320 sp_on 3,1:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_put 3,(5,500),0,0:pause 200:No=0:locate 0,12:print "                                       ":locate 1,12:print"4.終了を選択"::goto Config_moji1_Screen:
27330 'No:3 3.Help :4.終了:NO:0 → 3.Help No:3
27340 case 0:
27350 sp_on 2,1:sp_on 0,0:sp_on 1,0:sp_on 3,0:sp_put 2,(5,400),0,0:pause 200:No=3:locate 0,12:print"                                       ":locate 1,12:print"3.トップ画面を選択":goto Config_moji1_Screen:
27360 'No:3 3.Help→2.設定 No:2
27370 case 3:
27380 sp_on 1,1:sp_on 0,0:sp_on 3,0:sp_on 2,0:sp_put 1,(5,300),0,0:pause 200:No=2:locate 0,12:print"                                      ":locate 1,12:print"2.数霊文字確認を選択":goto Config_moji1_Screen:
27390 case 2:
27400 sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,200),0,0:pause 200:No=1:locate 0,12:print "                                      ":locate 1,12:print"1.登録文字の確認を選択":goto Config_moji1_Screen:
27410 end select
27420 endif
27430 if bg=2 then
27440 select case No
27450 '1.数霊チェックを選択  パッドの右キー
27460 case 1:
27470 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto Select_moji:
27480 '2.設定を選択    パッドの右キー
27490 case 2:
27500 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto Kakunin_Surei_count:
27510 '3.ヘルプを選択 パッドの右
27520 case 3:
27530 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto TopScreen:
27540 'プログラムの終了を選択
27550 case 0:
27560 cls 3:cls 4:play "":play Voice_File_TopScreen$+"Voice_Finish_Message.mp3":color rgb(255,255,255):pause 2.052*1000
27570 'if lang_flag = 1 then
27580 'Else
27590 ui_msg "プログラムを終了します":end
27600 'endif
27610 end select
27620 endif
27630 '4.終了するを選択  パッドの右
27640 'バーチャルパッド　ここまで'
27650 'SettingScreen:
27660 'key$ = input$(1)
27670 'カーソル下'
27680 if key$ = chr$(31) then
27690 select case (No Mod 4)
27700 '登録文字から数霊文字の確認
27710 case 1:
27720 c=2:No=c:sp_on 0,1:sp_on 1,1:sp_on 2,0:sp_on 3,0:sp_put 0,(5,300),0,0:locate 0,12:print "                                     ":locate 1,12:print "2.数霊文字確認を選択":goto Config_moji1_Screen:
27730 '数霊文字の確認からトップ画面に行く
27740 case 2:
27750 c=3:No=c:sp_on 0,0:sp_on 1,0:sp_on 2,1:sp_on 3,0:sp_put 2,(5,400),0,0:locate 0,12:print "                                     ":locate 1,12:print"3.トップ画面に行くを選択":goto Config_moji1_Screen:
27760 'トップ画面に行くから終了
27770 case 3:
27780 c=0:No=c:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,1:sp_put 3,(5,500),0,0:locate 0,12:print "                                       ":locate 1,12:print "4.終了するを選択":goto Config_moji1_Screen:
27790 '終了から登録文字
27800 case 0:
27810 c=1:No=c:sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,200),0,0:locate 0,12:print "                                      ":locate 1,12:print "1.登録文字の確認を選択":goto Config_moji1_Screen:
27820 end select
27830 endif
27840 'カーソル　上
27850 if key$ = chr$(30) then
27860 select case (No Mod 4)
27870 case 1:
27880 c=2:No=c:sp_on 0,1:sp_put 0,(5,200),0,0:sp_on 3,0:sp_on 1,0:sp_on 2,0:goto Config_moji1_Screen:
27890 case 2:
27900 c=3:No=c:sp_on 1,1:sp_put 1,(5,300),0,0:sp_on 0,0:sp_on 2,0:sp_on 3,0:goto Config_moji1_Screen:
27910 case 3:
27920 c=0:No=c:sp_on 0,0:sp_on 1,0:sp_on 2,1:sp_on 3,0:sp_put 2,(5,400),0,0:goto Config_moji1_Screen:
27930 case 0:
27940 c=1:No=c:sp_on 3,1:sp_on 1,0:sp_on 2,1:sp_put 3,(5,500),0,0:sp_on 0,0:goto Config_moji1_Screen:
27950 end select
27960 endif
27970 'エンターキーを押したとき
27980 if key$ = chr$(13) then
27990 if No=3 then goto TopScreen:
28000 if No=1 then sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Select_moji:
28010 if No=2 then sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Kakunin_Surei_count:
28020 if No=0 then color rgb(255,255,255):play Voice_File_TopScreen$ + "Voice_Finish_Message.mp3":pause 2.052*1000:ui_msg"プログラムを終了します":cls 3:cls 4:end
28030 'lse
28040 'o'o SettingScreen:
28050 endif
28060 'ここまで
28070 Config_moji2:
28080 cls 3:Font 48
28090 select case device_No
28100 case 1:
28110 gload Gazo$ + "Screen1_Setting_Top.png",0,0,0
28120 gload Gazo$ + "downscreen.png",0,0,800
28130 case 2:
28140 gload Gazo$ + "Screen1_Setting_Top.png "
28150 end select
28160 play ""
28170 'play Voice_File_TopScreen$ + "Voice_Setting_Top.mp3"
28180 No=1
28190 sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,200),0,0:
28200 color rgb(0,0,255)
28210 'print "●設定項目" + chr$(13)
28220 print chr$(13)
28230 if lang_flag = 1 then
28240 'lang_flag = 1:英語
28250 else
28260 'lang_flag = 0:日本語
28270 color rgb(255,255,255)
28280 print "番号を選んでください" + chr$(13)
28290 'print " :1.文字の項目" + chr$(13)
28300 'print " :2.結果表示設定" + chr$(13)
28310 print " :1.文字の項目" + chr$(13)
28320 print " :2.結果表示設定" + chr$(13)
28330 print " :3.トップ画面に行く" + chr$(13)
28340 print " :4.終 了" + chr$(13)
28350 endif
28360 color rgb(0,0,0)
28370 locate 1,12
28380 if No = 1 then print "1.文字の項目"
28390 'y:バーチャルパッドの処理
28400 'key$:カーソルの処理
28410 'bg:バーチャルパッドの右ボタン
28420 config_moji2:
28430 y = 0:key$ = "":bg=0
28440 while (key$ <> chr$(31) and key$ <> chr$(13) and y <> 1 and y <> -1 and bg<> 2)
28450 y = stick(1)
28460 key$ = inkey$
28470 bg = strig(1)
28480 pause 200
28490 wend
28500 'バーチャルパッド　ここから'
28510 'バーチャルパッド　ここから'
28520 if y = 1 then
28530 select case No
28540 'No の初期値：No=1
28550 case 1:
28560 sp_on 0,0:sp_on 1,1:sp_on 2,0:sp_on 3,0:sp_put 1,(5,300),0,0:No=1:pause 200:locate 0,12:print "                                       ":locate 1,12:print"2.数霊文字確認を選択":goto SettingScreen:
28570 'デバッグライン　ここから
28580 '0のとき
28590 'デバッグライン　ここまで
28600 'デバッグライン　ここから
28610 case 2:
28620 sp_on 2,1:sp_on 0,0:sp_on 1,0:sp_on 3,0:sp_put 2,(5,400),0,0:pause 200:locate 0,12:print "                      "
28630 color rgb(0,0,0)::No=2:goto SettingScreen:
28640 if lang_flag = 1 then
28650 else
28660 locate 0,12:print " 3.トップ画面に行くを選択"
28670 endif
28680 'cls:color rgb(255,255,255):print"ok"
28690 'デバッグライン　ここまで
28700 case 3:
28710 sp_on 3,1:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_put 3,(5,500),0,0:pause 200:locate 0,12:print"                                       ":locate 1,12:print "4.終 了を選択":No=0:goto SettingScreen:
28720 'デバッグライン　ここから
28730 'locate 1,12:print"count=";count;chr$(13):count = count + 1:goto Main_Select:
28740 'デバッグライン　ここまで
28750 case 0:
28760 sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,200),0,0:pause 200:No=0:locate 0,12:print"                                      ":locate 1,12:print "1.登録文字の確認を選択":goto SettingScreen:
28770 'デバッグライン　ここから
28780 ' locate 1,12:print "b=";b;chr$(13):count=count+1:goto Main_Select:
28790 'デバッグライン　ここまで
28800 end select
28810 endif
28820 'バーチャルパッド　上 ここから
28830 if y = -1 then
28840 select case No
28850 'No:0  4.終了  :1数霊チェック No:1　→　4.終了 No:0
28860 case 1:
28870 sp_on 3,1:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_put 3,(5,500),0,0:pause 200:No=0:locate 0,12:print "                                       ":locate 1,12:print"4.終了を選択"::goto SettingScreen:
28880 'No:3 3.Help :4.終了:NO:0 → 3.Help No:3
28890 case 0:
28900 sp_on 2,1:sp_on 0,0:sp_on 1,0:sp_on 3,0:sp_put 2,(5,400),0,0:pause 200:No=3:locate 0,12:print"                                       ":locate 1,12:print"3.トップ画面を選択":goto SettingScreen:
28910 'No:3 3.Help→2.設定 No:2
28920 case 3:
28930 sp_on 1,1:sp_on 0,0:sp_on 3,0:sp_on 2,0:sp_put 1,(5,300),0,0:pause 200:No=2:locate 0,12:print"                                       ":locate 1,12:print "2.数霊文字確認を選択":goto SettingScreen:
28940 case 2:
28950 sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,200),0,0:pause 200:No=1:locate 0,12:print "                                       ":locate 1,12:print"1.登録文字の確認を選択":goto SettingScreen:
28960 end select
28970 endif
28980 '決定ボタン
28990 if bg=2 then
29000 select case No
29010 '1.数霊チェックを選択  パッドの右キー
29020 case 1:
29030 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto Select_moji:
29040 '2.設定を選択    パッドの右キー
29050 case 2:
29060 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto Kakunin_Surei_count:
29070 '3.ヘルプを選択 パッドの右
29080 case 3:
29090 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto TopScreen:
29100 'プログラムの終了を選択
29110 case 0:
29120 cls 3:cls 4:play "":play Voice_File_TopScreen$+"Voice_Finish_Message.mp3":color rgb(255,255,255):pause 2.052*1000:
29130 'if lang_flag = 1 then
29140 'Else
29150 ui_msg "プログラムを終了します":end
29160 'endif
29170 end select
29180 endif
29190 '4.終了するを選択  パッドの右
29200 'バーチャルパッド　ここまで'
29210 'カーソル下'
29220 if key$ = chr$(31) then
29230 select case (No Mod 4)
29240 '登録文字から数霊文字の確認
29250 case 1:
29260 c=2:No=c:sp_on 0,1:sp_on 1,1:sp_on 2,0:sp_on 3,0:sp_put 0,(5,300),0,0:locate 0,12:print "                                     ":locate 1,12:print "2.数霊文字確認を選択":goto SettingScreen:
29270 '数霊文字の確認からトップ画面に行く
29280 case 2:
29290 c=3:No=c:sp_on 0,0:sp_on 1,0:sp_on 2,1:sp_on 3,0:sp_put 2,(5,400),0,0:locate 0,12:print "                                     ":locate 1,12:print"3.トップ画面に行くを選択":goto SettingScreen:
29300 'トップ画面に行くから終了
29310 case 3:
29320 c=0:No=c:sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,1:sp_put 3,(5,500),0,0:locate 0,12:print "                                       ":locate 1,12:print "4.終了するを選択":goto SettingScreen:
29330 '終了から登録文字
29340 case 0:
29350 c=1:No=c:sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,200),0,0:locate 0,12:print "                                      ":locate 1,12:print "1.登録文字の確認を選択":goto SettingScreen:
29360 end select
29370 endif
29380 'カーソル　上
29390 if key$ = chr$(30) then
29400 select case (No Mod 4)
29410 case 1:
29420 c=2:No=c:sp_on 0,1:sp_put 0,(5,200),0,0:sp_on 3,0:sp_on 1,0:sp_on 2,0:goto SettingScreen:
29430 case 2:
29440 c=3:No=c:sp_on 1,1:sp_put 1,(5,300),0,0:sp_on 0,0:sp_on 2,0:sp_on 3,0:goto SettingScreen:
29450 case 3:
29460 c=0:No=c:sp_on 0,0:sp_on 1,0:sp_on 2,1:sp_on 3,0:sp_put 2,(5,400),0,0:goto SettingScreen:
29470 case 0:
29480 c=1:No=c:sp_on 3,1:sp_on 1,0:sp_on 2,1:sp_put 3,(5,500),0,0:sp_on 0,0:goto SettingScreen:
29490 end select
29500 endif
29510 'エンターキーを押したとき
29520 if key$ = chr$(13) then
29530 if No=3 then sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto TopScreen:
29540 if No=1 then sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Select_moji:
29550 if No=2 then sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:goto Kakunin_Surei_count:
29560 if No=0 then color rgb(255,255,255):play Voice_File_TopScreen$ + "Voice_Finish_Message.mp3":pause 2.052 * 1000:ui_msg"プログラムを終了します":cls 3:cls 4::end
29570 'lse
29580 'o'o SettingScreen:
29590 endif
29600 '結果表示設定
29610 Result_Setting:
29620 color rgb(255,255,255)
29630 'dim list$(4)
29640 'ファイル読み込み
29650 '1.ファイルが有るか無いかのチェック
29660 if Dir$(System$) = "" then
29670 '1-1.ファイルがないとき
29680 '上のSystemフォルダを作成
29690 mkdir "./data/system/"
29700 list$(0) = "●:出た数字から181を引く"
29710 list$(1) = " :出た数字から180を引き単数変換"
29720 open System$ for output as #1
29730 print #1,"config_r=0"
29740 close #1
29750 ui_msg "ファイルを作成しました"
29760 'ファイル作成
29770 else
29780 '1-2.ファイルが有るとき
29790 'config_r:0 出た数字から181を引く
29800 'config_r:1 出た数字から180を引いて単数変換
29810 'open "./System/config.sys" for input as #1
29820 'ファイルが有るときファイルを読み込み
29830 open System$ for input as #1
29840 line input #1,buf_line$
29850 'buf$にデーターをコピーする
29860 buf$ = buf_line$
29870 close #1
29880 if len(buf$) = 10 then
29890 if left$(buf$,9) = "config_r=" then
29900 buf$ = right$(buf_line$,1)
29910 if buf$ = "1" then
29920 '1.System$ ファイルを削除(config.sys)
29930 '2.1行目をconfig_r=1と書き、保存する
29940 buf_config_r = 1
29950 'list$(0) = "●:1.出た数字から180を引いて単数変換"
29960 'list$(1) = " :2.出た数字から181を引く"
29970 else
29980 if buf$ = "0" then
29990 buf_config_r = 0
30000 ' list$(0) = "●:1.出た数字から181を引く"
30010 'list$(1) = " :2.出た数字から180を引いて単数変換"
30020 endif
30030 endif
30040 endif
30050 endif
30060 endif
30070 '"●:1.出た数字から180を引く"をlist$(0)に代入
30080 if buf_config_r =  0 then
30090 list$(0) = "●:1.出た数字から181を引く"
30100 list$(1) = " :2.出た数字から180を引いて単数変換"
30110 else
30120 list$(0) = "●:1.出た数字から180を引いて単数変換"
30130 list$(1) = " :2.出た数字から181を引く"
30140 endif
30150 list$(2) = " :トップ画面に戻る"
30160 list_num = ui_select("list$","番号を選んでください")
30170 play ""
30180 Select case (list_num)
30190 case 0:
30200 if buf$ = "1" then
30210 buf_config_r = 0:
30220 'データーを変更したのでファイルを削除
30230 kill System$
30240 'ファイルを新しく作成
30250 open System$ for output as #1
30260 print #1,"config_r=0"
30270 close #1
30280 ui_msg "設定を変更しました。"
30290 else
30300 'if buf$ = "0" then
30310 'buf_config_r = 1
30320 'kill System$
30330 'open Syetem$ for output as #1
30340 'print #1,"config_r=1"
30350 'close #1
30360 'ui_msg "設定を変更しました"
30370 'endif
30380 endif
30390 goto config_moji2:
30400 case 1:
30410 if buf$ = "0" then
30420 buf_config_r = 1:
30430 'データーを変更したので、ファイルを削除
30440 kill System$
30450 'ファイルを新しく作成
30460 open System$ for output as #1
30470 print #1,"config_r=1"
30480 close #1
30490 ui_msg "設定を変更しました"
30500 else
30510 kill System$
30520 if buf$ = "1" then
30530 open System$ for output as #1
30540 print #1,"config_r=0"
30550 close #1
30560 ui_msg "設定を変更しました"
30570 endif
30580 endif
30590 goto config_moji2:
30600 case 2:
30610 'トップ画面に飛ぶ
30620 goto TopScreen:
30630 case 3:
30640 'プログラムを終了する
30650 cls 3:color rgb(255,255,255):ui_msg "プログラムを終了します":play "":play Voice_File_TopScreen$ + "Voice_Finish_Message.mp3":end
30660 end select
30670 '単数変換
30680 Func Single_Complate(num)
30690 '1.出てきた数字から180を引く
30700 a = num - 180
30710 'a:10〜99
30720 Re1:
30730 if (a > 9 and a < 100) then
30740 b1 = fix(a / 10)
30750 b2 = 10 * a - b1
30760 d1 = b1 + b2
30770 if c > 9 then
30780 goto Re1:
30790 else
30800 c = d1:goto Re2:
30810 endif
30820 endif
30830 Re2:
30840 buffer = c
30850 endfunc buffer
30860 Func Surei_Result_Save_File()
30870 'ファイルがないとき
30880 if dir$(SAVE_DATA1$) = "" then
30890 open SAVE_DATA1$ for output as #1
30900 print #1,"入力文字:"+buffer_moji$+",数霊:"+str$(count)
30910 close #1
30920 ui_msg "保存しました":talk "保存しました":goto Surei_Result:
30930 else
30940 open SAVE_DATA1$ for append as #1
30950 print #1,"入力文字:" + buffer_moji$ + ",数霊:" + str$(count)
30960 close #1
30970 ui_msg "保存しました":talk "保存しました":goto Surei_Result
30980 endif
30990 endfunc
31000 '言語設定
31010 Setting_Language:
31020 cls 3:screen 1,1,1,1:No=2
31030 select case device_No
31040 case 1:
31050 gload Gazo$ + "Screen1.png",0,0,0
31060 gload Gazo$ + "downscreen.png",0,0,800
31070 case 2:
31080 gload Gazo$ + "Screen1.png",0,0,0
31090 end select
31100 init "Kb:4"
31110 sp_on 1,1:sp_on 0,0
31120 sp_put 0,(0,300),0,0
31130 sp_put 1,(0,400),1,0
31140 color rgb(0,0,255)
31150 'print "番号を選んでください"+chr$(13)
31160 'if lang_flag=0 then
31170 'print "言語設定:日本語"+chr$(13)
31180 'else
31190 'print "言語設定:英 語"+chr$(13)
31200 Change_Language:
31210 if lang_flag = 1 then
31220 cls
31230 '***************************************************************************************************************************************
31240 'English
31250 '***************************************************************************************************************************************
31260 print "It has changed Language"+chr$(13)
31270 color rgb(255,255,255)
31280 print "Select the Number"+chr$(13)
31290 print " :1.English → Japanse"+chr$(13)
31300 print " :2.It goes to TopScreen"+chr$(13)
31310 print "Language:In English" +chr$(13)
31320 '******************************************************************************************************************************************
31330 'English
31340 '********************************************************************************************************************************************
31350 else
31360 '********************************************************************************************************************************************
31370 'Japanese
31380 '*********************************************************************************************************************************************
31390 cls:color rgb(255,255,255)
31400 print "設定変更(言語の変更)" + chr$(13)
31410 color rgb(255,255,255)
31420 print chr$(13)
31430 print "番号を選んでください"+chr$(13)
31440 print " :1.日本語 → 英語に変更" + chr$(13)
31450 print " :2.トップ画面に戻る" + chr$(13)
31460 print chr$(13)
31470 print "設定言語:日本語" + chr$(13)
31480 endif
31490 color rgb(0,0,0)
31500 locate 0,15:print "                                       ":locate 0,15:print " 2.トップ画面に戻る　を選択" + chr$(13)
31510 '*********************************************************************************************************************************************
31520 'Japanese
31530 '**********************************************************************************************************************************************
31540 Setting_Language_key:
31550 '************************************************************************************************************************************************
31560 '初期値 y=0:key$="":bg=0
31570 '*************************************************************************************************************************************************
31580 y = 0:key$ = "":bg = 0
31590 '**************************************************************************************************************************************************
31600 while (key$ <> chr$(31) and key$ <> chr$(13) and y <> 1 and y<> -1 and bg<> 2)
31610 y = stick(1)
31620 key$ = inkey$
31630 bg = strig(1)
31640 pause 200
31650 wend
31660 '**************************************************************************************************************************************************
31670 '選択肢変更
31680 'ジョイパッド　上　アンド　下　ここから
31690 '****************************************************************************************************************************************************
31700 if ((y = 1) or (y = -1)) then
31710 select case No
31720 case 2:
31730 '実装部分　ここから
31740 beep:pause 200:No=1:sp_on 0,1:sp_on 1,0:locate 0,15:print "                                                         ":locate 0,15:print " 1.日本語 → 英語に変更を選択": goto Setting_Language_key:
31750 '実装部分　ここまで
31760 case 1:
31770 beep:pause 200:No=2:sp_on 0,0:sp_on 1,1:locate 0,15:print "                                                       ":locate 0,15:print " 2.トップ画面に戻る を選択":goto Setting_Language_key:
31780 end select
31790 endif
31800 '****************************************************************************************************************************************************
31810 'ジョイパッド　上アンド　下　ここまで
31820 '****************************************************************************************************************************************************
31830 'Enter Key  決定ボタン
31840 '***************************************************************************************************************************************************
31850 if ((key$=chr$(13)) or (bg=2)) then
31860 select case No
31870 case 2:
31880 sp_on 0,0:sp_on 1,0:goto TopScreen:
31890 case 1:                                                     'lang_flag=1:sp_on 0,0:sp_on 1,0:goto Change_Language:
31900 '
31910 '未実装　ここから
31920 sp_on 0,1:sp_on 1,0:ui_msg "この機能は未実装です":goto Setting_Language_key:
31930 '
31940 '未実装　ここまで
31950 end select
31960 endif
31970 '****************************************************************************************************************************************************
31980 'Enter key 決定　ここまで
31990 '*****************************************************************************************************************************************************
32000 '配列削除 ここから
32010 '*****************************************************************************************************************************************************
32020 buffer_clear:
32030 erase bufline$
32040 erase bufcount$
32050 erase bufcount1$
32060 erase bufcount2$
32070 erase bufline2$
32080 erase bufline3$
32090 erase bufKaztama$
32100 erase List$
32110 erase Result_Menu_List$
32120 erase list$
32130 erase moji_List$
32140 ui_msg "メモリーをクリアしました"
32150 return
32160 '****************************************************************************************************************************************************
32170 '配列削除　ここまで
32180 '*****************************************************************************************************************************************************
32190 File_Device_Set:
32200 'Device 選択　書き込み
32210 open Device_type$  for output as #1
32220 print #1,device_No
32230 close #1
32240 ui_msg "ファイルを書き込みました"
32250 return
32260 Input_numbertokazutama:
32270 cls 3:init "kb:2"
32280 select case (device_No)
32290 case  1:
32300 gload Gazo$ + "Input_numbertokazutama.png",0,0,0
32310 gload Gazo$ + "Input_numbertokazutama2.png",0,0,380
32320 case 2:
32330 gload Gazo$ + "Input_numbertokazutama.png",0,0,0
32340 end select
32350 color rgb(255,255,255):locate 1,4:print "調べたい数霊の番号を入れてください"+chr$(13);"(Max:181)"
32360 color rgb(0,0,0):locate 1,7:Input "番号:",num
32370 if (num > 181) then ui_msg"181までの数字で入れ直してください":goto Input_numbertokazutama:
32380 pause 200
32390 for i=0 to 181+3-1
32400 if i = num then
32410 buffer$ = bufline2$(i+4,1)
32420 talk buffer$
32430 goto Numbertokazutama:
32440 endif
32450 next i
32460 'goto Numbertokazutama:
32470 '
32480 '
32490 Numbertokazutama:
32500 cls 3:init "kb:4":bg=0:key$=""
32510 select case (device_No)
32520 case 1:
32530 gload Gazo$ + "Result_numbertokazutama.png",0,0,0
32540 gload Gazo$ + "downscreen.png",0,0,800
32550 case 2:
32560 gload Gazo$ + "Result_numbertokazutama.png",0,0,0
32570 end select
32580 font 32+16:color rgb(255,255,255)
32590 locate 1,3:print "◎数霊番号:";num;chr$(13)
32600 locate 1,4:print "◎数霊の説明"+chr$(13)
32610 if ((len(buffer$) > 21) and (len(buffer$) <= 45)) then
32620 buffer2$ = Mid$(buffer$,1,20)
32630 buffer3$ = Mid$(buffer$,21,len(buffer$)-20)
32640 buffer$ = buffer2$ + chr$(13) + buffer3$ + chr$(13)
32650 else
32660 if (len(buffer$) < 22) then
32670 buffer2$ = Mid$(buffer$,1,21)
32680 buffer$ = buffer2$ + chr$(13)
32690 else
32700 if ((Len(buffer$) > 45) and (len(buffer$) < 66)) then
32710 buffer2$ = Mid$(buffer$,1,20)
32720 buffer3$ = Mid$(buffer$,20,21)
32730 buffer4$ = Mid$(buffer$,41,len(buffer$)-41)
32740 buffer$ = buffer2$ + chr$(13) + buffer3$ + chr$(13) + buffer4$ + chr$(13)
32750 endif
32760 endif
32770 endif
32780 locate 1,5:print buffer$
32790 color rgb(0,0,0)
32800 locate 1,14:print "ジョイパッドの右を押してください"+chr$(13)
32810 while ((bg <> 2) and (key$ <> chr$(13)))
32820 bg=strig(1)
32830 key$=inkey$
32840 pause 200
32850 wend
32860 if ((bg = 2) or (key$ = chr$(13))) then
32870 goto TopScreen:
32880 endif
32890 data_initialize:
32900 cls 3
32910 select case device_No
32920 case 1:
32930 gload Gazo$ + "Data_initializeScreen.png",0,0,0
32940 gload Gazo$ + "downscreen.png",0,0,800
32950 case 2:
32960 gload Gazo$ + "Data_initializeScreen.png",0,0,0
32970 end select
32980 color rgb(255,255,255):font 48:init "kb:4":No=1:sp_on 1,1:sp_put 1,(5,300),0,0
32990 locate 0,4:print "番号を選んでください"+chr$(13)
33000 print " :1.メンバーリストの初期化" + chr$(13)
33010 print " :2.デバイスの初期化" + chr$(13)
33020 print " :3.トップ画面に行く"+chr$(13)
33030 locate 0,15:color rgb(0,0,0):print " 1.メンバーリストの初期化を選択"
33040 data_initialize2:
33050 y = 0:key$ = "":bg = 0
33060 while (key$ <> chr$(31) and key$ <> chr$(13) and y <> 1 and y <> -1 and bg <> 2)
33070 y = stick(1)
33080 key$ = inkey$
33090 bg = strig(1)
33100 pause 200
33110 wend
33120 'y = -1:ジョイパッドの上
33130 'y = 1:ジョイパッド下
33140 'key$ = chr$(13):Enter key
33150 'key$ = chr$(30):カーソル上
33160 'key$ = chr$(31):カーソル下
33170 if ((y = -1) or (key$ = chr$(30))) then
33180 select case No
33190 case 1:
33200 sp_on 1,0:sp_on 2,0:sp_on 0,1:sp_on 3,0:No=0:sp_put 0,(5,500),0,0:locate 0,15:print "                                       ":locate 0,15:print " 3.トップ画面に行くを選択":pause 200:goto data_initialize2:
33210 case 2:
33220 sp_on 1,1:sp_on 2,0:sp_on 0,0:sp_on 3,0:No=1:sp_put 1,(5,300),0,0:locate 0,15:print "                                      ":pause 200:locate 0,15:print " 1.メンバーリストの初期化を選択":goto data_initialize2:
33230 case 0:
33240 sp_on 1,0:sp_on 2,1:sp_on 3,0:sp_on 0,0:sp_put 2,(5,400),0,0:locate 0,15:print "                                      ":pause 200:locate 0,15:print " 2.デバイスの初期化を選択":No=2:goto data_initialize2:
33250 end select
33260 endif
33270 'bg=2:Enter key
33280 if ((bg = 2) or (key$ = chr$(13))) then
33290 select case No
33300 case 0:
33310 sp_on 0,0:sp_on 1,0:sp_on 2,0:pause 200:goto TopScreen:
33320 case 1:
33330 'メンバーリストの初期化トップへ行く
33340 sp_on 0,0:sp_on 1,0:sp_on 2,0:pause 200:goto member_initializeTop:
33350 case 2:
33360 ui_msg "未実装です":goto data_initialize2:
33370 end select
33380 endif
33390 'カーソルの下　または、ジョイパッド下
33400 if ((y = 1) or (key$ = chr$(31))) then
33410 select case No
33420 case 1:
33430 sp_on 0,0:sp_on 1,0:sp_on 2,1:sp_put 2,(5,400),0,0:pause 200:No=2:locate 0,15:print "                                                          ":locate 0,15:print " 2.デバイスの初期化を選択":goto data_initialize2:
33440 case 2:
33450 sp_on 0,1:sp_on 1,0:sp_on 2,0:No=0:sp_put 0,(5,500),0,0:pause 200:No=0:locate 0,15:print "                                                          ":locate 0,15:print " 3.トップ画面に行くを選択":goto data_initialize2:
33460 case 0:
33470 sp_on 0,0:sp_on 1,1:sp_on 2,0:No=1:sp_put 1,(5,300),0,0:pause 200:locate 0,15:print "                                                          ":locate 0,15:print " 1.メンバーリストの初期化を選択":goto data_initialize2:
33480 end select
33490 endif
33500 'メンバーリストの初期化トップ
33510 member_initializeTop:
33520 cls 3
33530 select case (device_No)
33540 case 1:
33550 gload Gazo$ + "member_initializeTop.png",0,0,0
33560 gload Gazo$ + "downscreen.png",0,0,800
33570 case 2:
33580 gload Gazo$ + "member_initializeTop.png",0,0,0
33590 end select
33600 No=0:init "kb:4":color rgb(255,255,255):font 48
33610 sp_on 0,1:sp_on 1,0:sp_on 2,0:sp_on 3,0:sp_put 0,(5,500),0,0
33620 locate 0,4:print  "番号を選んでください"+chr$(13)
33630 print " :1.メンバーリストを初期化する" + chr$(13)
33640 print " :2.バックアップを取る" + chr$(13)
33650 print " :3.トップ画面に戻る"+chr$(13)
33660 color rgb(0,0,0):locate 0,15:print "                                       ":locate 0,15:print " 3.トップ画面に戻るを選択"
33670 member_list2:
33680 y=0:key$="":bg=0
33690 while ((key$ <> chr$(13)) and (y <> 1) and (y <> -1) and (bg <> 2))
33700 y = stick(1)
33710 key$ = inkey$
33720 bg = strig(1)
33730 pause 200
33740 wend
33750 'bg=2,chr$(13):決定ボタン
33760 if ((bg = 2) or (key$ = chr$(13)))  then
33770 select case No
33780 case 1:
33790 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto Member_List_DeleteScreen:
33800 case 2:
33810 ui_msg"未実装です":goto member_list2:
33820 case 0:
33830 '3:トップ画面に戻る
33840 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0:pause 200:goto TopScreen:
33850 end select
33860 endif
33870 'y=1:chr$(31):ジョイパッド　下　又は　カーソルの下
33880 if ((y = 1) or (key$ = chr$(31))) then
33890 select case No
33900 case 0:
33910 sp_on 1,1:sp_on 2,0:sp_on 0,0:No=1:sp_put 1,(5,300),0,0:pause 200:locate 0,15:print "                                      ":locate 0,15:print " 1.メンバーリストを初期化するを選択":goto member_list2:
33920 case 1:
33930 sp_on 0,0:sp_on 2,1:sp_on 1,0:No=2:sp_put 2,(5,400),0,0:pause 200:locate 0,15:print "                                      ":locate 0,15:print " 2.バックアップを取るを選択":goto member_list2:
33940 case 2:
33950 sp_on 0,1:sp_on 1,0:sp_on 2,0:No=0:sp_put 0,(5,500),0,0:pause 200:locate 0,15:print "                                       ":locate 0,15:print " 3.トップ画面に行くを選択":goto member_list2:
33960 end select
33970 endif
33980 'Joypad  or カーソル　上
33990 if ((y=-1) or (key$=chr$(30))) then
34000 select case No
34010 case 0:
34020 sp_on 2,1:sp_on 1,0:sp_on 0,0:No=2:sp_put 2,(5,400),0,0:pause 200:locate 0,15:print "                                      ":locate 0,15:print " 2.バックアップを取るを選択":goto member_list2:
34030 case 1:
34040 sp_on 0,1:sp_on 1,0:sp_on 2,0:No=0:sp_put 0,(5,500),0,0:pause 200:locate 0,15:print "                                      ":locate 0,15:print " 3.トップ画面に行くを選択":goto member_list2:
34050 case 2:
34060 sp_on 0,0:sp_on 1,1:sp_on 2,0:No=1:sp_put 1,(5,300),0,0:pause 200:locate 0,15:print "                                      ":locate 0,15:print " 1.メンバーリストを初期化をする選択":goto member_list2:
34070 end select
34080 endif
34090 Member_List_DeleteScreen:
34100 cls:key$ = "":bg = 0:y=0:init "kb:4":font 48:count=0
34110 sp_on 0,0:sp_on 1,0:sp_on 2,0:sp_on 3,0
34120 if dir$(SAVE_DATA1$) = "" then
34130 'ファイルがないとき
34140 color rgb(255,255,255)
34150 locate 0,4
34160 print "データーファイルは、存在しません。"
34170 locate 0,15:color rgb(0,0,0):print "ジョイパッドの右を押してください":
34180 'endif
34190 while ((key$ <> chr$(13)) and (bg <> 2) and (y <> 1) and (y <> -1))
34200 key$ = inkey$
34210 bg = strig(1)
34220 y = stick(1)
34230 pause 2
34240 wend
34250 if ((key$ = chr$(13)) or (bg = 2)) then goto TopScreen:
34260 'goto TopScreen:
34270 'endif
34280 else
34290 'ファイルが有るとき
34300 'default
34310 'No=1:ファイルを削除する
34320 'No=2:トップ画面に戻る
34330 No=2
34340 sp_on 1,0:sp_on 2,1:sp_put 2,(5,400),0,0
34350 color rgb(255,255,255)
34360 locate 0,4:print"番号を選んでください"+chr$(13)
34370 print " :1.ファイルを削除する"+chr$(13)
34380 print " :2.トップ画面に戻る"+chr$(13)
34390 color rgb(0,0,0):
34400 locate 0,15:print"                                      ":locate 0,15:print " 2.トップ画面に戻るを選択"
34410 endif
34420 Select_key1:
34430 '初期化
34440 y=0:key$="":bg=0
34450 while ((key$ <> chr$(13)) and (bg <> 2) and (y <> 1) and (y <> -1))
34460 key$ = inkey$
34470 bg = strig(1)
34480 y = stick(1)
34490 pause 2
34500 wend
34510 '1.選択キー
34520 '十字キー 上 y=-1
34530 '十字キー　下 y=1
34540 if ((y = 1) or (y = -1)) then
34550 select case No
34560 case 2:
34570 No=1:sp_on 2,0:sp_on 1,1:sp_put 1,(5,300),0,0:locate 0,15:print "                                                                                ":locate 0,15:print " 1．ファイルを削除":pause 200:goto Select_key1:
34580 case 1:
34590 No=2:sp_on 1,0:sp_on 2,1:sp_put 2,(5,400),0,0:locate 0,15:print "                                                          ":locate 0,15:print " 2.トップ画面に戻るを選択":pause 200:goto Select_key1:
34600 end select
34610 endif
34620 '2.決定ボタン
34630 'Joypad　右 or Enter key
34640 if ((bg = 2) or (key$ = chr$(13))) then
34650 Select case No
34660 case 2:
34670 sp_on 1,0:sp_on 2,0:pause 200:goto TopScreen:
34680 case 1:
34690 if (count = 0) then
34700 kill SAVE_DATA1$:ui_msg"メンバーリストを削除しました":pause 200:locate 0,15:print "                                       ":
34710 locate 0,15:print "ジョイパッドの右を押してください":count = count + 1:goto Select_key1:
34720 else
34730 sp_on 1,0:sp_on 2,0:goto TopScreen:
34740 endif
34750 end select
34760 endif
34770 '***********************************************************************
34780 '数霊 データー保存部分　追加　ここから　Date:2025.01.27
34790 '****************************************************
34800 'ラベル：数霊の保存データーラベル
34810 '****************************************************
34820 Save_Kazutama_data:
34830 '****************************************************
34840 'Save_Kazutama_data: (Label1) -> ファイルを保 存 ー＞ Toastでmessageを表示,---> (Label2)After_Save_Kazutama_data2:
34850 '作成日 Date:2025.01.26
34860 '数霊データー保存処理
34870 '保存ファイル:my_Kazutama.date
34880 '全体的な処理
34890 '0.ファイル変数
34900 '1.フォルダの作成確認処理
34910 '2.フォルダの作成処理
34920 '3.ファイルの有無の確認
34930 '4.ファイルの書き込み
34940 '*********************************************************************************
34950 '変数パート　ここから
34960 '*********************************************************************************
34970 '0.ファイル変数
34980 '*********************************************************************************
34990 '0-1.フォルダ:my_Kazutama_Folder$
35000 my_Kazutama_Folder$ = "data/my_Kazutama/"
35010 '*********************************************************************************
35020 '0-2.ファイル：my_Kazutama_data_File$
35030 my_Kazutama_data_File$ = my_Kazutama_Folder$ + "my_Kazutama.dat"
35040 '*********************************************************************************
35050 'フォルダを作る変数
35060 Folder$ = (my_Kazutama_Folder$)
35070 '*********************************************************************************
35080 '書き込むデーター
35090 'buffer_moji$:数霊の入力文字
35100 'buf_count:入力文字の数霊
35110 '変数パート　ここまで
35120 '*********************************************************************************
35130 '*********************************************************************************
35140 '1.フォルダの有無の確認
35150 ' "data/my_Kazutama/"　の有無の確認。
35160 '*********************************************************************************
35170 '◎.コードパート
35180 '*********************************************************************************
35190 '処理1 フォルダがない時フォルダ作成
35200 if dir$(Folder$) = ""  then
35210 mkdir my_Kazutama_Folder$
35220 endif
35230 '*********************************************************************************
35240 'ファイルがない時ファイルを作成する処理
35250 '処理2 ファイル作成
35260 '*********************************************************************************
35270 if (dir$(my_Kazutama_data_File$) = "") then
35280 'ファイルがない時ファイルを作成して初回(1回目)の書き込み
35290 'mkdir (myKazutamadata_File$)
35300 '初回目の書き込み処理
35310 open my_Kazutama_data_File$ for output as #1
35320 '************************************************************************
35330 '数霊の文字入力 ,入力文字の数霊　 ここから
35340 'buffer_moji$ ,val(buf_count)
35350 '***********************************************************************
35360 print #1,"数霊名" + "," + "数霊数"
35370 print #1, buffer_moji$ + "," + str$(count)
35380 '***********************************************************************
35390 '数霊の文字入力 ,入力文字の数霊 　ここまで
35400 'buffer_moji$ ,val(buf_count)
35410 '***********************************************************************
35420 close #1
35430 '***********************************************************************
35440 '保存完了と表示する
35450 ui_msg "保存しました"
35460 pause 1000 * 1.0
35470 'play Voice_File_TopScreen$ + "Voice_Save_Data_20250207.mp3"
35480 '***********************************************************************
35490 'Sound play
35500 else
35510 '***********************************************************************
35520 play Voice_File_TopScreen$ + "Voice_Save_Data_20250207.mp3"
35530 '2回目以降の書き込み
35540 '***********************************************************************
35550 'それ以外は、ファイルをオープンして、数霊と文字を書き込む
35560 '取得するデーター
35570 'buffer_moji$: 数霊の入力文字
35580 'count: 入力文字の数霊
35590 '***********************************************************************
35600 'ファイルを開く 末尾にデーターを追加していく
35610 open my_Kazutama_data_File$ for append as #1
35620 '***********************************************************************
35630 'データーの末尾にデーターを追加:
35640 '数霊の文字入力 ,入力文字の数霊　 ここから
35650 'buffer_moji$ ,str$(count)
35660 '***********************************************************************
35670 print #1,buffer_moji$ + "," + str$(count)
35680 '***********************************************************************
35690 '数霊の文字入力 ,入力文字の数霊　 ここまで
35700 'buffer_moji$ ,str$(buf_count)
35710 '***********************************************************************
35720 'ファイルを閉じる
35730 close #1
35740 '***********************************************************************
35750 '保存完了と表示する
35760 ui_msg "保存しました"
35770 play Voice_File_TopScreen$ + "Voice_Save_Data_20250207.mp3"
35780 pause 3.0 * 1000
35790 '***********************************************************************
35800 endif
35810 Button_count = 1
35820 return
35830 '数霊 データー保存部分　追加　ここまで　Date:2025.01.27
35840 '***********************************************************************
35850 After_Save_Kazutama_data2:
35860 if (Button_count = 0) then
35870 Button_count = 1
35880 endif
35890 '***********************************************************************
35900 '自作関数　Alphabet Check
35910 'Date:2025.02.16
35920 '文字にアルファベットが入ってるかを調べる関数
35930 '************************************************************************
35940 '文字入力の確認　ユーザー関数
35950 '文字の入力チェック　文字にAlphabetの小文字が入ってるか調べる関数
35960 '作成日 :Date:2025.02.15
35970 '使用例1
35980 '1."カメラ" → Alphabet (A〜Z)がないので 戻り値:0
35990 '2."Back み" → Alphabet (A〜Z）があるので　戻り値:1
36000 '入力した文字に対してAlphabetが混じってるか調べる処理
36010 'func Alphabet_Check(buf$)
36020 '
36030 'end func
36040 '****************************************************
36050 '2.自作関数
36060 '2-1.Alphabet Check(buf$)
36070 '*****************************************************
36080 func Alphabet_Check(buf$)
36090 '*****************************************************
36100 '自作関数作成日                                      *
36110 'Date:2025.02.16                                     *
36120 'buf$:調べたい文字                                   *
36130 'buf$にAlphabetの小文字が混じってるかを調べる関数　  *
36140 '文字にAlphabetが小文字混じっていれば、1 を返す。    *
36150 '文字にAlphabetの小文字がなければ0を返す。      　　 *
36160 '*****************************************************
36170 Dim buf_Alphabet_small$(26):moji_count = 0:Moji_length = 0:c = 0
36180 'アルファベットのチャート
36190 buf_Alphabet_small$ = {"a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"}
36200 'buf_Alphabet_large$={"A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"}
36210 '1.入力した文字数を調べる
36220 '例Apple ==> 5文字なので5を返す。
36230 Moji_length = Len(buf$)
36240 '入力した文字1文字に対してAlphabetが混じってるか調べる
36250 for i=0 to 25
36260 '入力した文字がアルファベット(buf_alphabet$(i)チャート)と一致したら、
36270 'Alphabet_moji_countに1を足す。
36280 for j=0 to Moji_length - 1
36290 if (buf_Alphabet_small$(i) = Mid$(buf$,1,j)) then
36300 c = 1
36310 endif
36320 next j
36330 next i
36340 Alphabet_count = c
36350 '*******************************************************
36360 'erase Moji_count$
36370 endfunc Alphabet_count
36380 '*****************************************************
36390 func check_hiragana(buf$)
36400 '*****************************************************
36410 '自作関数作成日                                      *
36420 'Date:2025.02.25                                     *
36430 'buf$:調べたい文字                                   *
36440 'buf$にAlphabetのひらがなが混じってるかを調べる関数　*
36450 '文字にAlphabetがひらがな混じっていれば、1 を返す。  *
36460 '文字にAlphabetのひらがながなければ0を返す。      　 *
36470 '*****************************************************
36480 '1.変数定義
36490 Dim Hiragana$(74):moji$ = "":Moji_count = 0:moji_flag = 0
36500 'ひらがなのチャート
36510 Hiragana$ = {
36520 '1.あ〜ん :46文字
36530 "あ","い","う","え","お",
36540 "か","き","く","け","こ",
36550 "さ","し","す","せ","そ",
36560 "た","ち","つ","て","と",
36570 "な","に","ぬ","ね","の",
36580 "は","ひ","ふ","へ","ほ",
36590 "ま","み","む","め","も",
36600 "や","ゆ","よ",
36610 "ら","り","る","れ","ろ",
36620 "わ","を","ん",
36630 '1.あ〜ん :46文字
36640 '2.その他　濁音など25 文字+3文字
36650 "が","ぎ","ぐ","げ","ご",
36660 "ざ","じ","ず","ぜ","ぞ",
36670 "だ","ぢ","づ","で","ど",
36680 "ば","び","ぶ","べ","ぼ",
36690 "ぱ","ぴ","ぷ","ぺ","ぽ",
36700 "ゃ","ゅ","ょ"}
36710 '2.その他　濁音など
36720 'Total:46 + 25 + 3 = 74文字
36730 '
36740 '1.入力した文字数を調べる。
36750 '例Apple ==> 5文字なので5を返す。
36760 Moji_count = Len(buf$)
36770 '◎.2. buf$の文字を取り出して配列に代入 ここか
36780 dim buffer_moji$(Moji_count)
36790 for i = 1 to Moji_count
36800 moji$ = Mid$(buf$,i,1)
36810 buffer_moji$(i - 1) = moji$
36820 next i
36830 '◎.2. buf$の文字を取り出して配列に代入　ここまで’
36840 '◎.3.. buf$に平仮名が混じってるか調べる　ここから
36850 for i=0 to Moji_count - 1
36860 for n = 0 to 70
36870 if (buffer_moji$(i) = Hiragana$(n)) then
36880 moji_flag = moji_flag + 1
36890 endif
36900 next n
36910 next i
36920 '◎.3. buf$に平仮名が混じってるか調べる　ここまで
36930 '◎.4. 戻り値を求める
36940 '平仮名が1以上なら戻り値  1
36950 '平仮名がなければ戻り値　 0
36960 if (moji_flag > 0) then
36970 moji_flag = 1
36980 else
36990 moji_flag = 0
37000 end if
37010 'moji_flagを戻り値に代入する。
37020 moji_hiragana_flag = moji_flag
37030 endfunc moji_hiragana_flagF
37040 '*****************************************************
37050 Func check_Kazutama_moji(buf$)
37060 '1.文字チャート　（カタカナ + Alphabetの大文字)
37070 Dim Kazutama_Moji$(118)
37080 Kazutama_Moji$={"ア","オ","ウ","エ","イ","カ","コ","ク","ケ","キ","サ","ソ","ス","セ","シ","タ","ト","ツ","テ","チ","ナ","ノ","ヌ","ネ","ニ","ハ","ホ","フ","へ","ヒ","マ","モ","ム","メ","ミ","ヤ","ヨ","ユ","延","似","ラ"," ロ","ル" ," レ","リ","ワ","ヲ","宇","惠","葦","ガ","ゴ","グ","ゲ","ギ","ザ","ゾ","ズ","ゼ","ジ","ダ","ド","ヅ","デ","ヂ","バ","ボ","ブ","ベ","ビ","パ","ポ","プ","ペ","ピ","阿","於","宥","衣","伊","須","ン","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"}
37090 '2.変数定義
37100 Input_moji_count = 0:moji_count=0
37110 moji$ = "":
37120 Input_moji_count = Len(buf$)
37130 'buf$から文字を取り出して代入する変数
37140 Dim moji_count$(Input_moji_count)
37150 '3.buf$の文字を取り出して配列に代入
37160 for i=1 to (Input_moji_count)
37170 moji$ = Mid$(buf$,i-1,1)
37180 moji_count$(i-1) = moji$
37190 next i
37200 '4.buf$が数霊に有効な文字かを調べる。
37210 for i=0 to (Input_moji_count - 1)
37220 for n = 0 to  117
37230 if (moji_count$(i) = Kazutama_Moji$(n)) then
37240 moji_count = moji_count + 1
37250 '入力した文字が全部カタカナなら 戻り値:1 になる。
37260 endif
37270 next n
37280 next i
37290 '5.結果を代入して文字数を出す。
37300 if (moji_count > 0) then
37310 moji_count = 0
37320 check_flag = moji_count
37330 else
37340 moji_count = 1
37350 endif
37360 check_flag = moji_count
37370 endfunc check_flag
37380 '******************************************************************************************
37390 '登録件数を求める
37400 'Date 2025.03.22
37410 '*******************************************************************************************
37420 func Kazutama_File_Entry_Check()
37430 '********************************************************************************************
37440 '登録件数を求める自作関数
37450 '全体的な流れ
37460 '0.変数
37470 '1.フォルダが有無チェック。
37480 '2.ファイルの有無チェック。
37490 '3．ファイルを読み込む。
37500 '*********************************************************************************************
37510 '0.変数
37520 '0-1.i:登録件数
37530 '*********************************************************************************************
37540 i=0:
37550 '**********************************************************************************************
37560 '1.フォルダの有無チェック
37570 '1-1.フォルダ:my_Kazutama_Folder$ = "data/myKazutama/"
37580 '**********************************************************************************************
37590 if (myKazutamaFolder$ = "") then
37600 '************************************************************************************************
37610 '1.フォルダがない時
37620 '終了処理
37630 '**********************************************************************************************
37640 cls 3:color rgb(255,255,255):
37650 print "Folder not found"
37660 end
37670 endif
37680 '**********************************************************************************************
37690 '2.ファイルの有無チェック
37700 '2-1.ファイル(Full PATH): my_Kazutama_data_File$ = my_Kazutama_Folder$ + "my_Kazutama_data_File.dat"
37710 '**********************************************************************************************
37720 if (my_Kazutama_data_File$ = "") then
37730 '**********************************************************************************************
37740 '2-1.ファイルがない時
37750 '終了処理
37760 '***********************************************************************************************
37770 cls 3:color rgb(255,255,255)
37780 print "file not found"
37790 end
37800 else
37810 '************************************************************************************************
37820 '2-2 ファイルが有るときの処理
37830 '登録件数を求める処理
37840 '************************************************************************************************
37850 goto File_Entry_Check:
37860 endif
37870 '************************************************************************************************
37880 '3.ファイルを読み込んで登録件数を求める
37890 '3-1:
37900 '***********************************************************************************************
37910 File_Entry_Check:
37920 open my_Kazutama_data_File$ for input as #1
37930 while (eof(1) = 0)
37940 line input #1,a$
37950 i = i + 1
37960 wend
37970 close #1
37980 '登録件数iをEntry_countに代入して終了する。
37990 Entry_count = i
38000 endfunc Entry_count
38010 '*************************************************************************************************
38020 '登録件数を求める
38030 '*************************************************************************************************
38040 Kazutama_data_Entry_count:
38050 cls 3:Font 48:init "kb:4":No = 0:n = 0
38060 gload Gazo$ + "Result_Screen3_20250205.png"
38070 n = Kazutama_File_Entry_Check() - 1
38080 locate 1,3
38090 print "登録件数は、";n;"件です。"
38100 locate 0,5
38110 print "◎.どうしますか?"
38120 locate 1,7
38130 print "1.トップ画面に戻る。"
38140 locate 1,9
38150 print "2.登録リストを表示する。"
38160 sp_on 4,1:sp_put 4,(5,350),0,0
38170 Select_Joypad_Kazutama_data_Entry:
38180 y = 0:key$ = "":bg = 0:
38190 while (key$ <> chr$(13) and key$ <> chr$(31) and key$ <> chr$(30) and  y <> 1 and  y <> -1 and bg <> 2)
38200 y = stick(1)
38210 key$ = inkey$
38220 bg = strig(1)
38230 pause 100
38240 wend
38250 if ((y=1) or (key$ = chr$(31)) or  (y = -1) or  (key$ = chr$(30))) then
38260 select case No
38270 '0 (選択肢1) → 1 (選択肢2)
38280 case 0:
38290 No=1:sp_on 4,0:sp_on 5,1:sp_put 5,(5,450),0,0:pause 200:goto Select_Joypad_Kazutama_data_Entry:
38300 '0(選択肢1)→1(択肢2 )
38310 case 1:
38320 No=0:sp_on 5,0:sp_on 4,1:sp_put 4,(5,350),0,0:pause 200:goto Select_Joypad_Kazutama_data_Entry:
38330 '1(選択肢2)→0(選択肢1)
38340 'case 2:
38350 'No=0:sp_on 5,0:sp_on 4,1:sp_on 6,0:sp_put 4,(5,350),0,0:pause 200:goto Select_Joypad_Kazutama_Save:
38360 end select
38370 endif
38380 '***********************************************************************************************************
38390 '3.決定ボタン　決定ボタン(ジョイパッドの右)を押したときの処理　　ここから
38400 '***********************************************************************************************************
38410 if (bg = 2 or key$ = chr$(13)) then
38420 select case No
38430 '選択肢1 No=0
38440 case 0:
38450 '1.選択肢 1を押したときの処理
38460 '*********************************************************************************************************
38470 '(After)
38480 'どうしますか？
38490 '1.トップ画面に戻る。
38500 '2.登録リストを表示する。
38510 '*********************************************************************************************************
38520 No = 0:sp_on 4,0:sp_on 5,0:sp_on 6,0:pause 100:
38530 '保存処理をする　Save_Kazutama_data:
38540 goto TopScreen:
38550 '**********************************************************************************************************
38560 '2.選択肢 2を押したときの処理
38570 'Beforeで選択肢で保存しないときの処理
38580 '**********************************************************************************************************
38590 '選択肢2
38600 '1回目
38610 case 1:
38620 No=1:sp_on 4,0:sp_on 5,0:sp_on 6,0:pause 100
38630 '***********************************************************************************************************
38640 '登録リストを表示するところに飛ぶ
38650 '登録リストを表示するラベル: Read_Entry_Kazutama_Data:
38660 '***********************************************************************************************************
38670 'ui_msg "Read_Entry_Kazutama_Dataに行きます。"
38680 goto Read_Entry_Kazutama_Data:
38690 '*************************************************************************************************************
38700 end select
38710 endif
38720 '*************************************************************************************************************
38730 Read_Entry_Kazutama_Data:
38740 '*************************************************************************************************************
38750 '◎.1.ラベル名:Read_Entry_Kazutama_Data:
38760 '◎.2.登録リストを表示するラベル
38770 '◎.3.作成　Date:2025.03.26
38780 '◎.4.全体的な流れ
38790 '・1.ファイルを読み込みデーターの登録件数を求める
38800 '        ↓
38810 '・2.一端ファイルを閉じる
38820 '        ↓
38830 '・3.ファイルの件数分だけ配列(メモリー)を確保する。
38840 '        ↓
38850 '・4.データーを代入する配列を確保する。
38860 '        ↓
38870 '・5.再びfileを開く。
38880 '        ↓
38890 '・6.配列のサイズだけファイルを読み込んでデーターを代入する。
38900 '        ↓
38910 '・7.次のラベルでデーターを表示する。
38920 '※ファイルを読み込んで、配列にデーターを代入するまでの処理。
38930 '*************************************************************************************************************
38940 '1.ファイルを読み込んで、データーの登録件数(n)を求める。
38950 '2.一端ファイルを閉じる。
38960 '*************************************************************************************************************
38970 '登録件数:n (count = 0:初期値)
38980 '1と2 の処理
38990 '*************************************************************************************************************
39000 count = 0
39010 count = Kazutama_File_Entry_Check()
39020 '*************************************************************************************************************
39030 '3.登録データーのfileの件数分だけ配列(メモリー)を確保する。
39040 'Buffer_Kazutama_Entry_Data(2,Data_Memory) →　Buffer_Kazutama_Entry_Data(横,の数,縦の数)
39050 '*************************************************************************************************************
39060 Data_Memory_Yoko = 2
39070 Data_Memory_Tate = count
39080 '*************************************************************************************************************ok
39090 '4.データーを代入する配列を確保する。
39100 '*************************************************************************************************************
39110 Dim Buffer_Kazutama_Entry_Data$(Data_Memory_Tate,Data_Memory_Yoko)
39120 '*************************************************************************************************************
39130 '5.再び、fileを開く。
39140 '6.配列(メモリー)のサイズだけ、fileを読み込んで、データーを代入する。
39150 '↓5と6の処理
39160 '*************************************************************************************************************
39170 '5の処理(再び、fileを開く。)
39180 '************************************************************************************************************
39190 open my_Kazutama_data_File$ for input as #1
39200 '*************************************************************************************************************
39210 '6-1.の処理 データーを代入する処理 ここから
39220 '*************************************************************************************************************
39230 for i=0 to Data_Memory_Tate - 1
39240 for j=0 to Data_Memory_Yoko - 1
39250 input #1,a$
39260 Buffer_Kazutama_Entry_Data$(i,j) = a$
39270 next j
39280 next i
39290 '************************************************************************************************************
39300 '6-1.の処理　データーを代入処理　ここまで
39310 '************************************************************************************************************
39320 '6-2.の処理 ファイルを閉じる処理 ここから
39330 '************************************************************************************************************
39340 close #1
39350 '************************************************************************************************************
39360 '************************************************************************************************************
39370 '6-2.の処理 ファイルを閉じる処理 ここまで
39380 '************************************************************************************************************
39390 goto Show_Kazutama_Data_List:
39400 '************************************************************************************************************
39410 '7.次のラベルで、データーを表示する。
39420 '************************************************************************************************************
39430 Show_Kazutama_Data_List:
39440 '************************************************************************************************************
39450 'データーを表示するパート
39460 '1.登録件数を表示させて
39470 '2.右の丸ボタンで数霊の表を表示させて十字キーで文字を選択して、右の丸で決定する
39480 '*******************************************************************
39490 '*******************************************************************
39500 cls 3:color rgb(255,255,255)
39510 '*********************************************************************************************************8***
39520 gload Gazo$ + "Show_Kazutama_Data_20250402.png",0,0,0
39530 '**************************************************************************************************************
39540 '1.変数初期化
39550 '***************************************************************************************************************
39560 Font 48:init "kb:4"
39570 y = 0:key$ = "":bg = 0:No = 0
39580 '******************************************************************************************************************
39590 'for i=0 to 1
39600 'print Buffer_Kazutama_Entry_Data$(0,0) + "," + Buffer_Kazutama_Entry_Data$(0,1)
39610 'for j=0 to 1
39620 'for i=0 to (Data_Memory_Tate - 1)
39630 'Line1 Number:
39640 '*****************************************************************************************************************
39650 '2.変数代入 ここから
39660 '*******************************************************************************************************************
39670 Line1_Number1_X = 3
39680 Line1_Number1_Y = 6
39690 'Line 1 数霊ネーム 表示位置
39700 Count_Kazutama_Name = 14
39710 '***************************************************************************************************************
39720 'Line 1 数霊数　表示位置
39730 Count_Kazutama_Number = 22
39740 '*****************************************************************************************************************
39750 '2.変数代入　ここまで
39760 '********************************************************************************************************************
39770 '3.表示      ここから
39780 '********************************************************************************************************************
39790 '登録件数を求める
39800 MinCount = 1
39810 '*******************************************************************************************************
39820 Entry_count = Kazutama_File_Entry_Check() - MinCount
39830 '*******************************************************************************************************
39840 'Entry count 登録件数 1〜2件
39850 '*******************************************************************************************************
39860 'Entry_count = MaxCount - MinCount
39870 '********************************************************************************************************
39880 select case (Entry_count)
39890 'case 0のとき登録件数が1件のとき 0番目はタイトル
39900 '*********************************************************************************************************
39910 '●.登録データーが1件の時
39920 '*********************************************************************************************************
39930 case 1:
39940 '*********************************************************************************************************
39950 '1件の時の文字データー代入処理:(1,0) and (1,1)
39960 '********************************************************************************************************
39970 Title1_Kazutama_Name$ = Buffer_Kazutama_Entry_Data$(1,0)
39980 Title2_Kazutama_Number$ = Buffer_Kazutama_Entry_Data$(1,1)
39990 buf_length1 = len(Title1_Kazutama_Name$)
40000 buf_length2 = len(Title2_Kazutama_Number$)
40010 Line1 = 6
40020 'Line1 数霊名  表示位置から文字の桁数ずらす。
40030 Line1_Kazutama_Name = Count_Kazutama_Name - buf_length1
40040 'Line1 数霊数　表示位置から文字の桁数ずらす。
40050 Line1_Kazutama_Number = Count_Kazutama_Number - buf_length2:
40060 '********************************************************************************************************
40070 '1.登録件数が1件の時の変数を代入処理
40080 '********************************************************************************************************
40090 '2:登録件数がデーターの表示処理
40100 '表示位置  色 黒:rgb(0,0,0)
40110 '********************************************************************************************************
40120 locate Line1_Number1_X,Line1_Number1_Y:color rgb(0,0,0)
40130 '********************************************************************************************************
40140 '1-1 No:数字を表示する
40150 '********************************************************************************************************
40160 print "1"
40170 '*********************************************************************************************************
40180 '1-2.数霊名 表示位置 黒:rgb(0,0,0)
40190 '*********************************************************************************************************
40200 locate Line1_Kazutama_Name,Line1:color rgb(0,0,0)
40210 '*********************************************************************************************************
40220 '1-2.数霊名　表示する
40230 '*********************************************************************************************************
40240 print Title1_Kazutama_Name$
40250 '*********************************************************************************************************
40260 '1-3.数霊数 表示位置 黒:rgb(0,0,0)
40270 '*********************************************************************************************************
40280 locate Line1_Kazutama_Number,Line1:color rgb(0,0,0)
40290 '*********************************************************************************************************
40300 '1-3.数霊数 表示する
40310 '**********************************************************************************************************
40320 print Title2_Kazutama_Number$
40330 '*********************************************************************************************************
40340 '次のメエニュー表示 ここから
40350 '**********************************************************************************************************
40360 locate 2,15
40370 color rgb(255,255,255)
40380 print "右の丸:トップ画面に行く"
40390 '*********************************************************************************************************
40400 '次のメニュー表示 ここまで
40410 '*********************************************************************************************************
40420 '●.登録件数が2件の時
40430 '**********************************************************************************************************
40440 case 2:
40450 '*********************************************************************************************************
40460 '表示件数が2 件の時
40470 '********************************************************************************************************
40480 '●.全体的な処理
40490 '1.変数初期化　
40500 '2.変数、配列に代入
40510 '3.結果を表示
40520 '*********************************************************************************************************
40530 '1件の時の文字データー代入処理:(1,0) and (1,1)
40540 '********************************************************************************************************
40550 Title1_Kazutama_Line1_Name$ = Buffer_Kazutama_Entry_Data$(1,0)
40560 Title2_Kazutama_Line1_Number$ = Buffer_Kazutama_Entry_Data$(1,1)
40570 buf_length1 = len(Title1_Line1_Kazutama_Name$)
40580 buf_length2 = len(Title2_Line1_Kazutama_Number$)
40590 '*******************************************************************************************************
40600 '登録件数が2件の時の文字データー代入処理
40610 Title1_Kazutama_Line2_Name$ = Buffer_Kazutama_Entry_Data$(2,0)
40620 Title2_Kazutama_Line2_Number$ = Buffer_Kazutama_Entry_Data$(2,1)
40630 buf_length1 = len(Title1_Line2_Kazutama_Name$)
40640 buf_length2 = len(Title2_Line2_Kazutama_Number$)
40650 '******************************************************************************************************
40660 Line1 = 6
40670 Line2 = 9
40680 'Line1 数霊名  表示位置から文字の桁数ずらす。
40690 Line1_Kazutama_Name = Count_Kazutama_Name - buf_length1
40700 'Line1 数霊数　表示位置から文字の桁数ずらす。
40710 Line1_Kazutama_Number = Count_Kazutama_Number - buf_length2:
40720 '********************************************************************************************************
40730 '1.登録件数が1件の時の変数を代入処理
40740 '********************************************************************************************************
40750 '2:登録件数がデーターの表示処理
40760 '表示位置  色 黒:rgb(0,0,0)
40770 '●.全データー　2件
40780 '*********************************************************************************************************
40790 '●.1件目
40800 '********************************************************************************************************
40810 locate Line1_Number1_X,Line1_Number1_Y:color rgb(0,0,0)
40820 '********************************************************************************************************
40830 '1-1 No:数字を表示する
40840 '********************************************************************************************************
40850 print "1"
40860 '*********************************************************************************************************
40870 '1-2.数霊名 表示位置 黒:rgb(0,0,0)
40880 '*********************************************************************************************************
40890 locate Line1_Kazutama_Name,Line1:color rgb(0,0,0)
40900 '*********************************************************************************************************
40910 '1-2.数霊名　表示する Title2_Kazutama_Line1_Number$
40920 '*********************************************************************************************************
40930 print Title1_Kazutama_Line1_Name$
40940 '*********************************************************************************************************
40950 '1-3.数霊数 表示位置 黒:rgb(0,0,0)
40960 '*********************************************************************************************************
40970 locate Line1_Kazutama_Number,Line1:color rgb(0,0,0)
40980 '*********************************************************************************************************
40990 '1-3.数霊数 表示する  Title2_Kazutama_Line1_Number$
41000 '**********************************************************************************************************
41010 print Title2_Kazutama_Line1_Number$
41020 '*********************************************************************************************************
41030 '●.2件目
41040 '*********************************************************************************************************
41050 locate Line2_Number1_X,Line2_Number1_Y:color rgb(0,0,0)
41060 '********************************************************************************************************
41070 '2-1 No:数字を表示する
41080 '********************************************************************************************************
41090 print "2"
41100 '*********************************************************************************************************
41110 '2-2.数霊名 表示位置 黒:rgb(0,0,0)
41120 '*********************************************************************************************************
41130 locate Line2_Kazutama_Name,Line2:color rgb(0,0,0)
41140 '*********************************************************************************************************
41150 '2-2.数霊名　表示する Title1_Kazutama_Line2_Name$
41160 '*********************************************************************************************************
41170 print Title1_Kazutama_Line2_Name$
41180 '*********************************************************************************************************
41190 '2-3.数霊数 表示位置 黒:rgb(0,0,0)
41200 '*********************************************************************************************************
41210 locate Line2_Kazutama_Number,Line2:color rgb(0,0,0)
41220 '*********************************************************************************************************
41230 '2-3.数霊数 表示する Title2_Kazutama_Line2_Number$
41240 '**********************************************************************************************************
41250 print Title2_Kazutama_Line2_Number$
41260 '*********************************************************************************************************
41270 '*********************************************************************************************************
41280 '次のメエニュー表示 ここから
41290 '**********************************************************************************************************
41300 locate 2,16
41310 color rgb(255,255,255)
41320 print "右の丸:トップ画面に行く"
41330 '*********************************************************************************************************
41340 '次のメニュー表示 ここまで(トップ画面にいく処理)
41350 '*********************************************************************************************************
41360 case else:
41370 end select
41380 '**********************************************************************************************************
41390 '登録件数をそれぞれ(件数ごとに)表示
41400 '2025.04.19 対応登録件数　1件
41410 '**********************************************************************************************************
41420 while (key$ <> chr$(13) and key$ <> chr$(31) and key$ <> chr$(30) and  y <> 1 and  y <> -1 and bg <> 2)
41430 y = stick(1)
41440 key$ = inkey$
41450 bg = strig(1)
41460 pause 100
41470 wend
41480 '***********************************************************************************************************
41490 '3.決定ボタン　決定ボタン(ジョイパッドの右)を押したときの処理　　ここから
41500 '***********************************************************************************************************
41510 if (bg = 2 or key$ = chr$(13)) then
41520 '***********************************************************************************************************
41530 'No:ボタンフラグ
41540 '***********************************************************************************************************
41550 select case No
41560 '選択肢1 No = 0
41570 case 0:
41580 '********************************************************************************************************
41590 '1件の時、右の丸を押したときの処理
41600 '********************************************************************************************************
41610 No = 0:sp_on 4,0:sp_on 5,0:sp_on 6,0:pause 100:
41620 '********************************************************************************************************
41630 'メモリーを消去して　トップ画面に行く
41640 '********************************************************************************************************
41650 erase Buffer_Kazutama_Entry_Data$
41660 goto TopScreen:
41670 '********************************************************************************************************
41680 end select
41690 endif
41700 '*********************************************************************************************************
41710 'プロフィール　ここから
41720 '作成開始　2025.05.12 - 5.21
41730 '2.設定-プロフィール-プロフィール表示
41740 '**********************************************************************************************************
41750 '1.名前入力　ここから
41760 '1-1.名前入力　(漢字　姓入力)
41770 '1-2.名前入力　(漢字　名入力)
41780 '1-3.名前入力  (アルファベット　姓入力)
41790 '1-4.名前入力　(アルファベット　名入力)
41800 '1.名前入力　ここまで
41810 '2.生年月日入力　ここから
41820 '2-1.生まれた年代入力
41830 '2-2.生まれた月入力
41840 '2-3.生まれた日入力
41850 '2.生年月日入力　ここまで
41860 '**********************************************************************************************************
41870 '1.名前入力 ここから
41880 '1-1.名前入力　(漢字 姓 入力)
41890 Input_name_Sei_Kangi:
41900 cls 2:gload Gazo$ + "Input_name_sai_Kangi_1080x480.png",0,0,0
41910 '***********************************************************************************************************
41920 'キーボード入力: init "kb:2"
41930 init "KB:2"
41940 '***********************************************************************************************************
41950 '画面を消去して　漢字の名前の姓入力
41960 cls:locate 9,8:Input " ",Name_Kangi_Sai$
41970 '文字入力が空白のとき、入れ直す
41980 if (Name_Kangi_Sai$ = "") then ui_msg "入力が無効です、入れ直してください。":goto Input_name_Mei_Kangi:
41990 '***********************************************************************************************************
42000 Length_Name_Kangi_Sai = Len(Name_Kangi_Sai$):dim buffer_Name_Kangi_Sai$(Length_Name_Kangi_Sai)
42010 for i = 0 to Length_Name_Kangi_Sai - 1
42020 buffer_Name_Kangi_Sai$(i) = Mid$(Name_Kangi_Sai$,1,i+1)
42030 next i
42040 ui_msg "姓の漢字の配列メモリーを作成しました。"
42050 pause 600
42060 goto Input_name_Mei_Kangi:
42070 '***********************************************************************************************************
42080 '***********************************************************************************************************
42090 '1-2.名前入力　(漢字 名 入力)
42100 Input_name_Mei_Kangi:
42110 cls 2:gload Gazo$ + "Input_name_mei_Kangi_1080x480.png",0,0,0
42120 '************************************************************************************************************
42130 'キーボード入力:　init "kb:2"
42140 init "KB:2"
42150 '************************************************************************************************************
42160 cls
42170 locate 9,8:Input " ",Name_Kangi_Mei$
42180 if (Name_Kangi_Mei$ = "") then ui_msg "入力が無効です、入れ直してください。":goto Input_name_Mei_Kangi:
42190 Length_Name_Kangi_Mei = Len(Name_Kangi_Mei$):dim buffer_Name_Kangi_Mei$(Length_Name_Kangi_Mei)
42200 for i = 0 to Length_Name_Kangi_Mei
42210 buffer_Name_Kangi_Mei$(i) = Mid$(Name_Kangi_Mei$,1,i+1)
42220 next i
42230 ui_msg "名の漢字の配列のメモリーを作成しました。"
42240 pause 600
42250 goto Input_Name_Sei_Alphabet:
42260 '***********************************************************************************************************
42270 '***********************************************************************************************************
42280 '1-3.名前入力  (アルファベット 姓入力)
42290 Input_Name_Sei_Alphabet:
42300 cls 2:gload Gazo$ + "Input_Name_Sai_Alphabet_1080x480.png",0,0,0
42310 '***********************************************************************************************************
42320 'キーボード入力
42330 init "KB:2"
42340 '***********************************************************************************************************
42350 '画面を消去して　アルファベットの名前の姓入力する。
42360 cls:locate 12,8:Input " ",Name_Sai_Alphabet$
42370 '***********************************************************************************************************
42380 'Length_Name_Alphabet_Sai:アルファベット　姓入力の文字数
42390 'Dim buffer_Name_Sai_Alphabet$(Length_Name_Alphabet_Sai):アルファベット　姓入力　文字変数
42400 Length_Name_Alphabet_Sai = Len(Name_Sai_Alphabet$):dim buffer_Name_Sai_Alphabet$(Length_Name_Alphabet_Sai)
42410 '***********************************************************************************************************
42420 goto Input_Name_Mei_Alphabet:
42430 '***********************************************************************************************************
42440 '1-4.名前入力  (アルファベット 名入力)
42450 Input_Name_Mei_Alphabet:
42460 cls 2:gload Gazo$ + "Input_Name_Mei_Alphabet_1080x480.png",0,0,0
42470 '***********************************************************************************************************
42480 'キーボード入力
42490 init "KB:2"
42500 '**********************************************************************************************************
42510 '画面を消去してアルファベットの名入力する。
42520 cls:locate 12,8:Input " ",Name_Mei_Alphabet$
42530 pause 600
42540 goto Input_Born_Year:
42550 '1.名前入力　ここまで
42560 '***********************************************************************************************************
42570 '***********************************************************************************************************
42580 '2.生年月日 入 力 ここから
42590 '2-1.生まれた年代入力
42600 '2-2.生まれた月入力
42610 '2-3.生まれた日入力
42620 '************************************************************************************************************
42630 '2-1.生まれた年代 入 力
42640 Input_Born_Year:
42650 cls 2:gload Gazo$ + "Input_Born_Year_myProfile_1080x480.png",0,0,0
42660 '***********************************************************************************************************
42670 'キーボード入力
42680 init "KB:2"
42690 '***********************************************************************************************************
42700 cls:locate 9,8:Input "",Born_Year
42710 goto Input_Born_Month:
42720 '2-2.生まれた月 入 力
42730 Input_Born_Month:
42740 cls 2:gload Gazo$ + "Input_Born_Month_myProfile_1080x480.png",0,0,0
42750 '***********************************************************************************************************
42760 'キーボード入力
42770 init "KB:2"
42780 cls:locate 8,8:Input "",Born_Month
42790 '***********************************************************************************************************
42800 goto Input_Born_Day:
42810 '2-3.生まれた日 入 力 ラベル →　Input_Born_Day:
42820 Input_Born_Day:
42830 cls 2:gload Gazo$ + "Input_Born_Day_myProfile_1080x480.png",0,0,0
42840 'キーボード入力
42850 init "KB:2"
42860 cls:locate 8,8:Input "",Born_Day
42870 cls
42880 goto myProfile_File_Check:
42890 'goto Output_myProfile:
42900 '2.生年月日入力 ここまで
42910 '***********************************************************************************************************
42920 '2.入 力　ここまで
42930 '***********************************************************************************************************
42940 '***********************************************************************************************************
42950 '3.データー保存処理 ここから
42960 '3-0.計算部分
42970 '3-1.File Check(fileの有無のチェック)
42980 '3-2.Fileにパーソナルデーターを書き込む
42990 '***********************************************************************************************************
43000 '3-0.計算部分
43010 '***********************************************************************************************************
43020 '***********************************************************************************************************
43030 '3-1 File Check(File の有無チェック)
43040 '***********************************************************************************************************
43050 myProfile_Dir_File_Check:
43060 '1.フォルダのチェック
43070 myProfileFolder$ = dir$(myKazutamaFolder$,1)
43080 if (myProfileFolder$ = "") then
43090 ui_msg "フォルダが見つかりません。"
43100 mkdir myProfileFolder$
43110 ui_msg "フォルダを作成しました。"
43120 endif
43130 goto Input_name_Sei_Kangi:
43140 myProfile_File_Check:
43150 myProfileFile$ = dir$(my_Profile_data$,0)
43160 if (myProfileFolder$) then
43170 'Fileが有るとき、fileを読み込んで、データー出力
43180 goto Parsonal_Data_Load:
43190 'else
43200 'Fileがある時Fileを読み込む
43210 'goto Parsonal_Data_Load:
43220 endif
43230 '***********************************************************************************************************
43240 'Label: Parsonal_Data_Save:
43250 '3-2 Fileにパーソナルデーターを書き込む
43260 '1.名前　姓　漢字 → Name_Kangi_Sai$
43270 '2.名前　名　漢字 →　Name_SKangi_Sai$
43280 '3.名前　姓　アルファベット →　Name_Sai_Alphabet$
43290 '4.名前　名　アルファベット　→　Name_Mei_Alphabet$
43300 '5.数霊数 → Kazutama_Number
43310 '***********************************************************************************************************
43320 Parsonal_Data_Save:
43330 open my_Profile_data$ for output as #1
43340 print #1,"名前の漢字姓","名前の漢字名","名前のアルファベット姓","名前のアルファベット名"
43350 print #1,Name_Kangi_Sai$,",",Name_Kangi_Mei$,",",Name_Sai_Alphabet$,",",Name_Mei_Alphabet$
43360 ui_msg "データーを保存しました。"
43370 close #1
43380 'データーを初期化する
43390 Name_Kangi_Sai$ = ""
43400 Name_Kangi_Mei$ = ""
43410 Name_Sai_Alphabet$ = ""
43420 Name_Mei_Alphabet$ = ""
43430 ui_msg "データーを初期化しました。"
43440 goto Parsonal_Data_Load:
43450 '***********************************************************************************************************
43460 'パーソナルデーターを読み込む
43470 '***********************************************************************************************************
43480 Parsonal_Data_Load:
43490 dim buffer_data$(2,4)
43500 open my_Profile_data$ for input as #1
43510 for i=0 to 1
43520 for j=0 to 3
43530 input #1,a$
43540 buffer_data$(i,j) = a$
43550 next j
43560 next i
43570 close #1
43580 goto Output_myProfile:
43590 '***********************************************************************************************************
43600 '4.出 力 ここから
43610 '***********************************************************************************************************
43620 'myプロフィール画面 名前のプロフィール画面
43630 Output_myProfile:
43640 '***********************************************************************************************************
43650 'Output_myProfile_20250521_1080x480:プロフィール 出力画面
43660 cls 2:gload Gazo$ + "Output_myProfile_20250521_1080x480.png",0,0,0
43670 bg=0:key$=""
43680 '***********************************************************************************************************
43690 'JoyPad 入力
43700 init "KB:4"
43710 '***********************************************************************************************************
43720 '画面表示 ここから
43730 '***********************************************************************************************************
43740 color rgb(0,0,255)
43750 locate 3,4:print buffer_data$(1,1)
43760 '**********************************************************************************************************
43770 '画面表示　ここまで
43780 '***********************************************************************************************************
43790 while (key$ <> chr$(13) and bg <> 2)
43800 key$ = inkey$
43810 bg = strig(1)
43820 pause 100
43830 wend
43840 '***********************************************************************************************************
43850 if ((bg = 2) or (key$ = chr$(13))) then
43860 '決定ボタン　or エンターキーを押したとき
43870 '**********************************************************************************************************
43880 erase buffer_Name_Kangi_Sai$
43890 erase buffer_Name_Kangi_Mei$
43900 erase buffer_Name_Sai_Alphabet$
43910 erase buffer_Name_Mei_Alphabet$
43920 ui_msg "メモリーをクリアしました、トップ画面に行きます。"
43930 'TopScreenに飛ぶ
43940 goto TopScreen:
43950 '**********************************************************************************************************
43960 endif
43970 '***********************************************************************************************************
43980 '4.出 力 ここまで
43990 '***********************************************************************************************************
44000 '***********************************************************************************************************
44010 'プロフィール　ここまで
44020 '作成開始　2025.05.12 - 2025.05.21
44030 '2.設定-プロフィール-プロフィール表示
44040 '***********************************************************************************************************
